C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE INTERRUPTIONS
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\interruptions.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\4.2\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -interruptions.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP8051
                    -_Keil_951\Release/interruptions.lst) CD OT(8,SPEED) OJ(.\DP8051_Keil_951\Release\interruptions.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // BSD 3-Clause License
   3          
   4          // Copyright (c) 2016, qbrobotics
   5          // Copyright (c) 2017, Centro "E.Piaggio"
   6          // All rights reserved.
   7          
   8          // Redistribution and use in source and binary forms, with or without
   9          // modification, are permitted provided that the following conditions are met:
  10          
  11          // * Redistributions of source code must retain the above copyright notice, this
  12          //   list of conditions and the following disclaimer.
  13          
  14          // * Redistributions in binary form must reproduce the above copyright notice,
  15          //   this list of conditions and the following disclaimer in the documentation
  16          //   and/or other materials provided with the distribution.
  17          
  18          // * Neither the name of the copyright holder nor the names of its
  19          //   contributors may be used to endorse or promote products derived from
  20          //   this software without specific prior written permission.
  21          
  22          // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  23          // AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  24          // IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  25          // DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  26          // FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  27          // DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  28          // SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  29          // CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  30          // OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  31          // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  32          // POSSIBILITY OF SUCH DAMAGE.
  33          // ----------------------------------------------------------------------------
  34          
  35          /**
  36          * \file         interruptions.c
  37          *
  38          * \brief        Interruption functions are in this file.
  39          * \date         October 01, 2017
  40          * \author       _Centro "E.Piaggio"_
  41          * \copyright    (C) 2012-2016 qbrobotics. All rights reserved.
  42          * \copyright    (C) 2017 Centro "E.Piaggio". All rights reserved.
  43          */
  44          
  45          
  46          //=================================================================     includes
  47          #include <interruptions.h>
  48          #include <command_processing.h>
  49          
  50          #include "globals.h"
  51          #include "utils.h"
  52          
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 2   

  53          //===================================================================     global
  54          
  55          
  56          // PWM vaules needed to obtain 8 Volts given a certain input tension
  57          // Numbers are sperimentally calculated //[index] (milliampere)
  58          CYCODE uint8 pwm_preload_values[29] = {100,    //0 (11500)
  59                                                       100,//83
  60                                                       100,//78
  61                                                        76,
  62                                                        74,
  63                                                        72,    //5 (14000)
  64                                                        70,
  65                                                        68,
  66                                                        67,
  67                                                        65,
  68                                                        64,    //10 (16500)
  69                                                        63,
  70                                                        62,
  71                                                        61,
  72                                                        60,
  73                                                        59,    //15 (19000)
  74                                                        58,
  75                                                        57,
  76                                                        56,
  77                                                        56,
  78                                                        55,    //20 (21500)
  79                                                        54,
  80                                                        54,
  81                                                        53,
  82                                                        52,
  83                                                        52,    //25 (24000)
  84                                                        52,
  85                                                        51,
  86                                                        51};   //28 (25500)
  87          
  88          CYCODE uint8 hitech_pwm_preload_values[36] = {  100,   //0 (8000)
  89                                                          76,
  90                                                          71,
  91                                                          69,
  92                                                          67,
  93                                                          65,     //5 (10500)
  94                                                          63,
  95                                                          61,
  96                                                          60,
  97                                                          58,
  98                                                          57,     //10 (13000)
  99                                                          56,
 100                                                          55,
 101                                                          54,
 102                                                          53,
 103                                                          52,     //15 (15500)
 104                                                          51,
 105                                                          50,
 106                                                          49,
 107                                                          49,
 108                                                          48,     //20 (18000)
 109                                                          47,
 110                                                          47,
 111                                                          46,
 112                                                          45,
 113                                                          45,     //25 (20500)
 114                                                          45,
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 3   

 115                                                          44,
 116                                                          44,
 117                                                          43,
 118                                                          43,     //30 (23000)
 119                                                          43,
 120                                                          43,
 121                                                          42,
 122                                                          42,
 123                                                          42};    //35 (25500)
 124          
 125          CYCODE uint8 hitech_pwm_preload_values_6v[32] = {100,   //0 (6000)
 126                                                            76,
 127                                                            71,
 128                                                            68,
 129                                                            66,
 130                                                            64,   //5 (8750)
 131                                                            62,
 132                                                            60,
 133                                                            58,
 134                                                            56,
 135                                                            54,   //10 (11500)
 136                                                            53,
 137                                                            52,
 138                                                            51,
 139                                                            50,
 140                                                            49,   //15 ()
 141                                                            47,
 142                                                            46,
 143                                                            45,
 144                                                            44,
 145                                                            43,   //20 ()
 146                                                            42,
 147                                                            41,
 148                                                            40,
 149                                                            39,
 150                                                            38,   //25 ()
 151                                                            37,
 152                                                            37,
 153                                                            37,
 154                                                            37,
 155                                                            36};  //30 (24750)
 156          
 157          //==============================================================================
 158          //                                                            WATCHDOG INTERRUPT
 159          //==============================================================================
 160          
 161          CY_ISR(ISR_WATCHDOG_Handler){
 162   1      
 163   1          // Set WDT flag
 164   1          
 165   1          watchdog_flag = TRUE;
 166   1      
 167   1      }
 168          
 169          //==============================================================================
 170          //                                                            RS485 RX INTERRUPT
 171          //==============================================================================
 172          
 173          CY_ISR(ISR_RS485_RX_ExInterrupt) {
 174   1      
 175   1          // Set RS485 flag
 176   1          
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 4   

 177   1          interrupt_flag = TRUE;
 178   1           
 179   1      }
 180          
 181          //==============================================================================
 182          //                                                             INTERRUPT MANAGER
 183          //==============================================================================
 184          // Manage interrupt from RS485 
 185          //==============================================================================
 186          // Processing RS-485 data frame:
 187          //
 188          // - WAIT_START:    Waits for beginning characters;
 189          // - WAIT_ID:       Waits for ID;
 190          // - WAIT_LENGTH:   Data length;
 191          // - RECEIVE:       Receive all bytes;
 192          // - UNLOAD:        Wait for another device end of transmission;
 193          //
 194          //==============================================================================
 195          
 196          void interrupt_manager(){
 197   1      
 198   1          
 199   1          //===========================================     local variables definition
 200   1      
 201   1          static uint8 CYDATA state = WAIT_START;                      // state
 202   1          
 203   1          //------------------------------------------------- local data packet
 204   1          static uint8 CYDATA data_packet_index;
 205   1          static uint8 CYDATA data_packet_length;
 206   1          static uint8 data_packet_buffer[128];                     
 207   1          static uint8 CYDATA rx_queue[3];                    // last 2 bytes received
 208   1          //-------------------------------------------------
 209   1      
 210   1          uint8 CYDATA    rx_data;                            // RS485 UART rx data
 211   1          CYBIT           rx_data_type;                       // my id?
 212   1          uint8 CYDATA    package_count = 0;                     
 213   1      
 214   1          //======================================================     receive routine
 215   1          
 216   1          // Get data until buffer is not empty 
 217   1          
 218   1          while(UART_RS485_GetRxBufferSize() && (package_count < 6)){  
 219   2              // 6 stima di numero massimo di pacchetti che riesco a leggere senza bloccare l'esecuzione del fir
             -mware
 220   2              
 221   2              // Get next char
 222   2              rx_data = UART_RS485_GetChar();
 223   2              
 224   2              switch (state) {
 225   3                  //-----     wait for frame start     -------------------------------
 226   3                  case WAIT_START:
 227   3                  
 228   3                      rx_queue[0] = rx_queue[1];
 229   3                      rx_queue[1] = rx_queue[2];
 230   3                      rx_queue[2] = rx_data;
 231   3                      
 232   3                      // Check for header configuration package
 233   3                      if ((rx_queue[1] == 58) && (rx_queue[2] == 58)) {
 234   4                          rx_queue[0] = 0;
 235   4                          rx_queue[1] = 0;
 236   4                          rx_queue[2] = 0;
 237   4                          state       = WAIT_ID;                    
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 5   

 238   4                      }else
 239   3                          if ((rx_queue[0] == 63) &&      //ASCII - ?
 240   3                              (rx_queue[1] == 13) &&      //ASCII - CR
 241   3                              (rx_queue[2] == 10))        //ASCII - LF)
 242   3                              infoGet(INFO_ALL);
 243   3                      break;
 244   3      
 245   3                  //-----     wait for id     ----------------------------------------
 246   3                  case  WAIT_ID:
 247   3      
 248   3                      // packet is for my ID or is broadcast
 249   3                      if (rx_data == c_mem.id || rx_data == 0 || (rx_data == c_mem.hand_ID && (c_mem.cuff_activa
             -tion_flag_force == TRUE ||c_mem.cuff_activation_flag_proprio == TRUE || c_mem.cuff_activation_flag_force_proprio == TRUE
             -)))
 250   3                          rx_data_type = FALSE;
 251   3                      else                //packet is for others
 252   3                          rx_data_type = TRUE;
 253   3                      
 254   3                      data_packet_length = 0;
 255   3                      state = WAIT_LENGTH;
 256   3                      break;
 257   3      
 258   3                  //-----     wait for length     ------------------------------------
 259   3                  case  WAIT_LENGTH:
 260   3      
 261   3       
 262   3                      data_packet_length = rx_data;
 263   3                      // check validity of pack length
 264   3                      if (data_packet_length <= 1) {
 265   4                          data_packet_length = 0;
 266   4                          state = WAIT_START;
 267   4                      } else if (data_packet_length > 128) {
 268   4                          data_packet_length = 0;
 269   4                          state = WAIT_START;
 270   4                      } else {
 271   4                          data_packet_index = 0;
 272   4                          
 273   4                          if(rx_data_type == FALSE)
 274   4                              state = RECEIVE;          // packet for me or broadcast
 275   4                          else
 276   4                              state = UNLOAD;           // packet for others
 277   4                      }
 278   3                      break;
 279   3      
 280   3                  //-----     receiving     -------------------------------------------
 281   3                  case RECEIVE:
 282   3      
 283   3                      data_packet_buffer[data_packet_index] = rx_data;
 284   3                      data_packet_index++;
 285   3                      
 286   3                      // check end of transmission
 287   3                      if (data_packet_index >= data_packet_length) {
 288   4                          // verify if frame ID corresponded to the device ID
 289   4                          if (rx_data_type == FALSE) {
 290   5                              // copying data from buffer to global packet
 291   5                              memcpy(g_rx.buffer, data_packet_buffer, data_packet_length);
 292   5                              g_rx.length = data_packet_length;
 293   5                              g_rx.ready  = 1;
 294   5                              commProcess();
 295   5                          }
 296   4                          
 297   4                          data_packet_index  = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 6   

 298   4                          data_packet_length = 0;
 299   4                          state              = WAIT_START;
 300   4                          package_count++;
 301   4                      
 302   4                      }
 303   3                      break;
 304   3      
 305   3                  //-----     other device is receving     ---------------------------
 306   3                  case UNLOAD:
 307   3                      if (!(--data_packet_length)) {
 308   4                          data_packet_index  = 0;
 309   4                          data_packet_length = 0;
 310   4                          RS485_CTS_Write(1);
 311   4                          RS485_CTS_Write(0);
 312   4                          state              = WAIT_START;
 313   4                          package_count++;
 314   4                      }
 315   3                      break;
 316   3              }
 317   2          }
 318   1      }
 319          
 320          //==============================================================================
 321          //                                                            FUNCTION SCHEDULER
 322          //==============================================================================
 323          // Call all the function with the right frequency
 324          //==============================================================================
 325          // Base frequency 1000 Hz
 326          //==============================================================================
 327          
 328          void function_scheduler(void) {
 329   1       
 330   1          static uint16 counter_calibration = DIV_INIT_VALUE;
 331   1          
 332   1          // Start ADC Conversion, SOC = 1
 333   1      
 334   1          timer_value0 = (uint32)MY_TIMER_ReadCounter();
 335   1          
 336   1          ADC_SOC_Write(0x01); 
 337   1          
 338   1          // Check Interrupt 
 339   1      
 340   1          if (interrupt_flag){
 341   2              interrupt_flag = FALSE;
 342   2              interrupt_manager();
 343   2          }
 344   1        
 345   1          //---------------------------------- Get Encoders
 346   1      
 347   1          encoder_reading(0, FALSE); 
 348   1          
 349   1          // Check Interrupt     
 350   1          
 351   1          if (interrupt_flag){
 352   2              interrupt_flag = FALSE;
 353   2              interrupt_manager();
 354   2          }   
 355   1          
 356   1          encoder_reading(1, FALSE);
 357   1          
 358   1          // Check Interrupt 
 359   1          
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 7   

 360   1          if (interrupt_flag){
 361   2              interrupt_flag = FALSE;
 362   2              interrupt_manager();
 363   2          }
 364   1          
 365   1          /*encoder_reading(2, FALSE);
 366   1          
 367   1          // Check Interrupt 
 368   1          
 369   1          if (interrupt_flag){
 370   1              interrupt_flag = FALSE;
 371   1              interrupt_manager();
 372   1          }*/
 373   1      
 374   1          //---------------------------------- Control Motors
 375   1          
 376   1          motor_control(0);
 377   1      
 378   1          // Check Interrupt 
 379   1      
 380   1          if (interrupt_flag){
 381   2              interrupt_flag = FALSE;
 382   2              interrupt_manager();
 383   2          }
 384   1          
 385   1          motor_control(1);
 386   1          
 387   1          // Check Interrupt 
 388   1          
 389   1          if (interrupt_flag){
 390   2              interrupt_flag = FALSE;
 391   2              interrupt_manager();
 392   2          }
 393   1      
 394   1          //---------------------------------- Read conversion buffer - LOCK function
 395   1      
 396   1          analog_read_end();
 397   1      
 398   1          //---------------------------------- Calibration 
 399   1      
 400   1          // Divider 100, freq = 10 Hz
 401   1          /*if (!(calibration_flag == STOP)) {
 402   1              if (counter_calibration == CALIBRATION_DIV) {
 403   1                  calibration();
 404   1                  counter_calibration = 0;
 405   1              }
 406   1              counter_calibration++;
 407   1          }
 408   1          
 409   1          // Check Interrupt 
 410   1          
 411   1          if (interrupt_flag){
 412   1              interrupt_flag = FALSE;
 413   1              interrupt_manager();
 414   1          }*/
 415   1          
 416   1          if (pretensioning_flag == TRUE) {
 417   2             if (counter_calibration == CALIBRATION_DIV) {
 418   3                 pretensioning_process();
 419   3                 counter_calibration = 0;
 420   3             }
 421   2          counter_calibration++;
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 8   

 422   2          } else {
 423   2              if(cuff_flag_force)
 424   2                  drive_cuff();
 425   2                  
 426   2              if (cuff_flag_proprio)
 427   2                  slide_cuff();
 428   2      
 429   2              if (cuff_flag_force_proprio)
 430   2                  force_and_slide_cuff();        
 431   2          }   
 432   1          
 433   1          if (interrupt_flag){
 434   2              interrupt_flag = FALSE;
 435   2              interrupt_manager();
 436   2          }
 437   1              
 438   1         
 439   1          //---------------------------------- Update States
 440   1          
 441   1          // Load k-1 state
 442   1          memcpy( &g_measOld, &g_meas, sizeof(g_meas) );
 443   1          memcpy( &g_refOld, &g_ref, sizeof(g_ref) );
 444   1      
 445   1          // Load k+1 state
 446   1          memcpy( &g_ref, &g_refNew, sizeof(g_ref) );
 447   1      
 448   1          if (interrupt_flag){
 449   2              interrupt_flag = FALSE;
 450   2              interrupt_manager();
 451   2          }
 452   1      
 453   1          //CyDelayUs(100);
 454   1      
 455   1          timer_value = (uint32)MY_TIMER_ReadCounter();
 456   1          MY_TIMER_WriteCounter(5000000);
 457   1      
 458   1      }
 459          
 460          
 461          //==============================================================================
 462          //                                                                MOTORS CONTROL
 463          //==============================================================================
 464          
 465          void motor_control(const uint8 idx) {
 466   1          
 467   1          uint8 CYDATA index = idx;
 468   1       
 469   1          int32 CYDATA curr_ref;
 470   1      
 471   1          int32 CYDATA pwm_input = 0;
 472   1          
 473   1          int32 CYDATA pos_error;
 474   1          int32 CYDATA curr_error;
 475   1          //int32 CYDATA defl_input[NUM_OF_MOTORS];
 476   1          
 477   1          int32 CYDATA k_p = c_mem.k_p;  
 478   1          int32 CYDATA k_i = c_mem.k_i; 
 479   1          int32 CYDATA k_d = c_mem.k_d; 
 480   1      
 481   1          int32 CYDATA k_p_c = c_mem.k_p_c;  
 482   1          int32 CYDATA k_i_c = c_mem.k_i_c; 
 483   1          int32 CYDATA k_d_c = c_mem.k_d_c;   
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 9   

 484   1      
 485   1          int32 CYDATA k_p_dl = c_mem.k_p_dl;  
 486   1          int32 CYDATA k_i_dl = c_mem.k_i_dl; 
 487   1          int32 CYDATA k_d_dl = c_mem.k_d_dl; 
 488   1      
 489   1          int32 CYDATA k_p_c_dl = c_mem.k_p_c_dl;  
 490   1          int32 CYDATA k_i_c_dl = c_mem.k_i_c_dl; 
 491   1          int32 CYDATA k_d_c_dl = c_mem.k_d_c_dl;  
 492   1      
 493   1          // Static Variables
 494   1          
 495   1          static CYBIT dirM0, dirM1;
 496   1          
 497   1          static int32 prev_curr[NUM_OF_MOTORS];
 498   1      
 499   1          static int32 pos_error_sum[NUM_OF_MOTORS];
 500   1          static int32 curr_error_sum[NUM_OF_MOTORS];
 501   1          
 502   1          // check index value
 503   1          if (index >= NUM_OF_MOTORS)
 504   1              return;
 505   1      
 506   1          switch(c_mem.control_mode) {
 507   2              case CONTROL_ANGLE:
 508   2              /*case DEFLECTION_CONTROL:
 509   2              
 510   2                  if(c_mem.control_mode == DEFLECTION_CONTROL){
 511   2                                      //for deflection control the shaft position must be summed to reference
 512   2                      defl_input[index] = (g_ref.pos[index] + g_meas.pos[2]);
 513   2                      pos_error = defl_input[index] - g_meas.pos[index];
 514   2                  }
 515   2                  else 
 516   2                      // position error*/
 517   2                  
 518   2                  pos_error = g_ref.pos[index] - g_meas.pos[index];
 519   2                 
 520   2                  if (interrupt_flag){
 521   3                      interrupt_flag = FALSE;
 522   3                      interrupt_manager();
 523   3                  }
 524   2                  
 525   2                  // error sum for integral
 526   2                  pos_error_sum[index] += pos_error;
 527   2      
 528   2                  //anti wind-up
 529   2                  if (pos_error_sum[index] > POS_INTEGRAL_SAT_LIMIT)
 530   2                      pos_error_sum[index] = POS_INTEGRAL_SAT_LIMIT;
 531   2                  else{
 532   3                      if (pos_error_sum[index] < -POS_INTEGRAL_SAT_LIMIT)
 533   3                          pos_error_sum[index] = -POS_INTEGRAL_SAT_LIMIT;
 534   3                  }
 535   2                    
 536   2                  if (interrupt_flag){
 537   3                      interrupt_flag = FALSE;
 538   3                      interrupt_manager();
 539   3                  }
 540   2                  // pwm_input init
 541   2                  pwm_input = 0;
 542   2                  // Proportional
 543   2                  if (k_p != 0) {
 544   3                          
 545   3                      if ((pos_error > 131072) || (pos_error < -131072))  //if grater than 2^17
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 10  

 546   3                          pwm_input = (int32)(k_p * (pos_error >> 8)) >> 8;
 547   3                      else
 548   3                          pwm_input = (int32)(k_p * pos_error) >> 16;
 549   3                  }
 550   2                  
 551   2                  if (interrupt_flag){
 552   3                      interrupt_flag = FALSE;
 553   3                      interrupt_manager();
 554   3                  }
 555   2                            
 556   2                  // Integral
 557   2                  if (k_i != 0) 
 558   2                      pwm_input += (int32)((k_i >> 6) * pos_error_sum[index]) >> 10;
 559   2                  
 560   2                  // Derivative
 561   2                  if (k_d != 0)
 562   2                      pwm_input += (int32)(k_d * (g_measOld.pos[index] - g_meas.pos[index])) >> 16;
 563   2               
 564   2          
 565   2                  if (interrupt_flag){
 566   3                      interrupt_flag = FALSE;
 567   3                      interrupt_manager();
 568   3                  }
 569   2                   
 570   2                  // Update measure
 571   2                  //prev_pos[index] = g_meas.pos[index];
 572   2      
 573   2                  if (index == 0){
 574   3                      if (pwm_input >= 0)
 575   3                          dirM0 = 1;
 576   3                          //direction |= 0x01;
 577   3                      else
 578   3                          dirM0 = 0;
 579   3                          //direction &= 0xFE;
 580   3                  }else{ // index == 1
 581   3                      if (pwm_input >= 0)
 582   3                          dirM1 = 1;
 583   3                         // direction |= 0x02;
 584   3                      else
 585   3                          dirM1 = 0;
 586   3                          //direction &= 0xFD;
 587   3                  }
 588   2                  
 589   2                  break;
 590   2      
 591   2              case CURR_AND_POS_CONTROL:
 592   2              /*case DEFL_CURRENT_CONTROL:
 593   2      
 594   2                  if(c_mem.control_mode == DEFL_CURRENT_CONTROL){
 595   2                      //for deflection control the shaft position must be summed to reference
 596   2                      defl_input[index] = (g_ref.pos[index] + g_meas.pos[2]);
 597   2                      pos_error = defl_input[index] - g_meas.pos[index];
 598   2                  }
 599   2                  else */
 600   2                  
 601   2                  pos_error = g_ref.pos[index] - g_meas.pos[index];
 602   2      
 603   2                  pos_error_sum[index] += pos_error;
 604   2      
 605   2                  if (interrupt_flag){
 606   3                      interrupt_flag = FALSE;
 607   3                      interrupt_manager();
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 11  

 608   3                  }
 609   2      
 610   2                  // error_sum saturation
 611   2                  if (pos_error_sum[index] > POS_INTEGRAL_SAT_LIMIT)
 612   2                      pos_error_sum[index] = POS_INTEGRAL_SAT_LIMIT;
 613   2                  else{
 614   3                      if (pos_error_sum[index] < -POS_INTEGRAL_SAT_LIMIT)
 615   3                          pos_error_sum[index] = -POS_INTEGRAL_SAT_LIMIT;
 616   3                  }
 617   2                  // ------ position PID control -----
 618   2      
 619   2                  curr_ref = 0;
 620   2      
 621   2                  if (interrupt_flag){
 622   3                      interrupt_flag = FALSE;
 623   3                      interrupt_manager();
 624   3                  }
 625   2      
 626   2                  // Proportional
 627   2                  if (k_p_dl != 0)
 628   2                      curr_ref += (int32)(k_p_dl * pos_error) >> 16;
 629   2      
 630   2                  // Integral
 631   2                  if (k_i_dl != 0)
 632   2                      curr_ref += (int32)(k_i_dl * pos_error_sum[index]) >> 16;
 633   2                  
 634   2                  // Derivative
 635   2                  if (k_d_dl != 0)
 636   2                      curr_ref += (int32)(k_d_dl * (g_measOld.pos[index] - g_meas.pos[index])) >> 16;
 637   2                              
 638   2                  if (interrupt_flag){
 639   3                      interrupt_flag = FALSE;
 640   3                      interrupt_manager();
 641   3                  }
 642   2      
 643   2                  // saturate max current
 644   2                  if (curr_ref > c_mem.current_limit)
 645   2                      curr_ref = c_mem.current_limit;
 646   2                  else {
 647   3                      if (curr_ref < -c_mem.current_limit)
 648   3                          curr_ref = -c_mem.current_limit;
 649   3                  }
 650   2      
 651   2                  if (interrupt_flag){
 652   3                      interrupt_flag = FALSE;
 653   3                      interrupt_manager();
 654   3                  }
 655   2      
 656   2                  // current error
 657   2                  curr_error = curr_ref - g_meas.curr[index];
 658   2      
 659   2                  curr_error_sum[index] += curr_error;
 660   2      
 661   2                  if (curr_error_sum[index] > CURR_INTEGRAL_SAT_LIMIT)
 662   2                      curr_error_sum[index] = CURR_INTEGRAL_SAT_LIMIT;
 663   2                  else{
 664   3                      if (curr_error_sum[index] < -CURR_INTEGRAL_SAT_LIMIT)
 665   3                          curr_error_sum[index] = -CURR_INTEGRAL_SAT_LIMIT;
 666   3                  }
 667   2      
 668   2                  if (interrupt_flag){
 669   3                      interrupt_flag = FALSE;
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 12  

 670   3                      interrupt_manager();
 671   3                  }
 672   2      
 673   2                  // ----- current PID control -----
 674   2      
 675   2                  pwm_input = 0;
 676   2      
 677   2                  // Proportional
 678   2                  if (k_p_c_dl != 0)
 679   2                      pwm_input += (int32)(k_p_c_dl * curr_error) >> 16;
 680   2                  
 681   2                  // Integral
 682   2                  if (k_i_c_dl != 0)
 683   2                      pwm_input += (int32)(k_i_c_dl * curr_error_sum[index]) >> 16;
 684   2                  
 685   2                  // Derivative
 686   2                  if (k_d_c_dl != 0)
 687   2                      pwm_input += (int32)(k_d_c_dl * (prev_curr[index] - g_meas.curr[index])) >> 16;
 688   2                  
 689   2                  // Update current
 690   2                  prev_curr[index] = g_meas.curr[index];
 691   2      
 692   2                  if (interrupt_flag){
 693   3                      interrupt_flag = FALSE;
 694   3                      interrupt_manager();
 695   3                  }
 696   2      
 697   2                  if (index == 0){
 698   3                      if (pwm_input >= 0)
 699   3                          dirM0 = 1;
 700   3                          //direction |= 0x01;
 701   3                      else
 702   3                          dirM0 = 0;
 703   3                          //direction &= 0xFE;
 704   3                  }else{ // index == 1
 705   3                      if (pwm_input >= 0)
 706   3                          dirM1 = 1;
 707   3                         // direction |= 0x02;
 708   3                      else
 709   3                          dirM1 = 0;
 710   3                          //direction &= 0xFD;
 711   3                  }
 712   2      
 713   2                  break;
 714   2      
 715   2              case CONTROL_CURRENT:
 716   2      
 717   2                  // Current ref from pos ref
 718   2                  curr_ref = g_ref.pos[index] >> g_mem.res[index];
 719   2      
 720   2                  // saturate max current
 721   2                  if (curr_ref > c_mem.current_limit)
 722   2                      curr_ref = c_mem.current_limit;
 723   2                  else {
 724   3                          if (curr_ref < -c_mem.current_limit)
 725   3                              curr_ref = -c_mem.current_limit;
 726   3                      }
 727   2                  
 728   2                  // Current error
 729   2                  //curr_error = abs(curr_ref) - g_meas.curr[index];
 730   2                  curr_error = curr_ref - g_meas.curr[index];
 731   2                  
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 13  

 732   2                  // Error sum for integral
 733   2                  curr_error_sum[index] += curr_error;
 734   2      
 735   2                  //anti wind-up
 736   2                  if (curr_error_sum[index] > CURR_INTEGRAL_SAT_LIMIT)
 737   2                      curr_error_sum[index] = CURR_INTEGRAL_SAT_LIMIT;
 738   2                  else {
 739   3                          if (curr_error_sum[index] < -CURR_INTEGRAL_SAT_LIMIT) 
 740   3                              curr_error_sum[index] = -CURR_INTEGRAL_SAT_LIMIT;
 741   3                      }
 742   2                  /*
 743   2                      else{
 744   2                      if (curr_error_sum[index] < 0)
 745   2                          curr_error_sum[index] = 0;
 746   2                  }
 747   2                      */
 748   2      
 749   2                  // pwm_input init
 750   2                  pwm_input = 0;
 751   2      
 752   2                  // Proportional
 753   2                  if (k_p_c != 0)
 754   2                      pwm_input += (int32)(k_p * curr_error) >> 16;
 755   2      
 756   2      
 757   2                  // Integral
 758   2                  if (k_i_c != 0)
 759   2                      pwm_input += (int32)(k_i_c * (curr_error_sum[index] >> 6)) >> 10;
 760   2                  
 761   2                  // Derivative
 762   2                  if (k_d_c != 0)
 763   2                      pwm_input += (int32)(k_d_c * (prev_curr[index] - g_meas.curr[index])) >> 16;
 764   2      
 765   2                  // Saturate pwm_input
 766   2                  //if (pwm_input < 0)
 767   2                  //    pwm_input = 0;
 768   2      
 769   2                  // Update measure
 770   2                  prev_curr[index] = g_meas.curr[index];
 771   2                  
 772   2                  if (index == 0){
 773   3                      if (pwm_input >= 0)
 774   3                          dirM0 = 1;
 775   3                          //direction |= 0x01;
 776   3                      else
 777   3                          dirM0 = 0;
 778   3                          //direction &= 0xFE;
 779   3                  }else{ // index == 1
 780   3                      if (pwm_input >= 0)
 781   3                          dirM1 = 1;
 782   3                         // direction |= 0x02;
 783   3                      else
 784   3                          dirM1 = 0;
 785   3                          //direction &= 0xFD;
 786   3                  }
 787   2                  
 788   2                  break;
 789   2      
 790   2              case CONTROL_PWM:
 791   2                  // Direct PWM value
 792   2                  pwm_input = g_ref.pos[index] >> g_mem.res[index];
 793   2      
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 14  

 794   2                  if (index == 0){
 795   3                      if (pwm_input >= 0)
 796   3                          dirM0 = 1;
 797   3                          //direction |= 0x01;
 798   3                      else
 799   3                          dirM0 = 0;
 800   3                          //direction &= 0xFE;
 801   3                  }else{ // index == 1
 802   3                      if (pwm_input >= 0)
 803   3                          dirM1 = 1;
 804   3                         // direction |= 0x02;
 805   3                      else
 806   3                          dirM1 = 0;
 807   3                          //direction &= 0xFD;
 808   3                  }
 809   2      
 810   2                  break;
 811   2      
 812   2              default:
 813   2                  break;
 814   2          }
 815   1          
 816   1          if (interrupt_flag){
 817   2              interrupt_flag = FALSE;
 818   2              interrupt_manager();
 819   2          }
 820   1              
 821   1          // abs(pwm_input) must be lower or equal to PWM_MAX_VALUE
 822   1          if(pwm_input >  PWM_MAX_VALUE) 
 823   1              pwm_input =  PWM_MAX_VALUE;
 824   1          if(pwm_input < -PWM_MAX_VALUE) 
 825   1              pwm_input = -PWM_MAX_VALUE;
 826   1          
 827   1          if (interrupt_flag){
 828   2              interrupt_flag = FALSE;
 829   2              interrupt_manager();
 830   2          }   
 831   1      
 832   1          // remap pwm_input on pwm_limit based on input tension to have maximum 8 volts
 833   1          if (c_mem.control_mode != CONTROL_PWM)
 834   1              pwm_input = (((pwm_input << 10) / PWM_MAX_VALUE) * dev_pwm_limit) >> 10;
 835   1      
 836   1          // drive direction and pwm duty cycle
 837   1              
 838   1          if (dirM0){
 839   2              if (dirM1)
 840   2                  MOTOR_DIR_Write(0x03);
 841   2              else
 842   2                  MOTOR_DIR_Write(0x01);
 843   2          }
 844   1          else{
 845   2              if (dirM1)
 846   2                  MOTOR_DIR_Write(0x02);
 847   2              else
 848   2                  MOTOR_DIR_Write(0x00);
 849   2          }
 850   1      
 851   1          if (interrupt_flag){
 852   2              interrupt_flag = FALSE;
 853   2              interrupt_manager();
 854   2          }
 855   1          
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 15  

 856   1          if (index == 0) {
 857   2              pwm_sign[0] = SIGN(pwm_input);
 858   2              PWM_MOTORS_WriteCompare1(abs(pwm_input));
 859   2          }
 860   1          else {// index == 1
 861   2              pwm_sign[1] = SIGN(pwm_input);
 862   2              PWM_MOTORS_WriteCompare2(abs(pwm_input));
 863   2          }
 864   1          
 865   1          if (interrupt_flag){
 866   2              interrupt_flag = FALSE;
 867   2              interrupt_manager();
 868   2          }
 869   1      }
 870          
 871          //==============================================================================
 872          //                                                           ANALOG MEASUREMENTS
 873          //==============================================================================
 874          
 875          void analog_read_end() {
 876   1             
 877   1          /* =========================================================================
 878   1          /   Ideal formulation to calculate tension and current
 879   1          /
 880   1          /   tension = ((read_value_mV - offset) * 101) / gain -> [mV]
 881   1          /   current = ((read_value_mV - offset) * 375) / (gain * resistor) -> [mA]
 882   1          /
 883   1          /   Definition:
 884   1          /   read_value_mV = counts_read / 0.819 -> conversion from counts to mV
 885   1          /   offset = 2000 -> hardware amplifier bias in mV
 886   1          /   gain = 8.086 -> amplifier gain
 887   1          /   resistor = 18 -> resistor of voltage divider in KOhm 
 888   1          /
 889   1          /   Real formulation: tradeoff in good performance and accurancy, ADC_buf[] 
 890   1          /   and offset unit of measurment is counts, instead dev_tension and
 891   1          /   g_meas.curr[] are converted in properly unit.
 892   1          /  =========================================================================
 893   1          */
 894   1          
 895   1          // Wait for conversion end
 896   1          while(!ADC_STATUS_Read()){
 897   2              if (interrupt_flag){
 898   3                  interrupt_flag = FALSE;
 899   3                  interrupt_manager();
 900   3              }
 901   2          }
 902   1          
 903   1          // Convert tension read
 904   1          dev_tension = ((int32)(ADC_buf[0] - 1638) * 1952) >> 7;
 905   1          
 906   1          if (interrupt_flag){
 907   2              interrupt_flag = FALSE;
 908   2              interrupt_manager();
 909   2          }
 910   1      
 911   1          // Until there is no valid input tension repeat this measurement
 912   1          
 913   1          if (dev_tension > 0){
 914   2              
 915   2              // Set PWM depends on tension
 916   2              pwm_limit_search();
 917   2              
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 16  

 918   2              // Check Interrupt 
 919   2          
 920   2              if (interrupt_flag){
 921   3                  interrupt_flag = FALSE;
 922   3                  interrupt_manager();
 923   3              }
 924   2      
 925   2              // Filter and Set currents
 926   2              g_meas.curr[0] = filter_i1((int16) (((int32)(ADC_buf[1] - 1638) * 25771) >> 13) * pwm_sign[0]);
 927   2              
 928   2              // Check Interrupt 
 929   2          
 930   2              if (interrupt_flag){
 931   3                  interrupt_flag = FALSE;
 932   3                  interrupt_manager();
 933   3              }
 934   2              g_meas.curr[1] = filter_i2((int16) (((int32)(ADC_buf[2] - 1638) * 25771) >> 13) * pwm_sign[1]);
 935   2              
 936   2              // Check Interrupt 
 937   2          
 938   2              if (interrupt_flag){
 939   3                  interrupt_flag = FALSE;
 940   3                  interrupt_manager();
 941   3              }
 942   2          }
 943   1          else
 944   1          {
 945   2              g_meas.curr[0] = 0;
 946   2              g_meas.curr[1] = 0;
 947   2          }
 948   1      }
 949          
 950          //==============================================================================
 951          //                                                               ENCODER READING
 952          //==============================================================================
 953          
 954          void encoder_reading(const uint8 idx, const uint8 flag)
 955          {
 956   1          uint8 CYDATA index = idx;
 957   1          
 958   1          uint8 jj;
 959   1          
 960   1          uint32 data_encoder;
 961   1          int32 value_encoder;
 962   1          int32 aux;
 963   1      
 964   1          static int32 last_value_encoder[NUM_OF_SENSORS];
 965   1      
 966   1          static uint8 error[NUM_OF_SENSORS];
 967   1          
 968   1          static CYBIT only_first_time = TRUE;
 969   1      
 970   1          // static int32 l_value[NUM_OF_SENSORS];   //last value for vel
 971   1          // static int32 ll_value[NUM_OF_SENSORS];  //last last value for vel
 972   1          // static int32 lll_value[NUM_OF_SENSORS];  //last last last value for vel
 973   1      
 974   1          if (index >= NUM_OF_SENSORS)
 975   1              return;
 976   1          
 977   1          if (reset_last_value_flag) {
 978   2              for (jj = NUM_OF_SENSORS; jj--;) {
 979   3                  last_value_encoder[jj] = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 17  

 980   3              }
 981   2              reset_last_value_flag = 0;
 982   2          }
 983   1      
 984   1          //======================================================     reading sensors
 985   1          if (index == 0)
 986   1                  data_encoder = SHIFTREG_ENC_1_ReadData() & 0x3FFFF;
 987   1          else {
 988   2              if (index == 1)
 989   2                  data_encoder = SHIFTREG_ENC_2_ReadData() & 0x3FFFF;
 990   2              else {
 991   3                  if (index == 2)
 992   3                      data_encoder = SHIFTREG_ENC_3_ReadData() & 0x3FFFF;
 993   3                  else // index == 3
 994   3                      data_encoder = SHIFTREG_ENC_4_ReadData() & 0x3FFFF;
 995   3              }
 996   2          }    
 997   1      
 998   1          if (check_enc_data(&data_encoder)) {
 999   2              if(flag)    // if the flag is set, save the measurement without offset to initialize cuff's zero p
             -osition
1000   2                  value_encoder = (int16) (32768 - ((data_encoder & 0x3FFC0) >> 2));
1001   2              else
1002   2                  value_encoder = (int16) (32768 - ((data_encoder & 0x3FFC0) >> 2) + g_mem.m_off[index]);  
1003   2      
1004   2              // Initialize last_value_encoder
1005   2              if (only_first_time) {
1006   3                  last_value_encoder[index] = value_encoder;
1007   3                  
1008   3                  if (index == (NUM_OF_SENSORS - 1))
1009   3                      only_first_time = 0;
1010   3              }
1011   2      
1012   2              // Take care of rotations
1013   2              aux = value_encoder - last_value_encoder[index];
1014   2      
1015   2              // ====================== 1 TURN ======================
1016   2              // -32768                    0                    32767 -32768                   0                
             -     32767
1017   2              // |-------------------------|-------------------------|-------------------------|----------------
             ----------|
1018   2              //              |                         |      |           |      |                         |
1019   2              //           -16384                     16383    |           |   -16384                     16383
1020   2              //                                               |           |
1021   2              //                                           24575           -24576
1022   2              //                                               |___________|
1023   2              //                                                   49152
1024   2      
1025   2              // if we are in the right interval, take care of rotation
1026   2              // and update the variable only if the difference between
1027   2              // one measure and another is less than 1/4 of turn
1028   2      
1029   2              // Considering we are sampling at 1kHz, this means that our shaft needs
1030   2              // to go slower than 1/4 turn every ms -> 1 turn every 4ms
1031   2              // equal to 250 turn/s -> 15000 RPM
1032   2      
1033   2              if (aux > 49152)
1034   2                  g_meas.rot[index]--;
1035   2              else{ 
1036   3                  if (aux < -49152)
1037   3                      g_meas.rot[index]++;
1038   3                  else{
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 18  

1039   4                      if (abs(aux) > 16384) { // if two measure are too far
1040   5                          error[index]++;
1041   5                          if (error[index] < 10)
1042   5                              // Discard
1043   5                              return;
1044   5                      }
1045   4                  }
1046   3              }
1047   2              
1048   2              error[index] = 0;
1049   2              
1050   2              last_value_encoder[index] = value_encoder;
1051   2      
1052   2              value_encoder += (int32)g_meas.rot[index] << 16;
1053   2      
1054   2              if (c_mem.m_mult[index] != 1.0)
1055   2                  value_encoder *= c_mem.m_mult[index];
1056   2            
1057   2              g_meas.pos[index] = value_encoder;
1058   2          }
1059   1      
1060   1          // // velocity calculation
1061   1          // switch(i) {
1062   1          //     case 0: {
1063   1          //         g_meas.vel[i] = (int16)filter_vel_1((3*value_encoder + l_value[i] - ll_value[i] - 3*lll_val
             -ue[i]) / 10);
1064   1          //         break;
1065   1          //     }
1066   1          //     case 1: {
1067   1          //         g_meas.vel[i] = (int16)filter_vel_2((3*value_encoder + l_value[i] - ll_value[i] - 3*lll_val
             -ue[i]) / 10);
1068   1          //         break;
1069   1          //     }
1070   1          //     case 2: {
1071   1          //         g_meas.vel[i] = (int16)filter_vel_3((3*value_encoder + l_value[i] - ll_value[i] - 3*lll_val
             -ue[i]) / 10);
1072   1          //         break;
1073   1          //     }
1074   1          // }
1075   1      
1076   1          // // update old values
1077   1          // lll_value[i] = ll_value[i];
1078   1          // ll_value[i] = l_value[i];
1079   1          // l_value[i] = value_encoder;
1080   1      }
1081          //==============================================================================
1082          //                                                              PWM_LIMIT_SEARCH
1083          //==============================================================================
1084          
1085          void pwm_limit_search() {
1086   1          
1087   1          uint8  CYDATA index;
1088   1          uint16 CYDATA max_tension = 25500;
1089   1          uint16 CYDATA max_tension_6v_mod = 14750;
1090   1      
1091   1          if(g_mem.power_tension < 8000) {
1092   2              //Mod. 6 Volts
1093   2              if(dev_tension > max_tension_6v_mod)
1094   2                  dev_pwm_limit = 0;
1095   2      
1096   2              else {
1097   3                  if(dev_tension < g_mem.power_tension)
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 19  

1098   3                      dev_pwm_limit = 100;
1099   3                  else {
1100   4                      index = (uint8)((dev_tension - g_mem.power_tension) >> 9);
1101   4                      dev_pwm_limit = hitech_pwm_preload_values_6v[index];
1102   4                  }
1103   3              }
1104   2          }
1105   1          else {
1106   2              // 8 - 12 volts
1107   2              if (dev_tension > max_tension)    // Max value 
1108   2                  dev_pwm_limit = 0;
1109   2              else{ 
1110   3                  if (dev_tension < g_mem.power_tension) // Min value
1111   3                      dev_pwm_limit = 100;
1112   3                  else {                  
1113   4                      index = (uint8)((dev_tension - 8000) >> 9);
1114   4                      if(g_mem.power_tension < 11500)
1115   4                          dev_pwm_limit = hitech_pwm_preload_values[index];
1116   4                      else
1117   4                          dev_pwm_limit = pwm_preload_values[index];
1118   4                  }
1119   3              }
1120   2          }
1121   1      }
1122          
1123          //==============================================================================
1124          //                                                         PRETENSIONING PROCESS
1125          //==============================================================================
1126          
1127          void pretensioning_process() {
1128   1          
1129   1          static int16 epsilon = 10;
1130   1          static uint8 phase = 0;
1131   1          static uint32 phase_counter = 0;
1132   1          int32 aux;
1133   1          uint8 i = 0;
1134   1          
1135   1          switch(phase) {
1136   2              case 0:     // closing
1137   2                      aux = (5 * (220 - g_meas.curr[0])) << g_mem.res[0];
1138   2                      g_refNew.pos[0] = g_refOld.pos[0] - aux;
1139   2                      
1140   2                      aux = (5 * (220 + g_meas.curr[1])) << g_mem.res[1];
1141   2                      g_refNew.pos[1] = g_refOld.pos[1] + aux;
1142   2                                      
1143   2                      if (phase_counter >= 10 && dev_tension <= 0) {
1144   3                          pretensioning_flag = FALSE;
1145   3                          g_refNew.pos[0] = 0;
1146   3                          g_refNew.pos[1] = 0;
1147   3                      }
1148   2                      
1149   2                      phase_counter = phase_counter + 1;
1150   2                                     
1151   2                      if ( (g_meas.curr[0] > 220-epsilon ) && (g_meas.curr[1] < -220+epsilon )){
1152   3                          phase = 1;
1153   3                          phase_counter = 0;
1154   3                          //g_refNew.pos[0] = g_meas.pos[0];
1155   3                          //g_refNew.pos[1] = g_meas.pos[1];
1156   3                      }
1157   2                      break;
1158   2              case 1:     // releasing
1159   2                      
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 20  

1160   2                      aux = 16 << g_mem.res[0];
1161   2                      g_refNew.pos[0] = g_refOld.pos[0] + aux;
1162   2                      
1163   2                      aux = 16 << g_mem.res[1];
1164   2                      g_refNew.pos[1] = g_refOld.pos[1] - aux;
1165   2                          
1166   2                      if (phase_counter >  80){//((g_meas.curr[0] > -10) && (g_meas.curr[1] < 10)){
1167   3                          pretensioning_flag = FALSE;
1168   3                          pret_done = TRUE;
1169   3                          phase = 0;
1170   3                          reset_last_value_flag = 1;
1171   3                          for (i = 0; i< NUM_OF_SENSORS; i++) {
1172   4                             pret_offset_pos[i] = g_refNew.pos[i];  // con questo comando funziona sicuramente
1173   4                             /*encoder_reading(i, TRUE);
1174   4                             g_mem.m_off[i] = -g_meas.pos[i];
1175   4                             g_meas.rot[i] = 0;*/
1176   4                              
1177   4                            // g_refNew.pos[i] = 0;//<<g_mem.res[i];
1178   4                             
1179   4                          }
1180   3                          
1181   3                          //memStore(0);
1182   3                         
1183   3      
1184   3                          
1185   3                       /*   g_refOld.pos[0] = 0;
1186   3                          g_refOld.pos[1] = 0;
1187   3                          g_ref.pos[0] = 0;
1188   3                          g_ref.pos[1] = 0;
1189   3                          
1190   3                         */
1191   3                      }
1192   2                      
1193   2                      phase_counter = phase_counter + 1;
1194   2                      break;
1195   2              default:
1196   2                      break;
1197   2          }    
1198   1      }
1199          
1200          /* [] END OF FILE */
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 21  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ISR_WATCHDOG_Handler (BEGIN)
                                           ; SOURCE LINE # 161
                                           ; SOURCE LINE # 165
0000 D200        E     SETB    watchdog_flag
                                           ; SOURCE LINE # 167
0002 32                RETI    
             ; FUNCTION ISR_WATCHDOG_Handler (END)

             ; FUNCTION ISR_RS485_RX_ExInterrupt (BEGIN)
                                           ; SOURCE LINE # 173
                                           ; SOURCE LINE # 177
0000 D200        E     SETB    interrupt_flag
                                           ; SOURCE LINE # 179
0002 32                RETI    
             ; FUNCTION ISR_RS485_RX_ExInterrupt (END)

             ; FUNCTION interrupt_manager (BEGIN)
                                           ; SOURCE LINE # 196
                                           ; SOURCE LINE # 212
0000 E4                CLR     A
0001 F500        R     MOV     package_count,A
0003         ?C0003:
                                           ; SOURCE LINE # 218
0003 120000      E     LCALL   UART_RS485_GetRxBufferSize
0006 EF                MOV     A,R7
0007 7003              JNZ     $ + 5H
0009 020000      R     LJMP    ?C0027
000C E500        R     MOV     A,package_count
000E C3                CLR     C
000F 9406              SUBB    A,#06H
0011 4003              JC      $ + 5H
0013 020000      R     LJMP    ?C0027
                                           ; SOURCE LINE # 222
0016 120000      E     LCALL   UART_RS485_GetChar
0019 8F00        R     MOV     rx_data,R7
                                           ; SOURCE LINE # 224
001B E500        R     MOV     A,state
001D 14                DEC     A
001E 6049              JZ      ?C0010
0020 14                DEC     A
0021 607F              JZ      ?C0015
0023 14                DEC     A
0024 7003              JNZ     $ + 5H
0026 020000      R     LJMP    ?C0022
0029 14                DEC     A
002A 7003              JNZ     $ + 5H
002C 020000      R     LJMP    ?C0025
002F 2404              ADD     A,#04H
0031 70D0              JNZ     ?C0003
                                           ; SOURCE LINE # 226
0033         ?C0006:
                                           ; SOURCE LINE # 228
0033 850000      R     MOV     rx_queue,rx_queue+01H
                                           ; SOURCE LINE # 229
0036 850000      R     MOV     rx_queue+01H,rx_queue+02H
                                           ; SOURCE LINE # 230
0039 850000      R     MOV     rx_queue+02H,rx_data
                                           ; SOURCE LINE # 233
003C E500        R     MOV     A,rx_queue+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 22  

003E B43A11            CJNE    A,#03AH,?C0007
0041 E500        R     MOV     A,rx_queue+02H
0043 B43A0C            CJNE    A,#03AH,?C0007
                                           ; SOURCE LINE # 234
0046 E4                CLR     A
0047 F500        R     MOV     rx_queue,A
                                           ; SOURCE LINE # 235
0049 F500        R     MOV     rx_queue+01H,A
                                           ; SOURCE LINE # 236
004B F500        R     MOV     rx_queue+02H,A
                                           ; SOURCE LINE # 237
004D 750001      R     MOV     state,#01H
                                           ; SOURCE LINE # 238
0050 80B1              SJMP    ?C0003
0052         ?C0007:
                                           ; SOURCE LINE # 239
0052 E500        R     MOV     A,rx_queue
0054 B43FAC            CJNE    A,#03FH,?C0003
0057 E500        R     MOV     A,rx_queue+01H
0059 B40DA7            CJNE    A,#0DH,?C0003
005C E500        R     MOV     A,rx_queue+02H
005E 640A              XRL     A,#0AH
0060 70A1              JNZ     ?C0003
                                           ; SOURCE LINE # 242
0062 FF                MOV     R7,A
0063 FE                MOV     R6,A
0064 120000      E     LCALL   _infoGet
                                           ; SOURCE LINE # 243
0067 809A              SJMP    ?C0003
                                           ; SOURCE LINE # 246
0069         ?C0010:
                                           ; SOURCE LINE # 249
0069 900000      E     MOV     DPTR,#c_mem+01H
006C E0                MOVX    A,@DPTR
006D 6500        R     XRL     A,rx_data
006F 6022              JZ      ?C0012
0071 E500        R     MOV     A,rx_data
0073 601E              JZ      ?C0012
0075 900000      E     MOV     DPTR,#c_mem+085H
0078 E0                MOVX    A,@DPTR
0079 B5001B            CJNE    A,rx_data,?C0011
007C 900000      E     MOV     DPTR,#c_mem+06FH
007F E0                MOVX    A,@DPTR
0080 6401              XRL     A,#01H
0082 600F              JZ      ?C0012
0084 900000      E     MOV     DPTR,#c_mem+078H
0087 E0                MOVX    A,@DPTR
0088 6401              XRL     A,#01H
008A 6007              JZ      ?C0012
008C 900000      E     MOV     DPTR,#c_mem+086H
008F E0                MOVX    A,@DPTR
0090 B40104            CJNE    A,#01H,?C0011
0093         ?C0012:
                                           ; SOURCE LINE # 250
0093 C200        R     CLR     rx_data_type
0095 8002              SJMP    ?C0014
0097         ?C0011:
                                           ; SOURCE LINE # 252
0097 D200        R     SETB    rx_data_type
0099         ?C0014:
                                           ; SOURCE LINE # 254
0099 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 23  

009A F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 255
009C 750002      R     MOV     state,#02H
                                           ; SOURCE LINE # 256
009F 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 259
00A2         ?C0015:
                                           ; SOURCE LINE # 262
00A2 850000      R     MOV     data_packet_length,rx_data
                                           ; SOURCE LINE # 264
00A5 E500        R     MOV     A,data_packet_length
00A7 D3                SETB    C
00A8 9401              SUBB    A,#01H
00AA 5008              JNC     ?C0016
                                           ; SOURCE LINE # 265
00AC E4                CLR     A
00AD F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 266
00AF F500        R     MOV     state,A
                                           ; SOURCE LINE # 267
00B1 020000      R     LJMP    ?C0003
00B4         ?C0016:
00B4 E500        R     MOV     A,data_packet_length
00B6 D3                SETB    C
00B7 9480              SUBB    A,#080H
00B9 4008              JC      ?C0018
                                           ; SOURCE LINE # 268
00BB E4                CLR     A
00BC F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 269
00BE F500        R     MOV     state,A
                                           ; SOURCE LINE # 270
00C0 020000      R     LJMP    ?C0003
00C3         ?C0018:
                                           ; SOURCE LINE # 271
00C3 E4                CLR     A
00C4 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 273
00C6 200006            JB      rx_data_type,?C0020
                                           ; SOURCE LINE # 274
00C9 750003      R     MOV     state,#03H
00CC 020000      R     LJMP    ?C0003
00CF         ?C0020:
                                           ; SOURCE LINE # 276
00CF 750004      R     MOV     state,#04H
                                           ; SOURCE LINE # 277
                                           ; SOURCE LINE # 278
00D2 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 281
00D5         ?C0022:
                                           ; SOURCE LINE # 283
00D5 7400        R     MOV     A,#LOW data_packet_buffer
00D7 2500        R     ADD     A,data_packet_index
00D9 F582              MOV     DPL,A
00DB E4                CLR     A
00DC 3400        R     ADDC    A,#HIGH data_packet_buffer
00DE F583              MOV     DPH,A
00E0 E500        R     MOV     A,rx_data
00E2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 284
00E3 0500        R     INC     data_packet_index
                                           ; SOURCE LINE # 287
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 24  

00E5 E500        R     MOV     A,data_packet_index
00E7 C3                CLR     C
00E8 9500        R     SUBB    A,data_packet_length
00EA 5003              JNC     $ + 5H
00EC 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 289
00EF 200025            JB      rx_data_type,?C0024
                                           ; SOURCE LINE # 291
00F2 AF00        R     MOV     R7,data_packet_length
00F4 7E00              MOV     R6,#00H
00F6 7800        E     MOV     R0,#LOW g_rx
00F8 7C00        E     MOV     R4,#HIGH g_rx
00FA 7D01              MOV     R5,#01H
00FC 7B01              MOV     R3,#01H
00FE 7A00        R     MOV     R2,#HIGH data_packet_buffer
0100 7900        R     MOV     R1,#LOW data_packet_buffer
0102 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 292
0105 900000      E     MOV     DPTR,#g_rx+080H
0108 E4                CLR     A
0109 F0                MOVX    @DPTR,A
010A A3                INC     DPTR
010B E500        R     MOV     A,data_packet_length
010D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 293
010E 900000      E     MOV     DPTR,#g_rx+084H
0111 7401              MOV     A,#01H
0113 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 294
0114 120000      E     LCALL   commProcess
                                           ; SOURCE LINE # 295
0117         ?C0024:
                                           ; SOURCE LINE # 297
0117 E4                CLR     A
0118 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 298
011A F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 299
011C F500        R     MOV     state,A
                                           ; SOURCE LINE # 300
011E 0500        R     INC     package_count
                                           ; SOURCE LINE # 302
                                           ; SOURCE LINE # 303
0120 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 306
0123         ?C0025:
                                           ; SOURCE LINE # 307
0123 1500        R     DEC     data_packet_length
0125 E500        R     MOV     A,data_packet_length
0127 6003              JZ      $ + 5H
0129 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 308
012C F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 309
012E F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 310
0130 7F01              MOV     R7,#01H
0132 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 311
0135 E4                CLR     A
0136 FF                MOV     R7,A
0137 120000      E     LCALL   _RS485_CTS_Write
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 25  

                                           ; SOURCE LINE # 312
013A E4                CLR     A
013B F500        R     MOV     state,A
                                           ; SOURCE LINE # 313
013D 0500        R     INC     package_count
                                           ; SOURCE LINE # 314
                                           ; SOURCE LINE # 315
013F 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 316
                                           ; SOURCE LINE # 317
0142 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 318
0145         ?C0027:
0145 22                RET     
             ; FUNCTION interrupt_manager (END)

             ; FUNCTION function_scheduler (BEGIN)
                                           ; SOURCE LINE # 328
                                           ; SOURCE LINE # 334
0000 120000      E     LCALL   MY_TIMER_ReadCounter
0003 900000      E     MOV     DPTR,#timer_value0
0006 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 336
0009 7F01              MOV     R7,#01H
000B 120000      E     LCALL   _ADC_SOC_Write
                                           ; SOURCE LINE # 340
000E 300005            JNB     interrupt_flag,?C0028
                                           ; SOURCE LINE # 341
0011 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 342
0013 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 343
0016         ?C0028:
                                           ; SOURCE LINE # 347
0016 E4                CLR     A
0017 FD                MOV     R5,A
0018 FF                MOV     R7,A
0019 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 351
001C 300005            JNB     interrupt_flag,?C0029
                                           ; SOURCE LINE # 352
001F C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 353
0021 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 354
0024         ?C0029:
                                           ; SOURCE LINE # 356
0024 E4                CLR     A
0025 FD                MOV     R5,A
0026 7F01              MOV     R7,#01H
0028 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 360
002B 300005            JNB     interrupt_flag,?C0030
                                           ; SOURCE LINE # 361
002E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 362
0030 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 363
0033         ?C0030:
                                           ; SOURCE LINE # 376
0033 E4                CLR     A
0034 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 26  

0035 120000      R     LCALL   _motor_control
                                           ; SOURCE LINE # 380
0038 300005            JNB     interrupt_flag,?C0031
                                           ; SOURCE LINE # 381
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 382
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 383
0040         ?C0031:
                                           ; SOURCE LINE # 385
0040 7F01              MOV     R7,#01H
0042 120000      R     LCALL   _motor_control
                                           ; SOURCE LINE # 389
0045 300005            JNB     interrupt_flag,?C0032
                                           ; SOURCE LINE # 390
0048 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 391
004A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 392
004D         ?C0032:
                                           ; SOURCE LINE # 396
004D 120000      R     LCALL   analog_read_end
                                           ; SOURCE LINE # 416
0050 300026            JNB     pretensioning_flag,?C0033
                                           ; SOURCE LINE # 417
0053 900000      R     MOV     DPTR,#counter_calibration
0056 E0                MOVX    A,@DPTR
0057 7004              JNZ     ?C0197
0059 A3                INC     DPTR
005A E0                MOVX    A,@DPTR
005B 6464              XRL     A,#064H
005D         ?C0197:
005D 700A              JNZ     ?C0034
                                           ; SOURCE LINE # 418
005F 120000      R     LCALL   pretensioning_process
                                           ; SOURCE LINE # 419
0062 E4                CLR     A
0063 900000      R     MOV     DPTR,#counter_calibration
0066 F0                MOVX    @DPTR,A
0067 A3                INC     DPTR
0068 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 420
0069         ?C0034:
                                           ; SOURCE LINE # 421
0069 900000      R     MOV     DPTR,#counter_calibration+01H
006C E0                MOVX    A,@DPTR
006D 04                INC     A
006E F0                MOVX    @DPTR,A
006F 7006              JNZ     ?C0198
0071 900000      R     MOV     DPTR,#counter_calibration
0074 E0                MOVX    A,@DPTR
0075 04                INC     A
0076 F0                MOVX    @DPTR,A
0077         ?C0198:
                                           ; SOURCE LINE # 422
0077 8012              SJMP    ?C0035
0079         ?C0033:
                                           ; SOURCE LINE # 423
0079 300003            JNB     cuff_flag_force,?C0036
                                           ; SOURCE LINE # 424
007C 120000      E     LCALL   drive_cuff
007F         ?C0036:
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 27  

                                           ; SOURCE LINE # 426
007F 300003            JNB     cuff_flag_proprio,?C0037
                                           ; SOURCE LINE # 427
0082 120000      E     LCALL   slide_cuff
0085         ?C0037:
                                           ; SOURCE LINE # 429
0085 300003            JNB     cuff_flag_force_proprio,?C0035
                                           ; SOURCE LINE # 430
0088 120000      E     LCALL   force_and_slide_cuff
                                           ; SOURCE LINE # 431
008B         ?C0035:
                                           ; SOURCE LINE # 433
008B 300005            JNB     interrupt_flag,?C0039
                                           ; SOURCE LINE # 434
008E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 435
0090 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 436
0093         ?C0039:
                                           ; SOURCE LINE # 442
0093 7800        E     MOV     R0,#LOW g_measOld
0095 7C00        E     MOV     R4,#HIGH g_measOld
0097 7D01              MOV     R5,#01H
0099 7B01              MOV     R3,#01H
009B 7A00        E     MOV     R2,#HIGH g_meas
009D 7900        E     MOV     R1,#LOW g_meas
009F 7E00              MOV     R6,#00H
00A1 7F1F              MOV     R7,#01FH
00A3 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 443
00A6 7800        E     MOV     R0,#LOW g_refOld
00A8 7C00        E     MOV     R4,#HIGH g_refOld
00AA 7D01              MOV     R5,#01H
00AC 7B01              MOV     R3,#01H
00AE 7A00        E     MOV     R2,#HIGH g_ref
00B0 7900        E     MOV     R1,#LOW g_ref
00B2 7E00              MOV     R6,#00H
00B4 7F09              MOV     R7,#09H
00B6 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 446
00B9 7800        E     MOV     R0,#LOW g_ref
00BB 7C00        E     MOV     R4,#HIGH g_ref
00BD 7D01              MOV     R5,#01H
00BF 7B01              MOV     R3,#01H
00C1 7A00        E     MOV     R2,#HIGH g_refNew
00C3 7900        E     MOV     R1,#LOW g_refNew
00C5 7E00              MOV     R6,#00H
00C7 7F09              MOV     R7,#09H
00C9 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 448
00CC 300005            JNB     interrupt_flag,?C0040
                                           ; SOURCE LINE # 449
00CF C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 450
00D1 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 451
00D4         ?C0040:
                                           ; SOURCE LINE # 455
00D4 120000      E     LCALL   MY_TIMER_ReadCounter
00D7 900000      E     MOV     DPTR,#timer_value
00DA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 456
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 28  

00DD 7F40              MOV     R7,#040H
00DF 7E4B              MOV     R6,#04BH
00E1 7D4C              MOV     R5,#04CH
00E3 7C00              MOV     R4,#00H
00E5 120000      E     LCALL   _MY_TIMER_WriteCounter
                                           ; SOURCE LINE # 458
00E8 22                RET     
             ; FUNCTION function_scheduler (END)

             ; FUNCTION _motor_control (BEGIN)
                                           ; SOURCE LINE # 465
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 467
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 471
0002 E4                CLR     A
0003 F500        R     MOV     pwm_input+03H,A
0005 F500        R     MOV     pwm_input+02H,A
0007 F500        R     MOV     pwm_input+01H,A
0009 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 477
000B 900000      E     MOV     DPTR,#c_mem+02H
000E E0                MOVX    A,@DPTR
000F FC                MOV     R4,A
0010 A3                INC     DPTR
0011 E0                MOVX    A,@DPTR
0012 FD                MOV     R5,A
0013 A3                INC     DPTR
0014 E0                MOVX    A,@DPTR
0015 FE                MOV     R6,A
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 F500        R     MOV     k_p+03H,A
001A 8E00        R     MOV     k_p+02H,R6
001C 8D00        R     MOV     k_p+01H,R5
001E 8C00        R     MOV     k_p,R4
                                           ; SOURCE LINE # 478
0020 A3                INC     DPTR
0021 E0                MOVX    A,@DPTR
0022 FC                MOV     R4,A
0023 A3                INC     DPTR
0024 E0                MOVX    A,@DPTR
0025 FD                MOV     R5,A
0026 A3                INC     DPTR
0027 E0                MOVX    A,@DPTR
0028 FE                MOV     R6,A
0029 A3                INC     DPTR
002A E0                MOVX    A,@DPTR
002B F500        R     MOV     k_i+03H,A
002D 8E00        R     MOV     k_i+02H,R6
002F 8D00        R     MOV     k_i+01H,R5
0031 8C00        R     MOV     k_i,R4
                                           ; SOURCE LINE # 479
0033 A3                INC     DPTR
0034 E0                MOVX    A,@DPTR
0035 FC                MOV     R4,A
0036 A3                INC     DPTR
0037 E0                MOVX    A,@DPTR
0038 FD                MOV     R5,A
0039 A3                INC     DPTR
003A E0                MOVX    A,@DPTR
003B FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 29  

003C A3                INC     DPTR
003D E0                MOVX    A,@DPTR
003E F500        R     MOV     k_d+03H,A
0040 8E00        R     MOV     k_d+02H,R6
0042 8D00        R     MOV     k_d+01H,R5
0044 8C00        R     MOV     k_d,R4
                                           ; SOURCE LINE # 481
0046 A3                INC     DPTR
0047 E0                MOVX    A,@DPTR
0048 FC                MOV     R4,A
0049 A3                INC     DPTR
004A E0                MOVX    A,@DPTR
004B FD                MOV     R5,A
004C A3                INC     DPTR
004D E0                MOVX    A,@DPTR
004E FE                MOV     R6,A
004F A3                INC     DPTR
0050 E0                MOVX    A,@DPTR
0051 F500        R     MOV     k_p_c+03H,A
0053 8E00        R     MOV     k_p_c+02H,R6
0055 8D00        R     MOV     k_p_c+01H,R5
0057 8C00        R     MOV     k_p_c,R4
                                           ; SOURCE LINE # 482
0059 A3                INC     DPTR
005A E0                MOVX    A,@DPTR
005B FC                MOV     R4,A
005C A3                INC     DPTR
005D E0                MOVX    A,@DPTR
005E FD                MOV     R5,A
005F A3                INC     DPTR
0060 E0                MOVX    A,@DPTR
0061 FE                MOV     R6,A
0062 A3                INC     DPTR
0063 E0                MOVX    A,@DPTR
0064 F500        R     MOV     k_i_c+03H,A
0066 8E00        R     MOV     k_i_c+02H,R6
0068 8D00        R     MOV     k_i_c+01H,R5
006A 8C00        R     MOV     k_i_c,R4
                                           ; SOURCE LINE # 483
006C A3                INC     DPTR
006D E0                MOVX    A,@DPTR
006E FC                MOV     R4,A
006F A3                INC     DPTR
0070 E0                MOVX    A,@DPTR
0071 FD                MOV     R5,A
0072 A3                INC     DPTR
0073 E0                MOVX    A,@DPTR
0074 FE                MOV     R6,A
0075 A3                INC     DPTR
0076 E0                MOVX    A,@DPTR
0077 F500        R     MOV     k_d_c+03H,A
0079 8E00        R     MOV     k_d_c+02H,R6
007B 8D00        R     MOV     k_d_c+01H,R5
007D 8C00        R     MOV     k_d_c,R4
                                           ; SOURCE LINE # 485
007F A3                INC     DPTR
0080 E0                MOVX    A,@DPTR
0081 FC                MOV     R4,A
0082 A3                INC     DPTR
0083 E0                MOVX    A,@DPTR
0084 FD                MOV     R5,A
0085 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 30  

0086 E0                MOVX    A,@DPTR
0087 FE                MOV     R6,A
0088 A3                INC     DPTR
0089 E0                MOVX    A,@DPTR
008A F500        R     MOV     k_p_dl+03H,A
008C 8E00        R     MOV     k_p_dl+02H,R6
008E 8D00        R     MOV     k_p_dl+01H,R5
0090 8C00        R     MOV     k_p_dl,R4
                                           ; SOURCE LINE # 486
0092 A3                INC     DPTR
0093 E0                MOVX    A,@DPTR
0094 FC                MOV     R4,A
0095 A3                INC     DPTR
0096 E0                MOVX    A,@DPTR
0097 FD                MOV     R5,A
0098 A3                INC     DPTR
0099 E0                MOVX    A,@DPTR
009A FE                MOV     R6,A
009B A3                INC     DPTR
009C E0                MOVX    A,@DPTR
009D F500        R     MOV     k_i_dl+03H,A
009F 8E00        R     MOV     k_i_dl+02H,R6
00A1 8D00        R     MOV     k_i_dl+01H,R5
00A3 8C00        R     MOV     k_i_dl,R4
                                           ; SOURCE LINE # 487
00A5 A3                INC     DPTR
00A6 E0                MOVX    A,@DPTR
00A7 FC                MOV     R4,A
00A8 A3                INC     DPTR
00A9 E0                MOVX    A,@DPTR
00AA FD                MOV     R5,A
00AB A3                INC     DPTR
00AC E0                MOVX    A,@DPTR
00AD FE                MOV     R6,A
00AE A3                INC     DPTR
00AF E0                MOVX    A,@DPTR
00B0 F500        R     MOV     k_d_dl+03H,A
00B2 8E00        R     MOV     k_d_dl+02H,R6
00B4 8D00        R     MOV     k_d_dl+01H,R5
00B6 8C00        R     MOV     k_d_dl,R4
                                           ; SOURCE LINE # 489
00B8 A3                INC     DPTR
00B9 E0                MOVX    A,@DPTR
00BA FC                MOV     R4,A
00BB A3                INC     DPTR
00BC E0                MOVX    A,@DPTR
00BD FD                MOV     R5,A
00BE A3                INC     DPTR
00BF E0                MOVX    A,@DPTR
00C0 FE                MOV     R6,A
00C1 A3                INC     DPTR
00C2 E0                MOVX    A,@DPTR
00C3 F500        R     MOV     k_p_c_dl+03H,A
00C5 8E00        R     MOV     k_p_c_dl+02H,R6
00C7 8D00        R     MOV     k_p_c_dl+01H,R5
00C9 8C00        R     MOV     k_p_c_dl,R4
                                           ; SOURCE LINE # 490
00CB A3                INC     DPTR
00CC E0                MOVX    A,@DPTR
00CD FC                MOV     R4,A
00CE A3                INC     DPTR
00CF E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 31  

00D0 FD                MOV     R5,A
00D1 A3                INC     DPTR
00D2 E0                MOVX    A,@DPTR
00D3 FE                MOV     R6,A
00D4 A3                INC     DPTR
00D5 E0                MOVX    A,@DPTR
00D6 F500        R     MOV     k_i_c_dl+03H,A
00D8 8E00        R     MOV     k_i_c_dl+02H,R6
00DA 8D00        R     MOV     k_i_c_dl+01H,R5
00DC 8C00        R     MOV     k_i_c_dl,R4
                                           ; SOURCE LINE # 491
00DE A3                INC     DPTR
00DF E0                MOVX    A,@DPTR
00E0 FC                MOV     R4,A
00E1 A3                INC     DPTR
00E2 E0                MOVX    A,@DPTR
00E3 FD                MOV     R5,A
00E4 A3                INC     DPTR
00E5 E0                MOVX    A,@DPTR
00E6 FE                MOV     R6,A
00E7 A3                INC     DPTR
00E8 E0                MOVX    A,@DPTR
00E9 F500        R     MOV     k_d_c_dl+03H,A
00EB 8E00        R     MOV     k_d_c_dl+02H,R6
00ED 8D00        R     MOV     k_d_c_dl+01H,R5
00EF 8C00        R     MOV     k_d_c_dl,R4
                                           ; SOURCE LINE # 503
00F1 E500        R     MOV     A,index
00F3 C3                CLR     C
00F4 9402              SUBB    A,#02H
00F6 4003              JC      $ + 5H
00F8 020000      R     LJMP    ?C0043
00FB         ?C0042:
                                           ; SOURCE LINE # 506
00FB 900000      E     MOV     DPTR,#c_mem+036H
00FE E0                MOVX    A,@DPTR
00FF 14                DEC     A
0100 7003              JNZ     $ + 5H
0102 020000      R     LJMP    ?C0109
0105 14                DEC     A
0106 7003              JNZ     $ + 5H
0108 020000      R     LJMP    ?C0093
010B 14                DEC     A
010C 7003              JNZ     $ + 5H
010E 020000      R     LJMP    ?C0065
0111 2403              ADD     A,#03H
0113 6003              JZ      $ + 5H
0115 020000      R     LJMP    ?C0044
                                           ; SOURCE LINE # 507
0118         ?C0045:
                                           ; SOURCE LINE # 518
0118 E500        R     MOV     A,index
011A 25E0              ADD     A,ACC
011C 25E0              ADD     A,ACC
011E 2400        E     ADD     A,#LOW g_meas
0120 F582              MOV     DPL,A
0122 E4                CLR     A
0123 3400        E     ADDC    A,#HIGH g_meas
0125 F583              MOV     DPH,A
0127 E0                MOVX    A,@DPTR
0128 F8                MOV     R0,A
0129 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 32  

012A E0                MOVX    A,@DPTR
012B F9                MOV     R1,A
012C A3                INC     DPTR
012D E0                MOVX    A,@DPTR
012E FA                MOV     R2,A
012F A3                INC     DPTR
0130 E0                MOVX    A,@DPTR
0131 FB                MOV     R3,A
0132 E500        R     MOV     A,index
0134 25E0              ADD     A,ACC
0136 25E0              ADD     A,ACC
0138 2400        E     ADD     A,#LOW g_ref
013A F582              MOV     DPL,A
013C E4                CLR     A
013D 3400        E     ADDC    A,#HIGH g_ref
013F F583              MOV     DPH,A
0141 E0                MOVX    A,@DPTR
0142 FC                MOV     R4,A
0143 A3                INC     DPTR
0144 E0                MOVX    A,@DPTR
0145 FD                MOV     R5,A
0146 A3                INC     DPTR
0147 E0                MOVX    A,@DPTR
0148 FE                MOV     R6,A
0149 A3                INC     DPTR
014A E0                MOVX    A,@DPTR
014B C3                CLR     C
014C 9B                SUBB    A,R3
014D F500        R     MOV     pos_error+03H,A
014F EE                MOV     A,R6
0150 9A                SUBB    A,R2
0151 F500        R     MOV     pos_error+02H,A
0153 ED                MOV     A,R5
0154 99                SUBB    A,R1
0155 F500        R     MOV     pos_error+01H,A
0157 EC                MOV     A,R4
0158 98                SUBB    A,R0
0159 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 520
015B 300005            JNB     interrupt_flag,?C0046
                                           ; SOURCE LINE # 521
015E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 522
0160 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 523
0163         ?C0046:
                                           ; SOURCE LINE # 526
0163 E500        R     MOV     A,index
0165 25E0              ADD     A,ACC
0167 25E0              ADD     A,ACC
0169 2400        R     ADD     A,#LOW pos_error_sum
016B F582              MOV     DPL,A
016D E4                CLR     A
016E 3400        R     ADDC    A,#HIGH pos_error_sum
0170 F583              MOV     DPH,A
0172 C083              PUSH    DPH
0174 C082              PUSH    DPL
0176 E0                MOVX    A,@DPTR
0177 FC                MOV     R4,A
0178 A3                INC     DPTR
0179 E0                MOVX    A,@DPTR
017A FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 33  

017B A3                INC     DPTR
017C E0                MOVX    A,@DPTR
017D FE                MOV     R6,A
017E A3                INC     DPTR
017F E0                MOVX    A,@DPTR
0180 2500        R     ADD     A,pos_error+03H
0182 FF                MOV     R7,A
0183 EE                MOV     A,R6
0184 3500        R     ADDC    A,pos_error+02H
0186 FE                MOV     R6,A
0187 ED                MOV     A,R5
0188 3500        R     ADDC    A,pos_error+01H
018A FD                MOV     R5,A
018B EC                MOV     A,R4
018C 3500        R     ADDC    A,pos_error
018E FC                MOV     R4,A
018F D082              POP     DPL
0191 D083              POP     DPH
0193 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 529
0196 E500        R     MOV     A,index
0198 25E0              ADD     A,ACC
019A 25E0              ADD     A,ACC
019C 2400        R     ADD     A,#LOW pos_error_sum
019E F582              MOV     DPL,A
01A0 E4                CLR     A
01A1 3400        R     ADDC    A,#HIGH pos_error_sum
01A3 F583              MOV     DPH,A
01A5 E0                MOVX    A,@DPTR
01A6 FC                MOV     R4,A
01A7 A3                INC     DPTR
01A8 E0                MOVX    A,@DPTR
01A9 FD                MOV     R5,A
01AA A3                INC     DPTR
01AB E0                MOVX    A,@DPTR
01AC FE                MOV     R6,A
01AD A3                INC     DPTR
01AE E0                MOVX    A,@DPTR
01AF FF                MOV     R7,A
01B0 7BA0              MOV     R3,#0A0H
01B2 7A86              MOV     R2,#086H
01B4 7901              MOV     R1,#01H
01B6 7800              MOV     R0,#00H
01B8 C3                CLR     C
01B9 120000      E     LCALL   ?C?SLCMP
01BC 501C              JNC     ?C0047
                                           ; SOURCE LINE # 530
01BE 7FA0              MOV     R7,#0A0H
01C0 7E86              MOV     R6,#086H
01C2 7D01              MOV     R5,#01H
01C4 7C00              MOV     R4,#00H
01C6 E500        R     MOV     A,index
01C8 25E0              ADD     A,ACC
01CA 25E0              ADD     A,ACC
01CC 2400        R     ADD     A,#LOW pos_error_sum
01CE F582              MOV     DPL,A
01D0 E4                CLR     A
01D1 3400        R     ADDC    A,#HIGH pos_error_sum
01D3 F583              MOV     DPH,A
01D5 120000      E     LCALL   ?C?LSTXDATA
01D8 8042              SJMP    ?C0048
01DA         ?C0047:
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 34  

                                           ; SOURCE LINE # 531
                                           ; SOURCE LINE # 532
01DA E500        R     MOV     A,index
01DC 25E0              ADD     A,ACC
01DE 25E0              ADD     A,ACC
01E0 2400        R     ADD     A,#LOW pos_error_sum
01E2 F582              MOV     DPL,A
01E4 E4                CLR     A
01E5 3400        R     ADDC    A,#HIGH pos_error_sum
01E7 F583              MOV     DPH,A
01E9 E0                MOVX    A,@DPTR
01EA FC                MOV     R4,A
01EB A3                INC     DPTR
01EC E0                MOVX    A,@DPTR
01ED FD                MOV     R5,A
01EE A3                INC     DPTR
01EF E0                MOVX    A,@DPTR
01F0 FE                MOV     R6,A
01F1 A3                INC     DPTR
01F2 E0                MOVX    A,@DPTR
01F3 FF                MOV     R7,A
01F4 7B60              MOV     R3,#060H
01F6 7A79              MOV     R2,#079H
01F8 79FE              MOV     R1,#0FEH
01FA 78FF              MOV     R0,#0FFH
01FC D3                SETB    C
01FD 120000      E     LCALL   ?C?SLCMP
0200 401A              JC      ?C0048
                                           ; SOURCE LINE # 533
0202 7F60              MOV     R7,#060H
0204 7E79              MOV     R6,#079H
0206 7DFE              MOV     R5,#0FEH
0208 7CFF              MOV     R4,#0FFH
020A E500        R     MOV     A,index
020C 25E0              ADD     A,ACC
020E 25E0              ADD     A,ACC
0210 2400        R     ADD     A,#LOW pos_error_sum
0212 F582              MOV     DPL,A
0214 E4                CLR     A
0215 3400        R     ADDC    A,#HIGH pos_error_sum
0217 F583              MOV     DPH,A
0219 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 534
021C         ?C0048:
                                           ; SOURCE LINE # 536
021C 300005            JNB     interrupt_flag,?C0050
                                           ; SOURCE LINE # 537
021F C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 538
0221 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 539
0224         ?C0050:
                                           ; SOURCE LINE # 541
0224 E4                CLR     A
0225 F500        R     MOV     pwm_input+03H,A
0227 F500        R     MOV     pwm_input+02H,A
0229 F500        R     MOV     pwm_input+01H,A
022B F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 543
022D FF                MOV     R7,A
022E FE                MOV     R6,A
022F FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 35  

0230 FC                MOV     R4,A
0231 AB00        R     MOV     R3,k_p+03H
0233 AA00        R     MOV     R2,k_p+02H
0235 A900        R     MOV     R1,k_p+01H
0237 A800        R     MOV     R0,k_p
0239 C3                CLR     C
023A 120000      E     LCALL   ?C?SLCMP
023D 606A              JZ      ?C0051
                                           ; SOURCE LINE # 545
023F E4                CLR     A
0240 FF                MOV     R7,A
0241 FE                MOV     R6,A
0242 7D02              MOV     R5,#02H
0244 FC                MOV     R4,A
0245 AB00        R     MOV     R3,pos_error+03H
0247 AA00        R     MOV     R2,pos_error+02H
0249 A900        R     MOV     R1,pos_error+01H
024B A800        R     MOV     R0,pos_error
024D D3                SETB    C
024E 120000      E     LCALL   ?C?SLCMP
0251 500F              JNC     ?C0053
0253 E4                CLR     A
0254 FF                MOV     R7,A
0255 FE                MOV     R6,A
0256 7DFE              MOV     R5,#0FEH
0258 7CFF              MOV     R4,#0FFH
025A A800        R     MOV     R0,pos_error
025C C3                CLR     C
025D 120000      E     LCALL   ?C?SLCMP
0260 5027              JNC     ?C0052
0262         ?C0053:
                                           ; SOURCE LINE # 546
0262 AF00        R     MOV     R7,pos_error+03H
0264 AE00        R     MOV     R6,pos_error+02H
0266 AD00        R     MOV     R5,pos_error+01H
0268 AC00        R     MOV     R4,pos_error
026A 7808              MOV     R0,#08H
026C 120000      E     LCALL   ?C?SLSHR
026F AB00        R     MOV     R3,k_p+03H
0271 AA00        R     MOV     R2,k_p+02H
0273 A900        R     MOV     R1,k_p+01H
0275 A800        R     MOV     R0,k_p
0277 120000      E     LCALL   ?C?LMUL
027A 7808              MOV     R0,#08H
027C 120000      E     LCALL   ?C?SLSHR
027F 8F00        R     MOV     pwm_input+03H,R7
0281 8E00        R     MOV     pwm_input+02H,R6
0283 8D00        R     MOV     pwm_input+01H,R5
0285 8C00        R     MOV     pwm_input,R4
0287 8020              SJMP    ?C0051
0289         ?C0052:
                                           ; SOURCE LINE # 548
0289 AF00        R     MOV     R7,pos_error+03H
028B AE00        R     MOV     R6,pos_error+02H
028D AD00        R     MOV     R5,pos_error+01H
028F AC00        R     MOV     R4,pos_error
0291 AB00        R     MOV     R3,k_p+03H
0293 AA00        R     MOV     R2,k_p+02H
0295 A900        R     MOV     R1,k_p+01H
0297 A800        R     MOV     R0,k_p
0299 120000      E     LCALL   ?C?LMUL
029C 7810              MOV     R0,#010H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 36  

029E 120000      E     LCALL   ?C?SLSHR
02A1 8F00        R     MOV     pwm_input+03H,R7
02A3 8E00        R     MOV     pwm_input+02H,R6
02A5 8D00        R     MOV     pwm_input+01H,R5
02A7 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 549
02A9         ?C0051:
                                           ; SOURCE LINE # 551
02A9 300005            JNB     interrupt_flag,?C0055
                                           ; SOURCE LINE # 552
02AC C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 553
02AE 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 554
02B1         ?C0055:
                                           ; SOURCE LINE # 557
02B1 E4                CLR     A
02B2 FF                MOV     R7,A
02B3 FE                MOV     R6,A
02B4 FD                MOV     R5,A
02B5 FC                MOV     R4,A
02B6 AB00        R     MOV     R3,k_i+03H
02B8 AA00        R     MOV     R2,k_i+02H
02BA A900        R     MOV     R1,k_i+01H
02BC A800        R     MOV     R0,k_i
02BE C3                CLR     C
02BF 120000      E     LCALL   ?C?SLCMP
02C2 6043              JZ      ?C0056
                                           ; SOURCE LINE # 558
02C4 AF00        R     MOV     R7,k_i+03H
02C6 AE00        R     MOV     R6,k_i+02H
02C8 AD00        R     MOV     R5,k_i+01H
02CA AC00        R     MOV     R4,k_i
02CC 7806              MOV     R0,#06H
02CE 120000      E     LCALL   ?C?SLSHR
02D1 E500        R     MOV     A,index
02D3 25E0              ADD     A,ACC
02D5 25E0              ADD     A,ACC
02D7 2400        R     ADD     A,#LOW pos_error_sum
02D9 F582              MOV     DPL,A
02DB E4                CLR     A
02DC 3400        R     ADDC    A,#HIGH pos_error_sum
02DE F583              MOV     DPH,A
02E0 E0                MOVX    A,@DPTR
02E1 F8                MOV     R0,A
02E2 A3                INC     DPTR
02E3 E0                MOVX    A,@DPTR
02E4 F9                MOV     R1,A
02E5 A3                INC     DPTR
02E6 E0                MOVX    A,@DPTR
02E7 FA                MOV     R2,A
02E8 A3                INC     DPTR
02E9 E0                MOVX    A,@DPTR
02EA FB                MOV     R3,A
02EB 120000      E     LCALL   ?C?LMUL
02EE 780A              MOV     R0,#0AH
02F0 120000      E     LCALL   ?C?SLSHR
02F3 E500        R     MOV     A,pwm_input+03H
02F5 2F                ADD     A,R7
02F6 F500        R     MOV     pwm_input+03H,A
02F8 E500        R     MOV     A,pwm_input+02H
02FA 3E                ADDC    A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 37  

02FB F500        R     MOV     pwm_input+02H,A
02FD E500        R     MOV     A,pwm_input+01H
02FF 3D                ADDC    A,R5
0300 F500        R     MOV     pwm_input+01H,A
0302 E500        R     MOV     A,pwm_input
0304 3C                ADDC    A,R4
0305 F500        R     MOV     pwm_input,A
0307         ?C0056:
                                           ; SOURCE LINE # 561
0307 E4                CLR     A
0308 FF                MOV     R7,A
0309 FE                MOV     R6,A
030A FD                MOV     R5,A
030B FC                MOV     R4,A
030C AB00        R     MOV     R3,k_d+03H
030E AA00        R     MOV     R2,k_d+02H
0310 A900        R     MOV     R1,k_d+01H
0312 A800        R     MOV     R0,k_d
0314 C3                CLR     C
0315 120000      E     LCALL   ?C?SLCMP
0318 6063              JZ      ?C0057
                                           ; SOURCE LINE # 562
031A E500        R     MOV     A,index
031C 25E0              ADD     A,ACC
031E 25E0              ADD     A,ACC
0320 2400        E     ADD     A,#LOW g_meas
0322 F582              MOV     DPL,A
0324 E4                CLR     A
0325 3400        E     ADDC    A,#HIGH g_meas
0327 F583              MOV     DPH,A
0329 E0                MOVX    A,@DPTR
032A F8                MOV     R0,A
032B A3                INC     DPTR
032C E0                MOVX    A,@DPTR
032D F9                MOV     R1,A
032E A3                INC     DPTR
032F E0                MOVX    A,@DPTR
0330 FA                MOV     R2,A
0331 A3                INC     DPTR
0332 E0                MOVX    A,@DPTR
0333 FB                MOV     R3,A
0334 E500        R     MOV     A,index
0336 25E0              ADD     A,ACC
0338 25E0              ADD     A,ACC
033A 2400        E     ADD     A,#LOW g_measOld
033C F582              MOV     DPL,A
033E E4                CLR     A
033F 3400        E     ADDC    A,#HIGH g_measOld
0341 F583              MOV     DPH,A
0343 E0                MOVX    A,@DPTR
0344 FC                MOV     R4,A
0345 A3                INC     DPTR
0346 E0                MOVX    A,@DPTR
0347 FD                MOV     R5,A
0348 A3                INC     DPTR
0349 E0                MOVX    A,@DPTR
034A FE                MOV     R6,A
034B A3                INC     DPTR
034C E0                MOVX    A,@DPTR
034D C3                CLR     C
034E 9B                SUBB    A,R3
034F FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 38  

0350 EE                MOV     A,R6
0351 9A                SUBB    A,R2
0352 FE                MOV     R6,A
0353 ED                MOV     A,R5
0354 99                SUBB    A,R1
0355 FD                MOV     R5,A
0356 EC                MOV     A,R4
0357 98                SUBB    A,R0
0358 FC                MOV     R4,A
0359 AB00        R     MOV     R3,k_d+03H
035B AA00        R     MOV     R2,k_d+02H
035D A900        R     MOV     R1,k_d+01H
035F A800        R     MOV     R0,k_d
0361 120000      E     LCALL   ?C?LMUL
0364 7810              MOV     R0,#010H
0366 120000      E     LCALL   ?C?SLSHR
0369 E500        R     MOV     A,pwm_input+03H
036B 2F                ADD     A,R7
036C F500        R     MOV     pwm_input+03H,A
036E E500        R     MOV     A,pwm_input+02H
0370 3E                ADDC    A,R6
0371 F500        R     MOV     pwm_input+02H,A
0373 E500        R     MOV     A,pwm_input+01H
0375 3D                ADDC    A,R5
0376 F500        R     MOV     pwm_input+01H,A
0378 E500        R     MOV     A,pwm_input
037A 3C                ADDC    A,R4
037B F500        R     MOV     pwm_input,A
037D         ?C0057:
                                           ; SOURCE LINE # 565
037D 300005            JNB     interrupt_flag,?C0058
                                           ; SOURCE LINE # 566
0380 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 567
0382 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 568
0385         ?C0058:
                                           ; SOURCE LINE # 573
0385 E500        R     MOV     A,index
0387 701C              JNZ     ?C0059
                                           ; SOURCE LINE # 574
0389 FF                MOV     R7,A
038A FE                MOV     R6,A
038B FD                MOV     R5,A
038C FC                MOV     R4,A
038D AB00        R     MOV     R3,pwm_input+03H
038F AA00        R     MOV     R2,pwm_input+02H
0391 A900        R     MOV     R1,pwm_input+01H
0393 A800        R     MOV     R0,pwm_input
0395 C3                CLR     C
0396 120000      E     LCALL   ?C?SLCMP
0399 4005              JC      ?C0060
                                           ; SOURCE LINE # 575
039B D200        R     SETB    dirM0
039D 020000      R     LJMP    ?C0044
03A0         ?C0060:
                                           ; SOURCE LINE # 578
03A0 C200        R     CLR     dirM0
                                           ; SOURCE LINE # 580
03A2 020000      R     LJMP    ?C0044
03A5         ?C0059:
                                           ; SOURCE LINE # 581
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 39  

03A5 E4                CLR     A
03A6 FF                MOV     R7,A
03A7 FE                MOV     R6,A
03A8 FD                MOV     R5,A
03A9 FC                MOV     R4,A
03AA AB00        R     MOV     R3,pwm_input+03H
03AC AA00        R     MOV     R2,pwm_input+02H
03AE A900        R     MOV     R1,pwm_input+01H
03B0 A800        R     MOV     R0,pwm_input
03B2 C3                CLR     C
03B3 120000      E     LCALL   ?C?SLCMP
03B6 4005              JC      ?C0063
                                           ; SOURCE LINE # 582
03B8 D200        R     SETB    dirM1
03BA 020000      R     LJMP    ?C0044
03BD         ?C0063:
                                           ; SOURCE LINE # 585
03BD C200        R     CLR     dirM1
                                           ; SOURCE LINE # 587
                                           ; SOURCE LINE # 589
03BF 020000      R     LJMP    ?C0044
                                           ; SOURCE LINE # 591
03C2         ?C0065:
                                           ; SOURCE LINE # 601
03C2 E500        R     MOV     A,index
03C4 25E0              ADD     A,ACC
03C6 25E0              ADD     A,ACC
03C8 2400        E     ADD     A,#LOW g_meas
03CA F582              MOV     DPL,A
03CC E4                CLR     A
03CD 3400        E     ADDC    A,#HIGH g_meas
03CF F583              MOV     DPH,A
03D1 E0                MOVX    A,@DPTR
03D2 F8                MOV     R0,A
03D3 A3                INC     DPTR
03D4 E0                MOVX    A,@DPTR
03D5 F9                MOV     R1,A
03D6 A3                INC     DPTR
03D7 E0                MOVX    A,@DPTR
03D8 FA                MOV     R2,A
03D9 A3                INC     DPTR
03DA E0                MOVX    A,@DPTR
03DB FB                MOV     R3,A
03DC E500        R     MOV     A,index
03DE 25E0              ADD     A,ACC
03E0 25E0              ADD     A,ACC
03E2 2400        E     ADD     A,#LOW g_ref
03E4 F582              MOV     DPL,A
03E6 E4                CLR     A
03E7 3400        E     ADDC    A,#HIGH g_ref
03E9 F583              MOV     DPH,A
03EB E0                MOVX    A,@DPTR
03EC FC                MOV     R4,A
03ED A3                INC     DPTR
03EE E0                MOVX    A,@DPTR
03EF FD                MOV     R5,A
03F0 A3                INC     DPTR
03F1 E0                MOVX    A,@DPTR
03F2 FE                MOV     R6,A
03F3 A3                INC     DPTR
03F4 E0                MOVX    A,@DPTR
03F5 C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 40  

03F6 9B                SUBB    A,R3
03F7 F500        R     MOV     pos_error+03H,A
03F9 EE                MOV     A,R6
03FA 9A                SUBB    A,R2
03FB F500        R     MOV     pos_error+02H,A
03FD ED                MOV     A,R5
03FE 99                SUBB    A,R1
03FF F500        R     MOV     pos_error+01H,A
0401 EC                MOV     A,R4
0402 98                SUBB    A,R0
0403 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 603
0405 E500        R     MOV     A,index
0407 25E0              ADD     A,ACC
0409 25E0              ADD     A,ACC
040B 2400        R     ADD     A,#LOW pos_error_sum
040D F582              MOV     DPL,A
040F E4                CLR     A
0410 3400        R     ADDC    A,#HIGH pos_error_sum
0412 F583              MOV     DPH,A
0414 C083              PUSH    DPH
0416 C082              PUSH    DPL
0418 E0                MOVX    A,@DPTR
0419 FC                MOV     R4,A
041A A3                INC     DPTR
041B E0                MOVX    A,@DPTR
041C FD                MOV     R5,A
041D A3                INC     DPTR
041E E0                MOVX    A,@DPTR
041F FE                MOV     R6,A
0420 A3                INC     DPTR
0421 E0                MOVX    A,@DPTR
0422 2500        R     ADD     A,pos_error+03H
0424 FF                MOV     R7,A
0425 EE                MOV     A,R6
0426 3500        R     ADDC    A,pos_error+02H
0428 FE                MOV     R6,A
0429 ED                MOV     A,R5
042A 3500        R     ADDC    A,pos_error+01H
042C FD                MOV     R5,A
042D EC                MOV     A,R4
042E 3500        R     ADDC    A,pos_error
0430 FC                MOV     R4,A
0431 D082              POP     DPL
0433 D083              POP     DPH
0435 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 605
0438 300005            JNB     interrupt_flag,?C0066
                                           ; SOURCE LINE # 606
043B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 607
043D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 608
0440         ?C0066:
                                           ; SOURCE LINE # 611
0440 E500        R     MOV     A,index
0442 25E0              ADD     A,ACC
0444 25E0              ADD     A,ACC
0446 2400        R     ADD     A,#LOW pos_error_sum
0448 F582              MOV     DPL,A
044A E4                CLR     A
044B 3400        R     ADDC    A,#HIGH pos_error_sum
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 41  

044D F583              MOV     DPH,A
044F E0                MOVX    A,@DPTR
0450 FC                MOV     R4,A
0451 A3                INC     DPTR
0452 E0                MOVX    A,@DPTR
0453 FD                MOV     R5,A
0454 A3                INC     DPTR
0455 E0                MOVX    A,@DPTR
0456 FE                MOV     R6,A
0457 A3                INC     DPTR
0458 E0                MOVX    A,@DPTR
0459 FF                MOV     R7,A
045A 7BA0              MOV     R3,#0A0H
045C 7A86              MOV     R2,#086H
045E 7901              MOV     R1,#01H
0460 7800              MOV     R0,#00H
0462 C3                CLR     C
0463 120000      E     LCALL   ?C?SLCMP
0466 501C              JNC     ?C0067
                                           ; SOURCE LINE # 612
0468 7FA0              MOV     R7,#0A0H
046A 7E86              MOV     R6,#086H
046C 7D01              MOV     R5,#01H
046E 7C00              MOV     R4,#00H
0470 E500        R     MOV     A,index
0472 25E0              ADD     A,ACC
0474 25E0              ADD     A,ACC
0476 2400        R     ADD     A,#LOW pos_error_sum
0478 F582              MOV     DPL,A
047A E4                CLR     A
047B 3400        R     ADDC    A,#HIGH pos_error_sum
047D F583              MOV     DPH,A
047F 120000      E     LCALL   ?C?LSTXDATA
0482 8042              SJMP    ?C0068
0484         ?C0067:
                                           ; SOURCE LINE # 613
                                           ; SOURCE LINE # 614
0484 E500        R     MOV     A,index
0486 25E0              ADD     A,ACC
0488 25E0              ADD     A,ACC
048A 2400        R     ADD     A,#LOW pos_error_sum
048C F582              MOV     DPL,A
048E E4                CLR     A
048F 3400        R     ADDC    A,#HIGH pos_error_sum
0491 F583              MOV     DPH,A
0493 E0                MOVX    A,@DPTR
0494 FC                MOV     R4,A
0495 A3                INC     DPTR
0496 E0                MOVX    A,@DPTR
0497 FD                MOV     R5,A
0498 A3                INC     DPTR
0499 E0                MOVX    A,@DPTR
049A FE                MOV     R6,A
049B A3                INC     DPTR
049C E0                MOVX    A,@DPTR
049D FF                MOV     R7,A
049E 7B60              MOV     R3,#060H
04A0 7A79              MOV     R2,#079H
04A2 79FE              MOV     R1,#0FEH
04A4 78FF              MOV     R0,#0FFH
04A6 D3                SETB    C
04A7 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 42  

04AA 401A              JC      ?C0068
                                           ; SOURCE LINE # 615
04AC 7F60              MOV     R7,#060H
04AE 7E79              MOV     R6,#079H
04B0 7DFE              MOV     R5,#0FEH
04B2 7CFF              MOV     R4,#0FFH
04B4 E500        R     MOV     A,index
04B6 25E0              ADD     A,ACC
04B8 25E0              ADD     A,ACC
04BA 2400        R     ADD     A,#LOW pos_error_sum
04BC F582              MOV     DPL,A
04BE E4                CLR     A
04BF 3400        R     ADDC    A,#HIGH pos_error_sum
04C1 F583              MOV     DPH,A
04C3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 616
04C6         ?C0068:
                                           ; SOURCE LINE # 619
04C6 E4                CLR     A
04C7 F500        R     MOV     curr_ref+03H,A
04C9 F500        R     MOV     curr_ref+02H,A
04CB F500        R     MOV     curr_ref+01H,A
04CD F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 621
04CF 300005            JNB     interrupt_flag,?C0070
                                           ; SOURCE LINE # 622
04D2 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 623
04D4 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 624
04D7         ?C0070:
                                           ; SOURCE LINE # 627
04D7 E4                CLR     A
04D8 FF                MOV     R7,A
04D9 FE                MOV     R6,A
04DA FD                MOV     R5,A
04DB FC                MOV     R4,A
04DC AB00        R     MOV     R3,k_p_dl+03H
04DE AA00        R     MOV     R2,k_p_dl+02H
04E0 A900        R     MOV     R1,k_p_dl+01H
04E2 A800        R     MOV     R0,k_p_dl
04E4 C3                CLR     C
04E5 120000      E     LCALL   ?C?SLCMP
04E8 6026              JZ      ?C0071
                                           ; SOURCE LINE # 628
04EA AF00        R     MOV     R7,pos_error+03H
04EC AE00        R     MOV     R6,pos_error+02H
04EE AD00        R     MOV     R5,pos_error+01H
04F0 AC00        R     MOV     R4,pos_error
04F2 A800        R     MOV     R0,k_p_dl
04F4 120000      E     LCALL   ?C?LMUL
04F7 7810              MOV     R0,#010H
04F9 120000      E     LCALL   ?C?SLSHR
04FC E500        R     MOV     A,curr_ref+03H
04FE 2F                ADD     A,R7
04FF F500        R     MOV     curr_ref+03H,A
0501 E500        R     MOV     A,curr_ref+02H
0503 3E                ADDC    A,R6
0504 F500        R     MOV     curr_ref+02H,A
0506 E500        R     MOV     A,curr_ref+01H
0508 3D                ADDC    A,R5
0509 F500        R     MOV     curr_ref+01H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 43  

050B E500        R     MOV     A,curr_ref
050D 3C                ADDC    A,R4
050E F500        R     MOV     curr_ref,A
0510         ?C0071:
                                           ; SOURCE LINE # 631
0510 E4                CLR     A
0511 FF                MOV     R7,A
0512 FE                MOV     R6,A
0513 FD                MOV     R5,A
0514 FC                MOV     R4,A
0515 AB00        R     MOV     R3,k_i_dl+03H
0517 AA00        R     MOV     R2,k_i_dl+02H
0519 A900        R     MOV     R1,k_i_dl+01H
051B A800        R     MOV     R0,k_i_dl
051D C3                CLR     C
051E 120000      E     LCALL   ?C?SLCMP
0521 6038              JZ      ?C0072
                                           ; SOURCE LINE # 632
0523 E500        R     MOV     A,index
0525 25E0              ADD     A,ACC
0527 25E0              ADD     A,ACC
0529 2400        R     ADD     A,#LOW pos_error_sum
052B F582              MOV     DPL,A
052D E4                CLR     A
052E 3400        R     ADDC    A,#HIGH pos_error_sum
0530 F583              MOV     DPH,A
0532 E0                MOVX    A,@DPTR
0533 FC                MOV     R4,A
0534 A3                INC     DPTR
0535 E0                MOVX    A,@DPTR
0536 FD                MOV     R5,A
0537 A3                INC     DPTR
0538 E0                MOVX    A,@DPTR
0539 FE                MOV     R6,A
053A A3                INC     DPTR
053B E0                MOVX    A,@DPTR
053C FF                MOV     R7,A
053D A800        R     MOV     R0,k_i_dl
053F 120000      E     LCALL   ?C?LMUL
0542 7810              MOV     R0,#010H
0544 120000      E     LCALL   ?C?SLSHR
0547 E500        R     MOV     A,curr_ref+03H
0549 2F                ADD     A,R7
054A F500        R     MOV     curr_ref+03H,A
054C E500        R     MOV     A,curr_ref+02H
054E 3E                ADDC    A,R6
054F F500        R     MOV     curr_ref+02H,A
0551 E500        R     MOV     A,curr_ref+01H
0553 3D                ADDC    A,R5
0554 F500        R     MOV     curr_ref+01H,A
0556 E500        R     MOV     A,curr_ref
0558 3C                ADDC    A,R4
0559 F500        R     MOV     curr_ref,A
055B         ?C0072:
                                           ; SOURCE LINE # 635
055B E4                CLR     A
055C FF                MOV     R7,A
055D FE                MOV     R6,A
055E FD                MOV     R5,A
055F FC                MOV     R4,A
0560 AB00        R     MOV     R3,k_d_dl+03H
0562 AA00        R     MOV     R2,k_d_dl+02H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 44  

0564 A900        R     MOV     R1,k_d_dl+01H
0566 A800        R     MOV     R0,k_d_dl
0568 C3                CLR     C
0569 120000      E     LCALL   ?C?SLCMP
056C 6063              JZ      ?C0073
                                           ; SOURCE LINE # 636
056E E500        R     MOV     A,index
0570 25E0              ADD     A,ACC
0572 25E0              ADD     A,ACC
0574 2400        E     ADD     A,#LOW g_meas
0576 F582              MOV     DPL,A
0578 E4                CLR     A
0579 3400        E     ADDC    A,#HIGH g_meas
057B F583              MOV     DPH,A
057D E0                MOVX    A,@DPTR
057E F8                MOV     R0,A
057F A3                INC     DPTR
0580 E0                MOVX    A,@DPTR
0581 F9                MOV     R1,A
0582 A3                INC     DPTR
0583 E0                MOVX    A,@DPTR
0584 FA                MOV     R2,A
0585 A3                INC     DPTR
0586 E0                MOVX    A,@DPTR
0587 FB                MOV     R3,A
0588 E500        R     MOV     A,index
058A 25E0              ADD     A,ACC
058C 25E0              ADD     A,ACC
058E 2400        E     ADD     A,#LOW g_measOld
0590 F582              MOV     DPL,A
0592 E4                CLR     A
0593 3400        E     ADDC    A,#HIGH g_measOld
0595 F583              MOV     DPH,A
0597 E0                MOVX    A,@DPTR
0598 FC                MOV     R4,A
0599 A3                INC     DPTR
059A E0                MOVX    A,@DPTR
059B FD                MOV     R5,A
059C A3                INC     DPTR
059D E0                MOVX    A,@DPTR
059E FE                MOV     R6,A
059F A3                INC     DPTR
05A0 E0                MOVX    A,@DPTR
05A1 C3                CLR     C
05A2 9B                SUBB    A,R3
05A3 FF                MOV     R7,A
05A4 EE                MOV     A,R6
05A5 9A                SUBB    A,R2
05A6 FE                MOV     R6,A
05A7 ED                MOV     A,R5
05A8 99                SUBB    A,R1
05A9 FD                MOV     R5,A
05AA EC                MOV     A,R4
05AB 98                SUBB    A,R0
05AC FC                MOV     R4,A
05AD AB00        R     MOV     R3,k_d_dl+03H
05AF AA00        R     MOV     R2,k_d_dl+02H
05B1 A900        R     MOV     R1,k_d_dl+01H
05B3 A800        R     MOV     R0,k_d_dl
05B5 120000      E     LCALL   ?C?LMUL
05B8 7810              MOV     R0,#010H
05BA 120000      E     LCALL   ?C?SLSHR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 45  

05BD E500        R     MOV     A,curr_ref+03H
05BF 2F                ADD     A,R7
05C0 F500        R     MOV     curr_ref+03H,A
05C2 E500        R     MOV     A,curr_ref+02H
05C4 3E                ADDC    A,R6
05C5 F500        R     MOV     curr_ref+02H,A
05C7 E500        R     MOV     A,curr_ref+01H
05C9 3D                ADDC    A,R5
05CA F500        R     MOV     curr_ref+01H,A
05CC E500        R     MOV     A,curr_ref
05CE 3C                ADDC    A,R4
05CF F500        R     MOV     curr_ref,A
05D1         ?C0073:
                                           ; SOURCE LINE # 638
05D1 300005            JNB     interrupt_flag,?C0074
                                           ; SOURCE LINE # 639
05D4 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 640
05D6 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 641
05D9         ?C0074:
                                           ; SOURCE LINE # 644
05D9 900000      E     MOV     DPTR,#c_mem+032H
05DC E0                MOVX    A,@DPTR
05DD FE                MOV     R6,A
05DE A3                INC     DPTR
05DF E0                MOVX    A,@DPTR
05E0 FF                MOV     R7,A
05E1 EE                MOV     A,R6
05E2 33                RLC     A
05E3 95E0              SUBB    A,ACC
05E5 FD                MOV     R5,A
05E6 FC                MOV     R4,A
05E7 AB00        R     MOV     R3,curr_ref+03H
05E9 AA00        R     MOV     R2,curr_ref+02H
05EB A900        R     MOV     R1,curr_ref+01H
05ED A800        R     MOV     R0,curr_ref
05EF D3                SETB    C
05F0 120000      E     LCALL   ?C?SLCMP
05F3 4016              JC      ?C0075
                                           ; SOURCE LINE # 645
05F5 900000      E     MOV     DPTR,#c_mem+032H
05F8 E0                MOVX    A,@DPTR
05F9 FE                MOV     R6,A
05FA A3                INC     DPTR
05FB E0                MOVX    A,@DPTR
05FC FF                MOV     R7,A
05FD EE                MOV     A,R6
05FE 33                RLC     A
05FF 95E0              SUBB    A,ACC
0601 8F00        R     MOV     curr_ref+03H,R7
0603 8E00        R     MOV     curr_ref+02H,R6
0605 F500        R     MOV     curr_ref+01H,A
0607 F500        R     MOV     curr_ref,A
0609 803C              SJMP    ?C0076
060B         ?C0075:
                                           ; SOURCE LINE # 646
                                           ; SOURCE LINE # 647
060B 900000      E     MOV     DPTR,#c_mem+032H
060E E0                MOVX    A,@DPTR
060F FE                MOV     R6,A
0610 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 46  

0611 E0                MOVX    A,@DPTR
0612 FF                MOV     R7,A
0613 C3                CLR     C
0614 E4                CLR     A
0615 9F                SUBB    A,R7
0616 FF                MOV     R7,A
0617 E4                CLR     A
0618 9E                SUBB    A,R6
0619 FE                MOV     R6,A
061A 33                RLC     A
061B 95E0              SUBB    A,ACC
061D FD                MOV     R5,A
061E FC                MOV     R4,A
061F AB00        R     MOV     R3,curr_ref+03H
0621 AA00        R     MOV     R2,curr_ref+02H
0623 A900        R     MOV     R1,curr_ref+01H
0625 A800        R     MOV     R0,curr_ref
0627 C3                CLR     C
0628 120000      E     LCALL   ?C?SLCMP
062B 501A              JNC     ?C0076
                                           ; SOURCE LINE # 648
062D 900000      E     MOV     DPTR,#c_mem+032H
0630 E0                MOVX    A,@DPTR
0631 FE                MOV     R6,A
0632 A3                INC     DPTR
0633 E0                MOVX    A,@DPTR
0634 FF                MOV     R7,A
0635 C3                CLR     C
0636 E4                CLR     A
0637 9F                SUBB    A,R7
0638 FF                MOV     R7,A
0639 E4                CLR     A
063A 9E                SUBB    A,R6
063B FE                MOV     R6,A
063C 33                RLC     A
063D 95E0              SUBB    A,ACC
063F 8F00        R     MOV     curr_ref+03H,R7
0641 8E00        R     MOV     curr_ref+02H,R6
0643 F500        R     MOV     curr_ref+01H,A
0645 F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 649
0647         ?C0076:
                                           ; SOURCE LINE # 651
0647 300005            JNB     interrupt_flag,?C0078
                                           ; SOURCE LINE # 652
064A C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 653
064C 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 654
064F         ?C0078:
                                           ; SOURCE LINE # 657
064F E500        R     MOV     A,index
0651 25E0              ADD     A,ACC
0653 2400        E     ADD     A,#LOW g_meas+0CH
0655 F582              MOV     DPL,A
0657 E4                CLR     A
0658 3400        E     ADDC    A,#HIGH g_meas+0CH
065A F583              MOV     DPH,A
065C E0                MOVX    A,@DPTR
065D FE                MOV     R6,A
065E A3                INC     DPTR
065F E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 47  

0660 FF                MOV     R7,A
0661 FB                MOV     R3,A
0662 AA06              MOV     R2,AR6
0664 EA                MOV     A,R2
0665 33                RLC     A
0666 95E0              SUBB    A,ACC
0668 F9                MOV     R1,A
0669 F8                MOV     R0,A
066A C3                CLR     C
066B E500        R     MOV     A,curr_ref+03H
066D 9B                SUBB    A,R3
066E F500        R     MOV     curr_error+03H,A
0670 E500        R     MOV     A,curr_ref+02H
0672 9A                SUBB    A,R2
0673 F500        R     MOV     curr_error+02H,A
0675 E500        R     MOV     A,curr_ref+01H
0677 99                SUBB    A,R1
0678 F500        R     MOV     curr_error+01H,A
067A E500        R     MOV     A,curr_ref
067C 98                SUBB    A,R0
067D F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 659
067F E500        R     MOV     A,index
0681 25E0              ADD     A,ACC
0683 25E0              ADD     A,ACC
0685 2400        R     ADD     A,#LOW curr_error_sum
0687 F582              MOV     DPL,A
0689 E4                CLR     A
068A 3400        R     ADDC    A,#HIGH curr_error_sum
068C F583              MOV     DPH,A
068E C083              PUSH    DPH
0690 C082              PUSH    DPL
0692 E0                MOVX    A,@DPTR
0693 FC                MOV     R4,A
0694 A3                INC     DPTR
0695 E0                MOVX    A,@DPTR
0696 FD                MOV     R5,A
0697 A3                INC     DPTR
0698 E0                MOVX    A,@DPTR
0699 FE                MOV     R6,A
069A A3                INC     DPTR
069B E0                MOVX    A,@DPTR
069C 2500        R     ADD     A,curr_error+03H
069E FF                MOV     R7,A
069F EE                MOV     A,R6
06A0 3500        R     ADDC    A,curr_error+02H
06A2 FE                MOV     R6,A
06A3 ED                MOV     A,R5
06A4 3500        R     ADDC    A,curr_error+01H
06A6 FD                MOV     R5,A
06A7 EC                MOV     A,R4
06A8 3500        R     ADDC    A,curr_error
06AA FC                MOV     R4,A
06AB D082              POP     DPL
06AD D083              POP     DPH
06AF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 661
06B2 E500        R     MOV     A,index
06B4 25E0              ADD     A,ACC
06B6 25E0              ADD     A,ACC
06B8 2400        R     ADD     A,#LOW curr_error_sum
06BA F582              MOV     DPL,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 48  

06BC E4                CLR     A
06BD 3400        R     ADDC    A,#HIGH curr_error_sum
06BF F583              MOV     DPH,A
06C1 E0                MOVX    A,@DPTR
06C2 FC                MOV     R4,A
06C3 A3                INC     DPTR
06C4 E0                MOVX    A,@DPTR
06C5 FD                MOV     R5,A
06C6 A3                INC     DPTR
06C7 E0                MOVX    A,@DPTR
06C8 FE                MOV     R6,A
06C9 A3                INC     DPTR
06CA E0                MOVX    A,@DPTR
06CB FF                MOV     R7,A
06CC 7BA0              MOV     R3,#0A0H
06CE 7A86              MOV     R2,#086H
06D0 7901              MOV     R1,#01H
06D2 7800              MOV     R0,#00H
06D4 C3                CLR     C
06D5 120000      E     LCALL   ?C?SLCMP
06D8 501C              JNC     ?C0079
                                           ; SOURCE LINE # 662
06DA 7FA0              MOV     R7,#0A0H
06DC 7E86              MOV     R6,#086H
06DE 7D01              MOV     R5,#01H
06E0 7C00              MOV     R4,#00H
06E2 E500        R     MOV     A,index
06E4 25E0              ADD     A,ACC
06E6 25E0              ADD     A,ACC
06E8 2400        R     ADD     A,#LOW curr_error_sum
06EA F582              MOV     DPL,A
06EC E4                CLR     A
06ED 3400        R     ADDC    A,#HIGH curr_error_sum
06EF F583              MOV     DPH,A
06F1 120000      E     LCALL   ?C?LSTXDATA
06F4 8042              SJMP    ?C0080
06F6         ?C0079:
                                           ; SOURCE LINE # 663
                                           ; SOURCE LINE # 664
06F6 E500        R     MOV     A,index
06F8 25E0              ADD     A,ACC
06FA 25E0              ADD     A,ACC
06FC 2400        R     ADD     A,#LOW curr_error_sum
06FE F582              MOV     DPL,A
0700 E4                CLR     A
0701 3400        R     ADDC    A,#HIGH curr_error_sum
0703 F583              MOV     DPH,A
0705 E0                MOVX    A,@DPTR
0706 FC                MOV     R4,A
0707 A3                INC     DPTR
0708 E0                MOVX    A,@DPTR
0709 FD                MOV     R5,A
070A A3                INC     DPTR
070B E0                MOVX    A,@DPTR
070C FE                MOV     R6,A
070D A3                INC     DPTR
070E E0                MOVX    A,@DPTR
070F FF                MOV     R7,A
0710 7B60              MOV     R3,#060H
0712 7A79              MOV     R2,#079H
0714 79FE              MOV     R1,#0FEH
0716 78FF              MOV     R0,#0FFH
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 49  

0718 D3                SETB    C
0719 120000      E     LCALL   ?C?SLCMP
071C 401A              JC      ?C0080
                                           ; SOURCE LINE # 665
071E 7F60              MOV     R7,#060H
0720 7E79              MOV     R6,#079H
0722 7DFE              MOV     R5,#0FEH
0724 7CFF              MOV     R4,#0FFH
0726 E500        R     MOV     A,index
0728 25E0              ADD     A,ACC
072A 25E0              ADD     A,ACC
072C 2400        R     ADD     A,#LOW curr_error_sum
072E F582              MOV     DPL,A
0730 E4                CLR     A
0731 3400        R     ADDC    A,#HIGH curr_error_sum
0733 F583              MOV     DPH,A
0735 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 666
0738         ?C0080:
                                           ; SOURCE LINE # 668
0738 300005            JNB     interrupt_flag,?C0082
                                           ; SOURCE LINE # 669
073B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 670
073D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 671
0740         ?C0082:
                                           ; SOURCE LINE # 675
0740 E4                CLR     A
0741 F500        R     MOV     pwm_input+03H,A
0743 F500        R     MOV     pwm_input+02H,A
0745 F500        R     MOV     pwm_input+01H,A
0747 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 678
0749 FF                MOV     R7,A
074A FE                MOV     R6,A
074B FD                MOV     R5,A
074C FC                MOV     R4,A
074D AB00        R     MOV     R3,k_p_c_dl+03H
074F AA00        R     MOV     R2,k_p_c_dl+02H
0751 A900        R     MOV     R1,k_p_c_dl+01H
0753 A800        R     MOV     R0,k_p_c_dl
0755 C3                CLR     C
0756 120000      E     LCALL   ?C?SLCMP
0759 6026              JZ      ?C0083
                                           ; SOURCE LINE # 679
075B AF00        R     MOV     R7,curr_error+03H
075D AE00        R     MOV     R6,curr_error+02H
075F AD00        R     MOV     R5,curr_error+01H
0761 AC00        R     MOV     R4,curr_error
0763 A800        R     MOV     R0,k_p_c_dl
0765 120000      E     LCALL   ?C?LMUL
0768 7810              MOV     R0,#010H
076A 120000      E     LCALL   ?C?SLSHR
076D E500        R     MOV     A,pwm_input+03H
076F 2F                ADD     A,R7
0770 F500        R     MOV     pwm_input+03H,A
0772 E500        R     MOV     A,pwm_input+02H
0774 3E                ADDC    A,R6
0775 F500        R     MOV     pwm_input+02H,A
0777 E500        R     MOV     A,pwm_input+01H
0779 3D                ADDC    A,R5
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 50  

077A F500        R     MOV     pwm_input+01H,A
077C E500        R     MOV     A,pwm_input
077E 3C                ADDC    A,R4
077F F500        R     MOV     pwm_input,A
0781         ?C0083:
                                           ; SOURCE LINE # 682
0781 E4                CLR     A
0782 FF                MOV     R7,A
0783 FE                MOV     R6,A
0784 FD                MOV     R5,A
0785 FC                MOV     R4,A
0786 AB00        R     MOV     R3,k_i_c_dl+03H
0788 AA00        R     MOV     R2,k_i_c_dl+02H
078A A900        R     MOV     R1,k_i_c_dl+01H
078C A800        R     MOV     R0,k_i_c_dl
078E C3                CLR     C
078F 120000      E     LCALL   ?C?SLCMP
0792 6038              JZ      ?C0084
                                           ; SOURCE LINE # 683
0794 E500        R     MOV     A,index
0796 25E0              ADD     A,ACC
0798 25E0              ADD     A,ACC
079A 2400        R     ADD     A,#LOW curr_error_sum
079C F582              MOV     DPL,A
079E E4                CLR     A
079F 3400        R     ADDC    A,#HIGH curr_error_sum
07A1 F583              MOV     DPH,A
07A3 E0                MOVX    A,@DPTR
07A4 FC                MOV     R4,A
07A5 A3                INC     DPTR
07A6 E0                MOVX    A,@DPTR
07A7 FD                MOV     R5,A
07A8 A3                INC     DPTR
07A9 E0                MOVX    A,@DPTR
07AA FE                MOV     R6,A
07AB A3                INC     DPTR
07AC E0                MOVX    A,@DPTR
07AD FF                MOV     R7,A
07AE A800        R     MOV     R0,k_i_c_dl
07B0 120000      E     LCALL   ?C?LMUL
07B3 7810              MOV     R0,#010H
07B5 120000      E     LCALL   ?C?SLSHR
07B8 E500        R     MOV     A,pwm_input+03H
07BA 2F                ADD     A,R7
07BB F500        R     MOV     pwm_input+03H,A
07BD E500        R     MOV     A,pwm_input+02H
07BF 3E                ADDC    A,R6
07C0 F500        R     MOV     pwm_input+02H,A
07C2 E500        R     MOV     A,pwm_input+01H
07C4 3D                ADDC    A,R5
07C5 F500        R     MOV     pwm_input+01H,A
07C7 E500        R     MOV     A,pwm_input
07C9 3C                ADDC    A,R4
07CA F500        R     MOV     pwm_input,A
07CC         ?C0084:
                                           ; SOURCE LINE # 686
07CC E4                CLR     A
07CD FF                MOV     R7,A
07CE FE                MOV     R6,A
07CF FD                MOV     R5,A
07D0 FC                MOV     R4,A
07D1 AB00        R     MOV     R3,k_d_c_dl+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 51  

07D3 AA00        R     MOV     R2,k_d_c_dl+02H
07D5 A900        R     MOV     R1,k_d_c_dl+01H
07D7 A800        R     MOV     R0,k_d_c_dl
07D9 C3                CLR     C
07DA 120000      E     LCALL   ?C?SLCMP
07DD 6064              JZ      ?C0085
                                           ; SOURCE LINE # 687
07DF E500        R     MOV     A,index
07E1 25E0              ADD     A,ACC
07E3 2400        E     ADD     A,#LOW g_meas+0CH
07E5 F582              MOV     DPL,A
07E7 E4                CLR     A
07E8 3400        E     ADDC    A,#HIGH g_meas+0CH
07EA F583              MOV     DPH,A
07EC E0                MOVX    A,@DPTR
07ED FE                MOV     R6,A
07EE A3                INC     DPTR
07EF E0                MOVX    A,@DPTR
07F0 FF                MOV     R7,A
07F1 FB                MOV     R3,A
07F2 AA06              MOV     R2,AR6
07F4 EA                MOV     A,R2
07F5 33                RLC     A
07F6 95E0              SUBB    A,ACC
07F8 F9                MOV     R1,A
07F9 F8                MOV     R0,A
07FA E500        R     MOV     A,index
07FC 25E0              ADD     A,ACC
07FE 25E0              ADD     A,ACC
0800 2400        R     ADD     A,#LOW prev_curr
0802 F582              MOV     DPL,A
0804 E4                CLR     A
0805 3400        R     ADDC    A,#HIGH prev_curr
0807 F583              MOV     DPH,A
0809 E0                MOVX    A,@DPTR
080A FC                MOV     R4,A
080B A3                INC     DPTR
080C E0                MOVX    A,@DPTR
080D FD                MOV     R5,A
080E A3                INC     DPTR
080F E0                MOVX    A,@DPTR
0810 FE                MOV     R6,A
0811 A3                INC     DPTR
0812 E0                MOVX    A,@DPTR
0813 C3                CLR     C
0814 9B                SUBB    A,R3
0815 FF                MOV     R7,A
0816 EE                MOV     A,R6
0817 9A                SUBB    A,R2
0818 FE                MOV     R6,A
0819 ED                MOV     A,R5
081A 99                SUBB    A,R1
081B FD                MOV     R5,A
081C EC                MOV     A,R4
081D 98                SUBB    A,R0
081E FC                MOV     R4,A
081F AB00        R     MOV     R3,k_d_c_dl+03H
0821 AA00        R     MOV     R2,k_d_c_dl+02H
0823 A900        R     MOV     R1,k_d_c_dl+01H
0825 A800        R     MOV     R0,k_d_c_dl
0827 120000      E     LCALL   ?C?LMUL
082A 7810              MOV     R0,#010H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 52  

082C 120000      E     LCALL   ?C?SLSHR
082F E500        R     MOV     A,pwm_input+03H
0831 2F                ADD     A,R7
0832 F500        R     MOV     pwm_input+03H,A
0834 E500        R     MOV     A,pwm_input+02H
0836 3E                ADDC    A,R6
0837 F500        R     MOV     pwm_input+02H,A
0839 E500        R     MOV     A,pwm_input+01H
083B 3D                ADDC    A,R5
083C F500        R     MOV     pwm_input+01H,A
083E E500        R     MOV     A,pwm_input
0840 3C                ADDC    A,R4
0841 F500        R     MOV     pwm_input,A
0843         ?C0085:
                                           ; SOURCE LINE # 690
0843 E500        R     MOV     A,index
0845 25E0              ADD     A,ACC
0847 2400        E     ADD     A,#LOW g_meas+0CH
0849 F582              MOV     DPL,A
084B E4                CLR     A
084C 3400        E     ADDC    A,#HIGH g_meas+0CH
084E F583              MOV     DPH,A
0850 E0                MOVX    A,@DPTR
0851 FE                MOV     R6,A
0852 A3                INC     DPTR
0853 E0                MOVX    A,@DPTR
0854 FF                MOV     R7,A
0855 EE                MOV     A,R6
0856 33                RLC     A
0857 95E0              SUBB    A,ACC
0859 FD                MOV     R5,A
085A FC                MOV     R4,A
085B E500        R     MOV     A,index
085D 25E0              ADD     A,ACC
085F 25E0              ADD     A,ACC
0861 2400        R     ADD     A,#LOW prev_curr
0863 F582              MOV     DPL,A
0865 E4                CLR     A
0866 3400        R     ADDC    A,#HIGH prev_curr
0868 F583              MOV     DPH,A
086A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 692
086D 300005            JNB     interrupt_flag,?C0086
                                           ; SOURCE LINE # 693
0870 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 694
0872 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 695
0875         ?C0086:
                                           ; SOURCE LINE # 697
0875 E500        R     MOV     A,index
0877 701C              JNZ     ?C0087
                                           ; SOURCE LINE # 698
0879 FF                MOV     R7,A
087A FE                MOV     R6,A
087B FD                MOV     R5,A
087C FC                MOV     R4,A
087D AB00        R     MOV     R3,pwm_input+03H
087F AA00        R     MOV     R2,pwm_input+02H
0881 A900        R     MOV     R1,pwm_input+01H
0883 A800        R     MOV     R0,pwm_input
0885 C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 53  

0886 120000      E     LCALL   ?C?SLCMP
0889 4005              JC      ?C0088
                                           ; SOURCE LINE # 699
088B D200        R     SETB    dirM0
088D 020000      R     LJMP    ?C0044
0890         ?C0088:
                                           ; SOURCE LINE # 702
0890 C200        R     CLR     dirM0
                                           ; SOURCE LINE # 704
0892 020000      R     LJMP    ?C0044
0895         ?C0087:
                                           ; SOURCE LINE # 705
0895 E4                CLR     A
0896 FF                MOV     R7,A
0897 FE                MOV     R6,A
0898 FD                MOV     R5,A
0899 FC                MOV     R4,A
089A AB00        R     MOV     R3,pwm_input+03H
089C AA00        R     MOV     R2,pwm_input+02H
089E A900        R     MOV     R1,pwm_input+01H
08A0 A800        R     MOV     R0,pwm_input
08A2 C3                CLR     C
08A3 120000      E     LCALL   ?C?SLCMP
08A6 4005              JC      ?C0091
                                           ; SOURCE LINE # 706
08A8 D200        R     SETB    dirM1
08AA 020000      R     LJMP    ?C0044
08AD         ?C0091:
                                           ; SOURCE LINE # 709
08AD C200        R     CLR     dirM1
                                           ; SOURCE LINE # 711
                                           ; SOURCE LINE # 713
08AF 020000      R     LJMP    ?C0044
                                           ; SOURCE LINE # 715
08B2         ?C0093:
                                           ; SOURCE LINE # 718
08B2 E500        R     MOV     A,index
08B4 25E0              ADD     A,ACC
08B6 25E0              ADD     A,ACC
08B8 2400        E     ADD     A,#LOW g_ref
08BA F582              MOV     DPL,A
08BC E4                CLR     A
08BD 3400        E     ADDC    A,#HIGH g_ref
08BF F583              MOV     DPH,A
08C1 E0                MOVX    A,@DPTR
08C2 FC                MOV     R4,A
08C3 A3                INC     DPTR
08C4 E0                MOVX    A,@DPTR
08C5 FD                MOV     R5,A
08C6 A3                INC     DPTR
08C7 E0                MOVX    A,@DPTR
08C8 FE                MOV     R6,A
08C9 A3                INC     DPTR
08CA E0                MOVX    A,@DPTR
08CB FF                MOV     R7,A
08CC 7400        E     MOV     A,#LOW g_mem+037H
08CE 2500        R     ADD     A,index
08D0 F582              MOV     DPL,A
08D2 E4                CLR     A
08D3 3400        E     ADDC    A,#HIGH g_mem+037H
08D5 F583              MOV     DPH,A
08D7 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 54  

08D8 F9                MOV     R1,A
08D9 F8                MOV     R0,A
08DA 120000      E     LCALL   ?C?SLSHR
08DD 8F00        R     MOV     curr_ref+03H,R7
08DF 8E00        R     MOV     curr_ref+02H,R6
08E1 8D00        R     MOV     curr_ref+01H,R5
08E3 8C00        R     MOV     curr_ref,R4
                                           ; SOURCE LINE # 721
08E5 900000      E     MOV     DPTR,#c_mem+032H
08E8 E0                MOVX    A,@DPTR
08E9 FE                MOV     R6,A
08EA A3                INC     DPTR
08EB E0                MOVX    A,@DPTR
08EC FF                MOV     R7,A
08ED EE                MOV     A,R6
08EE 33                RLC     A
08EF 95E0              SUBB    A,ACC
08F1 FD                MOV     R5,A
08F2 FC                MOV     R4,A
08F3 AB00        R     MOV     R3,curr_ref+03H
08F5 AA00        R     MOV     R2,curr_ref+02H
08F7 A900        R     MOV     R1,curr_ref+01H
08F9 A800        R     MOV     R0,curr_ref
08FB D3                SETB    C
08FC 120000      E     LCALL   ?C?SLCMP
08FF 4016              JC      ?C0094
                                           ; SOURCE LINE # 722
0901 900000      E     MOV     DPTR,#c_mem+032H
0904 E0                MOVX    A,@DPTR
0905 FE                MOV     R6,A
0906 A3                INC     DPTR
0907 E0                MOVX    A,@DPTR
0908 FF                MOV     R7,A
0909 EE                MOV     A,R6
090A 33                RLC     A
090B 95E0              SUBB    A,ACC
090D 8F00        R     MOV     curr_ref+03H,R7
090F 8E00        R     MOV     curr_ref+02H,R6
0911 F500        R     MOV     curr_ref+01H,A
0913 F500        R     MOV     curr_ref,A
0915 803C              SJMP    ?C0095
0917         ?C0094:
                                           ; SOURCE LINE # 723
                                           ; SOURCE LINE # 724
0917 900000      E     MOV     DPTR,#c_mem+032H
091A E0                MOVX    A,@DPTR
091B FE                MOV     R6,A
091C A3                INC     DPTR
091D E0                MOVX    A,@DPTR
091E FF                MOV     R7,A
091F C3                CLR     C
0920 E4                CLR     A
0921 9F                SUBB    A,R7
0922 FF                MOV     R7,A
0923 E4                CLR     A
0924 9E                SUBB    A,R6
0925 FE                MOV     R6,A
0926 33                RLC     A
0927 95E0              SUBB    A,ACC
0929 FD                MOV     R5,A
092A FC                MOV     R4,A
092B AB00        R     MOV     R3,curr_ref+03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 55  

092D AA00        R     MOV     R2,curr_ref+02H
092F A900        R     MOV     R1,curr_ref+01H
0931 A800        R     MOV     R0,curr_ref
0933 C3                CLR     C
0934 120000      E     LCALL   ?C?SLCMP
0937 501A              JNC     ?C0095
                                           ; SOURCE LINE # 725
0939 900000      E     MOV     DPTR,#c_mem+032H
093C E0                MOVX    A,@DPTR
093D FE                MOV     R6,A
093E A3                INC     DPTR
093F E0                MOVX    A,@DPTR
0940 FF                MOV     R7,A
0941 C3                CLR     C
0942 E4                CLR     A
0943 9F                SUBB    A,R7
0944 FF                MOV     R7,A
0945 E4                CLR     A
0946 9E                SUBB    A,R6
0947 FE                MOV     R6,A
0948 33                RLC     A
0949 95E0              SUBB    A,ACC
094B 8F00        R     MOV     curr_ref+03H,R7
094D 8E00        R     MOV     curr_ref+02H,R6
094F F500        R     MOV     curr_ref+01H,A
0951 F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 726
0953         ?C0095:
                                           ; SOURCE LINE # 730
0953 E500        R     MOV     A,index
0955 25E0              ADD     A,ACC
0957 2400        E     ADD     A,#LOW g_meas+0CH
0959 F582              MOV     DPL,A
095B E4                CLR     A
095C 3400        E     ADDC    A,#HIGH g_meas+0CH
095E F583              MOV     DPH,A
0960 E0                MOVX    A,@DPTR
0961 FE                MOV     R6,A
0962 A3                INC     DPTR
0963 E0                MOVX    A,@DPTR
0964 FF                MOV     R7,A
0965 FB                MOV     R3,A
0966 AA06              MOV     R2,AR6
0968 EA                MOV     A,R2
0969 33                RLC     A
096A 95E0              SUBB    A,ACC
096C F9                MOV     R1,A
096D F8                MOV     R0,A
096E C3                CLR     C
096F E500        R     MOV     A,curr_ref+03H
0971 9B                SUBB    A,R3
0972 F500        R     MOV     curr_error+03H,A
0974 E500        R     MOV     A,curr_ref+02H
0976 9A                SUBB    A,R2
0977 F500        R     MOV     curr_error+02H,A
0979 E500        R     MOV     A,curr_ref+01H
097B 99                SUBB    A,R1
097C F500        R     MOV     curr_error+01H,A
097E E500        R     MOV     A,curr_ref
0980 98                SUBB    A,R0
0981 F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 733
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 56  

0983 E500        R     MOV     A,index
0985 25E0              ADD     A,ACC
0987 25E0              ADD     A,ACC
0989 2400        R     ADD     A,#LOW curr_error_sum
098B F582              MOV     DPL,A
098D E4                CLR     A
098E 3400        R     ADDC    A,#HIGH curr_error_sum
0990 F583              MOV     DPH,A
0992 C083              PUSH    DPH
0994 C082              PUSH    DPL
0996 E0                MOVX    A,@DPTR
0997 FC                MOV     R4,A
0998 A3                INC     DPTR
0999 E0                MOVX    A,@DPTR
099A FD                MOV     R5,A
099B A3                INC     DPTR
099C E0                MOVX    A,@DPTR
099D FE                MOV     R6,A
099E A3                INC     DPTR
099F E0                MOVX    A,@DPTR
09A0 2500        R     ADD     A,curr_error+03H
09A2 FF                MOV     R7,A
09A3 EE                MOV     A,R6
09A4 3500        R     ADDC    A,curr_error+02H
09A6 FE                MOV     R6,A
09A7 ED                MOV     A,R5
09A8 3500        R     ADDC    A,curr_error+01H
09AA FD                MOV     R5,A
09AB EC                MOV     A,R4
09AC 3500        R     ADDC    A,curr_error
09AE FC                MOV     R4,A
09AF D082              POP     DPL
09B1 D083              POP     DPH
09B3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 736
09B6 E500        R     MOV     A,index
09B8 25E0              ADD     A,ACC
09BA 25E0              ADD     A,ACC
09BC 2400        R     ADD     A,#LOW curr_error_sum
09BE F582              MOV     DPL,A
09C0 E4                CLR     A
09C1 3400        R     ADDC    A,#HIGH curr_error_sum
09C3 F583              MOV     DPH,A
09C5 E0                MOVX    A,@DPTR
09C6 FC                MOV     R4,A
09C7 A3                INC     DPTR
09C8 E0                MOVX    A,@DPTR
09C9 FD                MOV     R5,A
09CA A3                INC     DPTR
09CB E0                MOVX    A,@DPTR
09CC FE                MOV     R6,A
09CD A3                INC     DPTR
09CE E0                MOVX    A,@DPTR
09CF FF                MOV     R7,A
09D0 7BA0              MOV     R3,#0A0H
09D2 7A86              MOV     R2,#086H
09D4 7901              MOV     R1,#01H
09D6 7800              MOV     R0,#00H
09D8 C3                CLR     C
09D9 120000      E     LCALL   ?C?SLCMP
09DC 501C              JNC     ?C0097
                                           ; SOURCE LINE # 737
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 57  

09DE 7FA0              MOV     R7,#0A0H
09E0 7E86              MOV     R6,#086H
09E2 7D01              MOV     R5,#01H
09E4 7C00              MOV     R4,#00H
09E6 E500        R     MOV     A,index
09E8 25E0              ADD     A,ACC
09EA 25E0              ADD     A,ACC
09EC 2400        R     ADD     A,#LOW curr_error_sum
09EE F582              MOV     DPL,A
09F0 E4                CLR     A
09F1 3400        R     ADDC    A,#HIGH curr_error_sum
09F3 F583              MOV     DPH,A
09F5 120000      E     LCALL   ?C?LSTXDATA
09F8 8042              SJMP    ?C0098
09FA         ?C0097:
                                           ; SOURCE LINE # 738
                                           ; SOURCE LINE # 739
09FA E500        R     MOV     A,index
09FC 25E0              ADD     A,ACC
09FE 25E0              ADD     A,ACC
0A00 2400        R     ADD     A,#LOW curr_error_sum
0A02 F582              MOV     DPL,A
0A04 E4                CLR     A
0A05 3400        R     ADDC    A,#HIGH curr_error_sum
0A07 F583              MOV     DPH,A
0A09 E0                MOVX    A,@DPTR
0A0A FC                MOV     R4,A
0A0B A3                INC     DPTR
0A0C E0                MOVX    A,@DPTR
0A0D FD                MOV     R5,A
0A0E A3                INC     DPTR
0A0F E0                MOVX    A,@DPTR
0A10 FE                MOV     R6,A
0A11 A3                INC     DPTR
0A12 E0                MOVX    A,@DPTR
0A13 FF                MOV     R7,A
0A14 7B60              MOV     R3,#060H
0A16 7A79              MOV     R2,#079H
0A18 79FE              MOV     R1,#0FEH
0A1A 78FF              MOV     R0,#0FFH
0A1C D3                SETB    C
0A1D 120000      E     LCALL   ?C?SLCMP
0A20 401A              JC      ?C0098
                                           ; SOURCE LINE # 740
0A22 7F60              MOV     R7,#060H
0A24 7E79              MOV     R6,#079H
0A26 7DFE              MOV     R5,#0FEH
0A28 7CFF              MOV     R4,#0FFH
0A2A E500        R     MOV     A,index
0A2C 25E0              ADD     A,ACC
0A2E 25E0              ADD     A,ACC
0A30 2400        R     ADD     A,#LOW curr_error_sum
0A32 F582              MOV     DPL,A
0A34 E4                CLR     A
0A35 3400        R     ADDC    A,#HIGH curr_error_sum
0A37 F583              MOV     DPH,A
0A39 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 741
0A3C         ?C0098:
                                           ; SOURCE LINE # 750
0A3C E4                CLR     A
0A3D F500        R     MOV     pwm_input+03H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 58  

0A3F F500        R     MOV     pwm_input+02H,A
0A41 F500        R     MOV     pwm_input+01H,A
0A43 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 753
0A45 FF                MOV     R7,A
0A46 FE                MOV     R6,A
0A47 FD                MOV     R5,A
0A48 FC                MOV     R4,A
0A49 AB00        R     MOV     R3,k_p_c+03H
0A4B AA00        R     MOV     R2,k_p_c+02H
0A4D A900        R     MOV     R1,k_p_c+01H
0A4F A800        R     MOV     R0,k_p_c
0A51 C3                CLR     C
0A52 120000      E     LCALL   ?C?SLCMP
0A55 602C              JZ      ?C0100
                                           ; SOURCE LINE # 754
0A57 AF00        R     MOV     R7,curr_error+03H
0A59 AE00        R     MOV     R6,curr_error+02H
0A5B AD00        R     MOV     R5,curr_error+01H
0A5D AC00        R     MOV     R4,curr_error
0A5F AB00        R     MOV     R3,k_p+03H
0A61 AA00        R     MOV     R2,k_p+02H
0A63 A900        R     MOV     R1,k_p+01H
0A65 A800        R     MOV     R0,k_p
0A67 120000      E     LCALL   ?C?LMUL
0A6A 7810              MOV     R0,#010H
0A6C 120000      E     LCALL   ?C?SLSHR
0A6F E500        R     MOV     A,pwm_input+03H
0A71 2F                ADD     A,R7
0A72 F500        R     MOV     pwm_input+03H,A
0A74 E500        R     MOV     A,pwm_input+02H
0A76 3E                ADDC    A,R6
0A77 F500        R     MOV     pwm_input+02H,A
0A79 E500        R     MOV     A,pwm_input+01H
0A7B 3D                ADDC    A,R5
0A7C F500        R     MOV     pwm_input+01H,A
0A7E E500        R     MOV     A,pwm_input
0A80 3C                ADDC    A,R4
0A81 F500        R     MOV     pwm_input,A
0A83         ?C0100:
                                           ; SOURCE LINE # 758
0A83 E4                CLR     A
0A84 FF                MOV     R7,A
0A85 FE                MOV     R6,A
0A86 FD                MOV     R5,A
0A87 FC                MOV     R4,A
0A88 AB00        R     MOV     R3,k_i_c+03H
0A8A AA00        R     MOV     R2,k_i_c+02H
0A8C A900        R     MOV     R1,k_i_c+01H
0A8E A800        R     MOV     R0,k_i_c
0A90 C3                CLR     C
0A91 120000      E     LCALL   ?C?SLCMP
0A94 603D              JZ      ?C0101
                                           ; SOURCE LINE # 759
0A96 E500        R     MOV     A,index
0A98 25E0              ADD     A,ACC
0A9A 25E0              ADD     A,ACC
0A9C 2400        R     ADD     A,#LOW curr_error_sum
0A9E F582              MOV     DPL,A
0AA0 E4                CLR     A
0AA1 3400        R     ADDC    A,#HIGH curr_error_sum
0AA3 F583              MOV     DPH,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 59  

0AA5 E0                MOVX    A,@DPTR
0AA6 FC                MOV     R4,A
0AA7 A3                INC     DPTR
0AA8 E0                MOVX    A,@DPTR
0AA9 FD                MOV     R5,A
0AAA A3                INC     DPTR
0AAB E0                MOVX    A,@DPTR
0AAC FE                MOV     R6,A
0AAD A3                INC     DPTR
0AAE E0                MOVX    A,@DPTR
0AAF FF                MOV     R7,A
0AB0 7806              MOV     R0,#06H
0AB2 120000      E     LCALL   ?C?SLSHR
0AB5 A800        R     MOV     R0,k_i_c
0AB7 120000      E     LCALL   ?C?LMUL
0ABA 780A              MOV     R0,#0AH
0ABC 120000      E     LCALL   ?C?SLSHR
0ABF E500        R     MOV     A,pwm_input+03H
0AC1 2F                ADD     A,R7
0AC2 F500        R     MOV     pwm_input+03H,A
0AC4 E500        R     MOV     A,pwm_input+02H
0AC6 3E                ADDC    A,R6
0AC7 F500        R     MOV     pwm_input+02H,A
0AC9 E500        R     MOV     A,pwm_input+01H
0ACB 3D                ADDC    A,R5
0ACC F500        R     MOV     pwm_input+01H,A
0ACE E500        R     MOV     A,pwm_input
0AD0 3C                ADDC    A,R4
0AD1 F500        R     MOV     pwm_input,A
0AD3         ?C0101:
                                           ; SOURCE LINE # 762
0AD3 E4                CLR     A
0AD4 FF                MOV     R7,A
0AD5 FE                MOV     R6,A
0AD6 FD                MOV     R5,A
0AD7 FC                MOV     R4,A
0AD8 AB00        R     MOV     R3,k_d_c+03H
0ADA AA00        R     MOV     R2,k_d_c+02H
0ADC A900        R     MOV     R1,k_d_c+01H
0ADE A800        R     MOV     R0,k_d_c
0AE0 C3                CLR     C
0AE1 120000      E     LCALL   ?C?SLCMP
0AE4 6064              JZ      ?C0102
                                           ; SOURCE LINE # 763
0AE6 E500        R     MOV     A,index
0AE8 25E0              ADD     A,ACC
0AEA 2400        E     ADD     A,#LOW g_meas+0CH
0AEC F582              MOV     DPL,A
0AEE E4                CLR     A
0AEF 3400        E     ADDC    A,#HIGH g_meas+0CH
0AF1 F583              MOV     DPH,A
0AF3 E0                MOVX    A,@DPTR
0AF4 FE                MOV     R6,A
0AF5 A3                INC     DPTR
0AF6 E0                MOVX    A,@DPTR
0AF7 FF                MOV     R7,A
0AF8 FB                MOV     R3,A
0AF9 AA06              MOV     R2,AR6
0AFB EA                MOV     A,R2
0AFC 33                RLC     A
0AFD 95E0              SUBB    A,ACC
0AFF F9                MOV     R1,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 60  

0B00 F8                MOV     R0,A
0B01 E500        R     MOV     A,index
0B03 25E0              ADD     A,ACC
0B05 25E0              ADD     A,ACC
0B07 2400        R     ADD     A,#LOW prev_curr
0B09 F582              MOV     DPL,A
0B0B E4                CLR     A
0B0C 3400        R     ADDC    A,#HIGH prev_curr
0B0E F583              MOV     DPH,A
0B10 E0                MOVX    A,@DPTR
0B11 FC                MOV     R4,A
0B12 A3                INC     DPTR
0B13 E0                MOVX    A,@DPTR
0B14 FD                MOV     R5,A
0B15 A3                INC     DPTR
0B16 E0                MOVX    A,@DPTR
0B17 FE                MOV     R6,A
0B18 A3                INC     DPTR
0B19 E0                MOVX    A,@DPTR
0B1A C3                CLR     C
0B1B 9B                SUBB    A,R3
0B1C FF                MOV     R7,A
0B1D EE                MOV     A,R6
0B1E 9A                SUBB    A,R2
0B1F FE                MOV     R6,A
0B20 ED                MOV     A,R5
0B21 99                SUBB    A,R1
0B22 FD                MOV     R5,A
0B23 EC                MOV     A,R4
0B24 98                SUBB    A,R0
0B25 FC                MOV     R4,A
0B26 AB00        R     MOV     R3,k_d_c+03H
0B28 AA00        R     MOV     R2,k_d_c+02H
0B2A A900        R     MOV     R1,k_d_c+01H
0B2C A800        R     MOV     R0,k_d_c
0B2E 120000      E     LCALL   ?C?LMUL
0B31 7810              MOV     R0,#010H
0B33 120000      E     LCALL   ?C?SLSHR
0B36 E500        R     MOV     A,pwm_input+03H
0B38 2F                ADD     A,R7
0B39 F500        R     MOV     pwm_input+03H,A
0B3B E500        R     MOV     A,pwm_input+02H
0B3D 3E                ADDC    A,R6
0B3E F500        R     MOV     pwm_input+02H,A
0B40 E500        R     MOV     A,pwm_input+01H
0B42 3D                ADDC    A,R5
0B43 F500        R     MOV     pwm_input+01H,A
0B45 E500        R     MOV     A,pwm_input
0B47 3C                ADDC    A,R4
0B48 F500        R     MOV     pwm_input,A
0B4A         ?C0102:
                                           ; SOURCE LINE # 770
0B4A E500        R     MOV     A,index
0B4C 25E0              ADD     A,ACC
0B4E 2400        E     ADD     A,#LOW g_meas+0CH
0B50 F582              MOV     DPL,A
0B52 E4                CLR     A
0B53 3400        E     ADDC    A,#HIGH g_meas+0CH
0B55 F583              MOV     DPH,A
0B57 E0                MOVX    A,@DPTR
0B58 FE                MOV     R6,A
0B59 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 61  

0B5A E0                MOVX    A,@DPTR
0B5B FF                MOV     R7,A
0B5C EE                MOV     A,R6
0B5D 33                RLC     A
0B5E 95E0              SUBB    A,ACC
0B60 FD                MOV     R5,A
0B61 FC                MOV     R4,A
0B62 E500        R     MOV     A,index
0B64 25E0              ADD     A,ACC
0B66 25E0              ADD     A,ACC
0B68 2400        R     ADD     A,#LOW prev_curr
0B6A F582              MOV     DPL,A
0B6C E4                CLR     A
0B6D 3400        R     ADDC    A,#HIGH prev_curr
0B6F F583              MOV     DPH,A
0B71 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 772
0B74 E500        R     MOV     A,index
0B76 701C              JNZ     ?C0103
                                           ; SOURCE LINE # 773
0B78 FF                MOV     R7,A
0B79 FE                MOV     R6,A
0B7A FD                MOV     R5,A
0B7B FC                MOV     R4,A
0B7C AB00        R     MOV     R3,pwm_input+03H
0B7E AA00        R     MOV     R2,pwm_input+02H
0B80 A900        R     MOV     R1,pwm_input+01H
0B82 A800        R     MOV     R0,pwm_input
0B84 C3                CLR     C
0B85 120000      E     LCALL   ?C?SLCMP
0B88 4005              JC      ?C0104
                                           ; SOURCE LINE # 774
0B8A D200        R     SETB    dirM0
0B8C 020000      R     LJMP    ?C0044
0B8F         ?C0104:
                                           ; SOURCE LINE # 777
0B8F C200        R     CLR     dirM0
                                           ; SOURCE LINE # 779
0B91 020000      R     LJMP    ?C0044
0B94         ?C0103:
                                           ; SOURCE LINE # 780
0B94 E4                CLR     A
0B95 FF                MOV     R7,A
0B96 FE                MOV     R6,A
0B97 FD                MOV     R5,A
0B98 FC                MOV     R4,A
0B99 AB00        R     MOV     R3,pwm_input+03H
0B9B AA00        R     MOV     R2,pwm_input+02H
0B9D A900        R     MOV     R1,pwm_input+01H
0B9F A800        R     MOV     R0,pwm_input
0BA1 C3                CLR     C
0BA2 120000      E     LCALL   ?C?SLCMP
0BA5 4004              JC      ?C0107
                                           ; SOURCE LINE # 781
0BA7 D200        R     SETB    dirM1
0BA9 806E              SJMP    ?C0044
0BAB         ?C0107:
                                           ; SOURCE LINE # 784
0BAB C200        R     CLR     dirM1
                                           ; SOURCE LINE # 786
                                           ; SOURCE LINE # 788
0BAD 806A              SJMP    ?C0044
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 62  

                                           ; SOURCE LINE # 790
0BAF         ?C0109:
                                           ; SOURCE LINE # 792
0BAF E500        R     MOV     A,index
0BB1 25E0              ADD     A,ACC
0BB3 25E0              ADD     A,ACC
0BB5 2400        E     ADD     A,#LOW g_ref
0BB7 F582              MOV     DPL,A
0BB9 E4                CLR     A
0BBA 3400        E     ADDC    A,#HIGH g_ref
0BBC F583              MOV     DPH,A
0BBE E0                MOVX    A,@DPTR
0BBF FC                MOV     R4,A
0BC0 A3                INC     DPTR
0BC1 E0                MOVX    A,@DPTR
0BC2 FD                MOV     R5,A
0BC3 A3                INC     DPTR
0BC4 E0                MOVX    A,@DPTR
0BC5 FE                MOV     R6,A
0BC6 A3                INC     DPTR
0BC7 E0                MOVX    A,@DPTR
0BC8 FF                MOV     R7,A
0BC9 7400        E     MOV     A,#LOW g_mem+037H
0BCB 2500        R     ADD     A,index
0BCD F582              MOV     DPL,A
0BCF E4                CLR     A
0BD0 3400        E     ADDC    A,#HIGH g_mem+037H
0BD2 F583              MOV     DPH,A
0BD4 E0                MOVX    A,@DPTR
0BD5 F9                MOV     R1,A
0BD6 F8                MOV     R0,A
0BD7 120000      E     LCALL   ?C?SLSHR
0BDA 8F00        R     MOV     pwm_input+03H,R7
0BDC 8E00        R     MOV     pwm_input+02H,R6
0BDE 8D00        R     MOV     pwm_input+01H,R5
0BE0 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 794
0BE2 E500        R     MOV     A,index
0BE4 701A              JNZ     ?C0110
                                           ; SOURCE LINE # 795
0BE6 FF                MOV     R7,A
0BE7 FE                MOV     R6,A
0BE8 FD                MOV     R5,A
0BE9 FC                MOV     R4,A
0BEA AB00        R     MOV     R3,pwm_input+03H
0BEC AA00        R     MOV     R2,pwm_input+02H
0BEE A900        R     MOV     R1,pwm_input+01H
0BF0 A800        R     MOV     R0,pwm_input
0BF2 C3                CLR     C
0BF3 120000      E     LCALL   ?C?SLCMP
0BF6 4004              JC      ?C0111
                                           ; SOURCE LINE # 796
0BF8 D200        R     SETB    dirM0
0BFA 801D              SJMP    ?C0044
0BFC         ?C0111:
                                           ; SOURCE LINE # 799
0BFC C200        R     CLR     dirM0
                                           ; SOURCE LINE # 801
0BFE 8019              SJMP    ?C0044
0C00         ?C0110:
                                           ; SOURCE LINE # 802
0C00 E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 63  

0C01 FF                MOV     R7,A
0C02 FE                MOV     R6,A
0C03 FD                MOV     R5,A
0C04 FC                MOV     R4,A
0C05 AB00        R     MOV     R3,pwm_input+03H
0C07 AA00        R     MOV     R2,pwm_input+02H
0C09 A900        R     MOV     R1,pwm_input+01H
0C0B A800        R     MOV     R0,pwm_input
0C0D C3                CLR     C
0C0E 120000      E     LCALL   ?C?SLCMP
0C11 4004              JC      ?C0114
                                           ; SOURCE LINE # 803
0C13 D200        R     SETB    dirM1
0C15 8002              SJMP    ?C0044
0C17         ?C0114:
                                           ; SOURCE LINE # 806
0C17 C200        R     CLR     dirM1
                                           ; SOURCE LINE # 808
                                           ; SOURCE LINE # 810
                                           ; SOURCE LINE # 812
                                           ; SOURCE LINE # 813
                                           ; SOURCE LINE # 814
0C19         ?C0044:
                                           ; SOURCE LINE # 816
0C19 300005            JNB     interrupt_flag,?C0117
                                           ; SOURCE LINE # 817
0C1C C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 818
0C1E 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 819
0C21         ?C0117:
                                           ; SOURCE LINE # 822
0C21 E4                CLR     A
0C22 7F64              MOV     R7,#064H
0C24 FE                MOV     R6,A
0C25 FD                MOV     R5,A
0C26 FC                MOV     R4,A
0C27 AB00        R     MOV     R3,pwm_input+03H
0C29 AA00        R     MOV     R2,pwm_input+02H
0C2B A900        R     MOV     R1,pwm_input+01H
0C2D A800        R     MOV     R0,pwm_input
0C2F D3                SETB    C
0C30 120000      E     LCALL   ?C?SLCMP
0C33 400A              JC      ?C0118
                                           ; SOURCE LINE # 823
0C35 E4                CLR     A
0C36 750064      R     MOV     pwm_input+03H,#064H
0C39 F500        R     MOV     pwm_input+02H,A
0C3B F500        R     MOV     pwm_input+01H,A
0C3D F500        R     MOV     pwm_input,A
0C3F         ?C0118:
                                           ; SOURCE LINE # 824
0C3F 74FF              MOV     A,#0FFH
0C41 7F9C              MOV     R7,#09CH
0C43 FE                MOV     R6,A
0C44 FD                MOV     R5,A
0C45 FC                MOV     R4,A
0C46 AB00        R     MOV     R3,pwm_input+03H
0C48 AA00        R     MOV     R2,pwm_input+02H
0C4A A900        R     MOV     R1,pwm_input+01H
0C4C A800        R     MOV     R0,pwm_input
0C4E C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 64  

0C4F 120000      E     LCALL   ?C?SLCMP
0C52 500B              JNC     ?C0119
                                           ; SOURCE LINE # 825
0C54 74FF              MOV     A,#0FFH
0C56 75009C      R     MOV     pwm_input+03H,#09CH
0C59 F500        R     MOV     pwm_input+02H,A
0C5B F500        R     MOV     pwm_input+01H,A
0C5D F500        R     MOV     pwm_input,A
0C5F         ?C0119:
                                           ; SOURCE LINE # 827
0C5F 300005            JNB     interrupt_flag,?C0120
                                           ; SOURCE LINE # 828
0C62 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 829
0C64 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 830
0C67         ?C0120:
                                           ; SOURCE LINE # 833
0C67 900000      E     MOV     DPTR,#c_mem+036H
0C6A E0                MOVX    A,@DPTR
0C6B 6401              XRL     A,#01H
0C6D 6037              JZ      ?C0121
                                           ; SOURCE LINE # 834
0C6F AF00        R     MOV     R7,pwm_input+03H
0C71 AE00        R     MOV     R6,pwm_input+02H
0C73 AD00        R     MOV     R5,pwm_input+01H
0C75 AC00        R     MOV     R4,pwm_input
0C77 780A              MOV     R0,#0AH
0C79 120000      E     LCALL   ?C?LSHL
0C7C E4                CLR     A
0C7D 7B64              MOV     R3,#064H
0C7F FA                MOV     R2,A
0C80 F9                MOV     R1,A
0C81 F8                MOV     R0,A
0C82 120000      E     LCALL   ?C?SLDIV
0C85 A804              MOV     R0,AR4
0C87 A905              MOV     R1,AR5
0C89 AA06              MOV     R2,AR6
0C8B AB07              MOV     R3,AR7
0C8D 900000      E     MOV     DPTR,#dev_pwm_limit
0C90 E0                MOVX    A,@DPTR
0C91 FF                MOV     R7,A
0C92 E4                CLR     A
0C93 FC                MOV     R4,A
0C94 FD                MOV     R5,A
0C95 FE                MOV     R6,A
0C96 120000      E     LCALL   ?C?LMUL
0C99 780A              MOV     R0,#0AH
0C9B 120000      E     LCALL   ?C?SLSHR
0C9E 8F00        R     MOV     pwm_input+03H,R7
0CA0 8E00        R     MOV     pwm_input+02H,R6
0CA2 8D00        R     MOV     pwm_input+01H,R5
0CA4 8C00        R     MOV     pwm_input,R4
0CA6         ?C0121:
                                           ; SOURCE LINE # 838
0CA6 300011            JNB     dirM0,?C0122
                                           ; SOURCE LINE # 839
0CA9 300007            JNB     dirM1,?C0123
                                           ; SOURCE LINE # 840
0CAC 7F03              MOV     R7,#03H
0CAE 120000      E     LCALL   _MOTOR_DIR_Write
0CB1 8016              SJMP    ?C0125
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 65  

0CB3         ?C0123:
                                           ; SOURCE LINE # 842
0CB3 7F01              MOV     R7,#01H
0CB5 120000      E     LCALL   _MOTOR_DIR_Write
                                           ; SOURCE LINE # 843
0CB8 800F              SJMP    ?C0125
0CBA         ?C0122:
                                           ; SOURCE LINE # 844
                                           ; SOURCE LINE # 845
0CBA 300007            JNB     dirM1,?C0126
                                           ; SOURCE LINE # 846
0CBD 7F02              MOV     R7,#02H
0CBF 120000      E     LCALL   _MOTOR_DIR_Write
0CC2 8005              SJMP    ?C0125
0CC4         ?C0126:
                                           ; SOURCE LINE # 848
0CC4 E4                CLR     A
0CC5 FF                MOV     R7,A
0CC6 120000      E     LCALL   _MOTOR_DIR_Write
                                           ; SOURCE LINE # 849
0CC9         ?C0125:
                                           ; SOURCE LINE # 851
0CC9 300005            JNB     interrupt_flag,?C0128
                                           ; SOURCE LINE # 852
0CCC C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 853
0CCE 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 854
0CD1         ?C0128:
                                           ; SOURCE LINE # 856
0CD1 E500        R     MOV     A,index
0CD3 7046              JNZ     ?C0129
                                           ; SOURCE LINE # 857
0CD5 FF                MOV     R7,A
0CD6 FE                MOV     R6,A
0CD7 FD                MOV     R5,A
0CD8 FC                MOV     R4,A
0CD9 AB00        R     MOV     R3,pwm_input+03H
0CDB AA00        R     MOV     R2,pwm_input+02H
0CDD A900        R     MOV     R1,pwm_input+01H
0CDF A800        R     MOV     R0,pwm_input
0CE1 D3                SETB    C
0CE2 120000      E     LCALL   ?C?SLCMP
0CE5 4006              JC      ?C0130
0CE7 7E00              MOV     R6,#00H
0CE9 7F01              MOV     R7,#01H
0CEB 801D              SJMP    ?C0131
0CED         ?C0130:
0CED E4                CLR     A
0CEE FF                MOV     R7,A
0CEF FE                MOV     R6,A
0CF0 FD                MOV     R5,A
0CF1 FC                MOV     R4,A
0CF2 AB00        R     MOV     R3,pwm_input+03H
0CF4 AA00        R     MOV     R2,pwm_input+02H
0CF6 A900        R     MOV     R1,pwm_input+01H
0CF8 A800        R     MOV     R0,pwm_input
0CFA C3                CLR     C
0CFB 120000      E     LCALL   ?C?SLCMP
0CFE 5006              JNC     ?C0132
0D00 7EFF              MOV     R6,#0FFH
0D02 7FFF              MOV     R7,#0FFH
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 66  

0D04 8004              SJMP    ?C0133
0D06         ?C0132:
0D06 7E00              MOV     R6,#00H
0D08 7F00              MOV     R7,#00H
0D0A         ?C0133:
0D0A         ?C0131:
0D0A 900000      E     MOV     DPTR,#pwm_sign
0D0D EF                MOV     A,R7
0D0E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 858
0D0F AE00        R     MOV     R6,pwm_input+02H
0D11 AF00        R     MOV     R7,pwm_input+03H
0D13 120000      E     LCALL   _abs
0D16 120000      E     LCALL   _PWM_MOTORS_WriteCompare1
                                           ; SOURCE LINE # 859
0D19 8045              SJMP    ?C0134
0D1B         ?C0129:
                                           ; SOURCE LINE # 860
                                           ; SOURCE LINE # 861
0D1B E4                CLR     A
0D1C FF                MOV     R7,A
0D1D FE                MOV     R6,A
0D1E FD                MOV     R5,A
0D1F FC                MOV     R4,A
0D20 AB00        R     MOV     R3,pwm_input+03H
0D22 AA00        R     MOV     R2,pwm_input+02H
0D24 A900        R     MOV     R1,pwm_input+01H
0D26 A800        R     MOV     R0,pwm_input
0D28 D3                SETB    C
0D29 120000      E     LCALL   ?C?SLCMP
0D2C 4006              JC      ?C0135
0D2E 7E00              MOV     R6,#00H
0D30 7F01              MOV     R7,#01H
0D32 801D              SJMP    ?C0136
0D34         ?C0135:
0D34 E4                CLR     A
0D35 FF                MOV     R7,A
0D36 FE                MOV     R6,A
0D37 FD                MOV     R5,A
0D38 FC                MOV     R4,A
0D39 AB00        R     MOV     R3,pwm_input+03H
0D3B AA00        R     MOV     R2,pwm_input+02H
0D3D A900        R     MOV     R1,pwm_input+01H
0D3F A800        R     MOV     R0,pwm_input
0D41 C3                CLR     C
0D42 120000      E     LCALL   ?C?SLCMP
0D45 5006              JNC     ?C0137
0D47 7EFF              MOV     R6,#0FFH
0D49 7FFF              MOV     R7,#0FFH
0D4B 8004              SJMP    ?C0138
0D4D         ?C0137:
0D4D 7E00              MOV     R6,#00H
0D4F 7F00              MOV     R7,#00H
0D51         ?C0138:
0D51         ?C0136:
0D51 900000      E     MOV     DPTR,#pwm_sign+01H
0D54 EF                MOV     A,R7
0D55 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 862
0D56 AE00        R     MOV     R6,pwm_input+02H
0D58 AF00        R     MOV     R7,pwm_input+03H
0D5A 120000      E     LCALL   _abs
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 67  

0D5D 120000      E     LCALL   _PWM_MOTORS_WriteCompare2
                                           ; SOURCE LINE # 863
0D60         ?C0134:
                                           ; SOURCE LINE # 865
0D60 300005            JNB     interrupt_flag,?C0043
                                           ; SOURCE LINE # 866
0D63 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 867
0D65 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 868
                                           ; SOURCE LINE # 869
0D68         ?C0043:
0D68 22                RET     
             ; FUNCTION _motor_control (END)

             ; FUNCTION analog_read_end (BEGIN)
                                           ; SOURCE LINE # 875
0000         ?C0140:
                                           ; SOURCE LINE # 896
0000 120000      E     LCALL   ADC_STATUS_Read
0003 EF                MOV     A,R7
0004 700A              JNZ     ?C0141
                                           ; SOURCE LINE # 897
0006 3000F7            JNB     interrupt_flag,?C0140
                                           ; SOURCE LINE # 898
0009 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 899
000B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 900
                                           ; SOURCE LINE # 901
000E 80F0              SJMP    ?C0140
0010         ?C0141:
                                           ; SOURCE LINE # 904
0010 900000      E     MOV     DPTR,#ADC_buf+01H
0013 E0                MOVX    A,@DPTR
0014 249A              ADD     A,#09AH
0016 FF                MOV     R7,A
0017 900000      E     MOV     DPTR,#ADC_buf
001A E0                MOVX    A,@DPTR
001B 34F9              ADDC    A,#0F9H
001D FE                MOV     R6,A
001E 33                RLC     A
001F 95E0              SUBB    A,ACC
0021 FD                MOV     R5,A
0022 FC                MOV     R4,A
0023 E4                CLR     A
0024 7BA0              MOV     R3,#0A0H
0026 7A07              MOV     R2,#07H
0028 F9                MOV     R1,A
0029 F8                MOV     R0,A
002A 120000      E     LCALL   ?C?LMUL
002D 7807              MOV     R0,#07H
002F 120000      E     LCALL   ?C?SLSHR
0032 900000      E     MOV     DPTR,#dev_tension
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 906
0038 300005            JNB     interrupt_flag,?C0143
                                           ; SOURCE LINE # 907
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 908
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 909
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 68  

0040         ?C0143:
                                           ; SOURCE LINE # 913
0040 E4                CLR     A
0041 FF                MOV     R7,A
0042 FE                MOV     R6,A
0043 FD                MOV     R5,A
0044 FC                MOV     R4,A
0045 900000      E     MOV     DPTR,#dev_tension
0048 E0                MOVX    A,@DPTR
0049 F8                MOV     R0,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C F9                MOV     R1,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F FA                MOV     R2,A
0050 A3                INC     DPTR
0051 E0                MOVX    A,@DPTR
0052 FB                MOV     R3,A
0053 D3                SETB    C
0054 120000      E     LCALL   ?C?SLCMP
0057 5003              JNC     $ + 5H
0059 020000      R     LJMP    ?C0144
                                           ; SOURCE LINE # 916
005C 120000      R     LCALL   pwm_limit_search
                                           ; SOURCE LINE # 920
005F 300005            JNB     interrupt_flag,?C0145
                                           ; SOURCE LINE # 921
0062 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 922
0064 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 923
0067         ?C0145:
                                           ; SOURCE LINE # 926
0067 900000      E     MOV     DPTR,#ADC_buf+03H
006A E0                MOVX    A,@DPTR
006B 249A              ADD     A,#09AH
006D FF                MOV     R7,A
006E 900000      E     MOV     DPTR,#ADC_buf+02H
0071 E0                MOVX    A,@DPTR
0072 34F9              ADDC    A,#0F9H
0074 FE                MOV     R6,A
0075 33                RLC     A
0076 95E0              SUBB    A,ACC
0078 FD                MOV     R5,A
0079 FC                MOV     R4,A
007A E4                CLR     A
007B 7BAB              MOV     R3,#0ABH
007D 7A64              MOV     R2,#064H
007F F9                MOV     R1,A
0080 F8                MOV     R0,A
0081 120000      E     LCALL   ?C?LMUL
0084 780D              MOV     R0,#0DH
0086 120000      E     LCALL   ?C?SLSHR
0089 900000      E     MOV     DPTR,#pwm_sign
008C E0                MOVX    A,@DPTR
008D FD                MOV     R5,A
008E 33                RLC     A
008F 95E0              SUBB    A,ACC
0091 FC                MOV     R4,A
0092 120000      E     LCALL   ?C?IMUL
0095 EE                MOV     A,R6
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 69  

0096 33                RLC     A
0097 95E0              SUBB    A,ACC
0099 FD                MOV     R5,A
009A FC                MOV     R4,A
009B 120000      E     LCALL   _filter_i1
009E 900000      E     MOV     DPTR,#g_meas+0CH
00A1 EE                MOV     A,R6
00A2 F0                MOVX    @DPTR,A
00A3 A3                INC     DPTR
00A4 EF                MOV     A,R7
00A5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 930
00A6 300005            JNB     interrupt_flag,?C0146
                                           ; SOURCE LINE # 931
00A9 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 932
00AB 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 933
00AE         ?C0146:
                                           ; SOURCE LINE # 934
00AE 900000      E     MOV     DPTR,#ADC_buf+05H
00B1 E0                MOVX    A,@DPTR
00B2 249A              ADD     A,#09AH
00B4 FF                MOV     R7,A
00B5 900000      E     MOV     DPTR,#ADC_buf+04H
00B8 E0                MOVX    A,@DPTR
00B9 34F9              ADDC    A,#0F9H
00BB FE                MOV     R6,A
00BC 33                RLC     A
00BD 95E0              SUBB    A,ACC
00BF FD                MOV     R5,A
00C0 FC                MOV     R4,A
00C1 E4                CLR     A
00C2 7BAB              MOV     R3,#0ABH
00C4 7A64              MOV     R2,#064H
00C6 F9                MOV     R1,A
00C7 F8                MOV     R0,A
00C8 120000      E     LCALL   ?C?LMUL
00CB 780D              MOV     R0,#0DH
00CD 120000      E     LCALL   ?C?SLSHR
00D0 900000      E     MOV     DPTR,#pwm_sign+01H
00D3 E0                MOVX    A,@DPTR
00D4 FD                MOV     R5,A
00D5 33                RLC     A
00D6 95E0              SUBB    A,ACC
00D8 FC                MOV     R4,A
00D9 120000      E     LCALL   ?C?IMUL
00DC EE                MOV     A,R6
00DD 33                RLC     A
00DE 95E0              SUBB    A,ACC
00E0 FD                MOV     R5,A
00E1 FC                MOV     R4,A
00E2 120000      E     LCALL   _filter_i2
00E5 900000      E     MOV     DPTR,#g_meas+0EH
00E8 EE                MOV     A,R6
00E9 F0                MOVX    @DPTR,A
00EA A3                INC     DPTR
00EB EF                MOV     A,R7
00EC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 938
00ED 300011            JNB     interrupt_flag,?C0149
                                           ; SOURCE LINE # 939
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 70  

00F0 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 940
00F2 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 941
                                           ; SOURCE LINE # 942
00F5 22                RET     
00F6         ?C0144:
                                           ; SOURCE LINE # 944
                                           ; SOURCE LINE # 945
00F6 E4                CLR     A
00F7 900000      E     MOV     DPTR,#g_meas+0CH
00FA F0                MOVX    @DPTR,A
00FB A3                INC     DPTR
00FC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 946
00FD A3                INC     DPTR
00FE F0                MOVX    @DPTR,A
00FF A3                INC     DPTR
0100 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 947
                                           ; SOURCE LINE # 948
0101         ?C0149:
0101 22                RET     
             ; FUNCTION analog_read_end (END)

             ; FUNCTION _encoder_reading (BEGIN)
                                           ; SOURCE LINE # 954
0000 900000      R     MOV     DPTR,#flag
0003 ED                MOV     A,R5
0004 F0                MOVX    @DPTR,A
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 955
                                           ; SOURCE LINE # 956
0005 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 974
0007 E500        R     MOV     A,index
0009 C3                CLR     C
000A 9403              SUBB    A,#03H
000C 4003              JC      $ + 5H
000E 020000      R     LJMP    ?C0151
0011         ?C0150:
                                           ; SOURCE LINE # 977
0011 300022            JNB     reset_last_value_flag,?C0152
                                           ; SOURCE LINE # 978
;---- Variable 'jj' assigned to Register 'R3' ----
0014 7B03              MOV     R3,#03H
0016         ?C0153:
0016 AF03              MOV     R7,AR3
0018 1B                DEC     R3
0019 EF                MOV     A,R7
001A 6018              JZ      ?C0154
                                           ; SOURCE LINE # 979
001C E4                CLR     A
001D FF                MOV     R7,A
001E FE                MOV     R6,A
001F FD                MOV     R5,A
0020 FC                MOV     R4,A
0021 EB                MOV     A,R3
0022 25E0              ADD     A,ACC
0024 25E0              ADD     A,ACC
0026 2400        R     ADD     A,#LOW last_value_encoder
0028 F582              MOV     DPL,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 71  

002A E4                CLR     A
002B 3400        R     ADDC    A,#HIGH last_value_encoder
002D F583              MOV     DPH,A
002F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 980
0032 80E2              SJMP    ?C0153
0034         ?C0154:
                                           ; SOURCE LINE # 981
0034 C200        E     CLR     reset_last_value_flag
                                           ; SOURCE LINE # 982
0036         ?C0152:
                                           ; SOURCE LINE # 985
0036 E500        R     MOV     A,index
0038 7013              JNZ     ?C0155
                                           ; SOURCE LINE # 986
003A 120000      E     LCALL   SHIFTREG_ENC_1_ReadData
003D EF                MOV     A,R7
003E EE                MOV     A,R6
003F ED                MOV     A,R5
0040 5403              ANL     A,#03H
0042 FD                MOV     R5,A
0043 E4                CLR     A
0044 FC                MOV     R4,A
0045 900000      R     MOV     DPTR,#data_encoder
0048 120000      E     LCALL   ?C?LSTXDATA
004B 8041              SJMP    ?C0156
004D         ?C0155:
                                           ; SOURCE LINE # 987
                                           ; SOURCE LINE # 988
004D E500        R     MOV     A,index
004F B40113            CJNE    A,#01H,?C0157
                                           ; SOURCE LINE # 989
0052 120000      E     LCALL   SHIFTREG_ENC_2_ReadData
0055 EF                MOV     A,R7
0056 EE                MOV     A,R6
0057 ED                MOV     A,R5
0058 5403              ANL     A,#03H
005A FD                MOV     R5,A
005B E4                CLR     A
005C FC                MOV     R4,A
005D 900000      R     MOV     DPTR,#data_encoder
0060 120000      E     LCALL   ?C?LSTXDATA
0063 8029              SJMP    ?C0156
0065         ?C0157:
                                           ; SOURCE LINE # 990
                                           ; SOURCE LINE # 991
0065 E500        R     MOV     A,index
0067 B40213            CJNE    A,#02H,?C0159
                                           ; SOURCE LINE # 992
006A 120000      E     LCALL   SHIFTREG_ENC_3_ReadData
006D EF                MOV     A,R7
006E EE                MOV     A,R6
006F ED                MOV     A,R5
0070 5403              ANL     A,#03H
0072 FD                MOV     R5,A
0073 E4                CLR     A
0074 FC                MOV     R4,A
0075 900000      R     MOV     DPTR,#data_encoder
0078 120000      E     LCALL   ?C?LSTXDATA
007B 8011              SJMP    ?C0156
007D         ?C0159:
                                           ; SOURCE LINE # 994
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 72  

007D 120000      E     LCALL   SHIFTREG_ENC_4_ReadData
0080 EF                MOV     A,R7
0081 EE                MOV     A,R6
0082 ED                MOV     A,R5
0083 5403              ANL     A,#03H
0085 FD                MOV     R5,A
0086 E4                CLR     A
0087 FC                MOV     R4,A
0088 900000      R     MOV     DPTR,#data_encoder
008B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 995
                                           ; SOURCE LINE # 996
008E         ?C0156:
                                           ; SOURCE LINE # 998
008E 7B01              MOV     R3,#01H
0090 7A00        R     MOV     R2,#HIGH data_encoder
0092 7900        R     MOV     R1,#LOW data_encoder
0094 120000      E     LCALL   _check_enc_data
0097 4003              JC      $ + 5H
0099 020000      R     LJMP    ?C0151
                                           ; SOURCE LINE # 999
009C 900000      R     MOV     DPTR,#flag
009F E0                MOVX    A,@DPTR
00A0 602D              JZ      ?C0162
                                           ; SOURCE LINE # 1000
00A2 A3                INC     DPTR
00A3 E0                MOVX    A,@DPTR
00A4 FC                MOV     R4,A
00A5 A3                INC     DPTR
00A6 E0                MOVX    A,@DPTR
00A7 FD                MOV     R5,A
00A8 A3                INC     DPTR
00A9 E0                MOVX    A,@DPTR
00AA FE                MOV     R6,A
00AB A3                INC     DPTR
00AC E0                MOVX    A,@DPTR
00AD 54C0              ANL     A,#0C0H
00AF FF                MOV     R7,A
00B0 EE                MOV     A,R6
00B1 ED                MOV     A,R5
00B2 5403              ANL     A,#03H
00B4 FD                MOV     R5,A
00B5 E4                CLR     A
00B6 FC                MOV     R4,A
00B7 7802              MOV     R0,#02H
00B9 120000      E     LCALL   ?C?ULSHR
00BC C3                CLR     C
00BD E4                CLR     A
00BE 9F                SUBB    A,R7
00BF FF                MOV     R7,A
00C0 7480              MOV     A,#080H
00C2 9E                SUBB    A,R6
00C3 FE                MOV     R6,A
00C4 33                RLC     A
00C5 95E0              SUBB    A,ACC
00C7 FD                MOV     R5,A
00C8 FC                MOV     R4,A
00C9 A3                INC     DPTR
00CA 120000      E     LCALL   ?C?LSTXDATA
00CD 804B              SJMP    ?C0163
00CF         ?C0162:
                                           ; SOURCE LINE # 1002
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 73  

00CF 900000      R     MOV     DPTR,#data_encoder
00D2 E0                MOVX    A,@DPTR
00D3 FC                MOV     R4,A
00D4 A3                INC     DPTR
00D5 E0                MOVX    A,@DPTR
00D6 FD                MOV     R5,A
00D7 A3                INC     DPTR
00D8 E0                MOVX    A,@DPTR
00D9 FE                MOV     R6,A
00DA A3                INC     DPTR
00DB E0                MOVX    A,@DPTR
00DC 54C0              ANL     A,#0C0H
00DE FF                MOV     R7,A
00DF EE                MOV     A,R6
00E0 ED                MOV     A,R5
00E1 5403              ANL     A,#03H
00E3 FD                MOV     R5,A
00E4 E4                CLR     A
00E5 FC                MOV     R4,A
00E6 7802              MOV     R0,#02H
00E8 120000      E     LCALL   ?C?ULSHR
00EB C3                CLR     C
00EC E4                CLR     A
00ED 9F                SUBB    A,R7
00EE FB                MOV     R3,A
00EF 7480              MOV     A,#080H
00F1 9E                SUBB    A,R6
00F2 FA                MOV     R2,A
00F3 E500        R     MOV     A,index
00F5 25E0              ADD     A,ACC
00F7 25E0              ADD     A,ACC
00F9 2400        E     ADD     A,#LOW g_mem+03AH
00FB F582              MOV     DPL,A
00FD E4                CLR     A
00FE 3400        E     ADDC    A,#HIGH g_mem+03AH
0100 F583              MOV     DPH,A
0102 E0                MOVX    A,@DPTR
0103 A3                INC     DPTR
0104 E0                MOVX    A,@DPTR
0105 A3                INC     DPTR
0106 E0                MOVX    A,@DPTR
0107 FE                MOV     R6,A
0108 A3                INC     DPTR
0109 E0                MOVX    A,@DPTR
010A 2B                ADD     A,R3
010B FF                MOV     R7,A
010C EA                MOV     A,R2
010D 3E                ADDC    A,R6
010E FE                MOV     R6,A
010F 33                RLC     A
0110 95E0              SUBB    A,ACC
0112 FD                MOV     R5,A
0113 FC                MOV     R4,A
0114 900000      R     MOV     DPTR,#value_encoder
0117 120000      E     LCALL   ?C?LSTXDATA
011A         ?C0163:
                                           ; SOURCE LINE # 1005
011A 300027            JNB     only_first_time,?C0164
                                           ; SOURCE LINE # 1006
011D 900000      R     MOV     DPTR,#value_encoder
0120 E0                MOVX    A,@DPTR
0121 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 74  

0122 A3                INC     DPTR
0123 E0                MOVX    A,@DPTR
0124 FD                MOV     R5,A
0125 A3                INC     DPTR
0126 E0                MOVX    A,@DPTR
0127 FE                MOV     R6,A
0128 A3                INC     DPTR
0129 E0                MOVX    A,@DPTR
012A FF                MOV     R7,A
012B E500        R     MOV     A,index
012D 25E0              ADD     A,ACC
012F 25E0              ADD     A,ACC
0131 2400        R     ADD     A,#LOW last_value_encoder
0133 F582              MOV     DPL,A
0135 E4                CLR     A
0136 3400        R     ADDC    A,#HIGH last_value_encoder
0138 F583              MOV     DPH,A
013A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1008
013D E500        R     MOV     A,index
013F B40202            CJNE    A,#02H,?C0164
                                           ; SOURCE LINE # 1009
0142 C200        R     CLR     only_first_time
                                           ; SOURCE LINE # 1010
0144         ?C0164:
                                           ; SOURCE LINE # 1013
0144 E500        R     MOV     A,index
0146 25E0              ADD     A,ACC
0148 25E0              ADD     A,ACC
014A 2400        R     ADD     A,#LOW last_value_encoder
014C F582              MOV     DPL,A
014E E4                CLR     A
014F 3400        R     ADDC    A,#HIGH last_value_encoder
0151 F583              MOV     DPH,A
0153 E0                MOVX    A,@DPTR
0154 F8                MOV     R0,A
0155 A3                INC     DPTR
0156 E0                MOVX    A,@DPTR
0157 F9                MOV     R1,A
0158 A3                INC     DPTR
0159 E0                MOVX    A,@DPTR
015A FA                MOV     R2,A
015B A3                INC     DPTR
015C E0                MOVX    A,@DPTR
015D FB                MOV     R3,A
015E 900000      R     MOV     DPTR,#value_encoder
0161 E0                MOVX    A,@DPTR
0162 FC                MOV     R4,A
0163 A3                INC     DPTR
0164 E0                MOVX    A,@DPTR
0165 FD                MOV     R5,A
0166 A3                INC     DPTR
0167 E0                MOVX    A,@DPTR
0168 FE                MOV     R6,A
0169 A3                INC     DPTR
016A E0                MOVX    A,@DPTR
016B C3                CLR     C
016C 9B                SUBB    A,R3
016D FF                MOV     R7,A
016E EE                MOV     A,R6
016F 9A                SUBB    A,R2
0170 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 75  

0171 ED                MOV     A,R5
0172 99                SUBB    A,R1
0173 FD                MOV     R5,A
0174 EC                MOV     A,R4
0175 98                SUBB    A,R0
0176 FC                MOV     R4,A
0177 A3                INC     DPTR
0178 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1033
017B E4                CLR     A
017C FF                MOV     R7,A
017D 7EC0              MOV     R6,#0C0H
017F FD                MOV     R5,A
0180 FC                MOV     R4,A
0181 900000      R     MOV     DPTR,#aux
0184 E0                MOVX    A,@DPTR
0185 F8                MOV     R0,A
0186 A3                INC     DPTR
0187 E0                MOVX    A,@DPTR
0188 F9                MOV     R1,A
0189 A3                INC     DPTR
018A E0                MOVX    A,@DPTR
018B FA                MOV     R2,A
018C A3                INC     DPTR
018D E0                MOVX    A,@DPTR
018E FB                MOV     R3,A
018F D3                SETB    C
0190 120000      E     LCALL   ?C?SLCMP
0193 4010              JC      ?C0166
                                           ; SOURCE LINE # 1034
0195 7400        E     MOV     A,#LOW g_meas+010H
0197 2500        R     ADD     A,index
0199 F582              MOV     DPL,A
019B E4                CLR     A
019C 3400        E     ADDC    A,#HIGH g_meas+010H
019E F583              MOV     DPH,A
01A0 E0                MOVX    A,@DPTR
01A1 14                DEC     A
01A2 F0                MOVX    @DPTR,A
01A3 8068              SJMP    ?C0167
01A5         ?C0166:
                                           ; SOURCE LINE # 1035
                                           ; SOURCE LINE # 1036
01A5 7F00              MOV     R7,#00H
01A7 7E40              MOV     R6,#040H
01A9 7DFF              MOV     R5,#0FFH
01AB 7CFF              MOV     R4,#0FFH
01AD 900000      R     MOV     DPTR,#aux
01B0 E0                MOVX    A,@DPTR
01B1 F8                MOV     R0,A
01B2 A3                INC     DPTR
01B3 E0                MOVX    A,@DPTR
01B4 F9                MOV     R1,A
01B5 A3                INC     DPTR
01B6 E0                MOVX    A,@DPTR
01B7 FA                MOV     R2,A
01B8 A3                INC     DPTR
01B9 E0                MOVX    A,@DPTR
01BA FB                MOV     R3,A
01BB C3                CLR     C
01BC 120000      E     LCALL   ?C?SLCMP
01BF 5010              JNC     ?C0168
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 76  

                                           ; SOURCE LINE # 1037
01C1 7400        E     MOV     A,#LOW g_meas+010H
01C3 2500        R     ADD     A,index
01C5 F582              MOV     DPL,A
01C7 E4                CLR     A
01C8 3400        E     ADDC    A,#HIGH g_meas+010H
01CA F583              MOV     DPH,A
01CC E0                MOVX    A,@DPTR
01CD 04                INC     A
01CE F0                MOVX    @DPTR,A
01CF 803C              SJMP    ?C0167
01D1         ?C0168:
                                           ; SOURCE LINE # 1038
                                           ; SOURCE LINE # 1039
01D1 900000      R     MOV     DPTR,#aux
01D4 E0                MOVX    A,@DPTR
01D5 A3                INC     DPTR
01D6 E0                MOVX    A,@DPTR
01D7 A3                INC     DPTR
01D8 E0                MOVX    A,@DPTR
01D9 FE                MOV     R6,A
01DA A3                INC     DPTR
01DB E0                MOVX    A,@DPTR
01DC FF                MOV     R7,A
01DD 120000      E     LCALL   _abs
01E0 D3                SETB    C
01E1 EF                MOV     A,R7
01E2 9400              SUBB    A,#00H
01E4 EE                MOV     A,R6
01E5 6480              XRL     A,#080H
01E7 94C0              SUBB    A,#0C0H
01E9 4022              JC      ?C0167
                                           ; SOURCE LINE # 1040
01EB 7400        R     MOV     A,#LOW error
01ED 2500        R     ADD     A,index
01EF F582              MOV     DPL,A
01F1 E4                CLR     A
01F2 3400        R     ADDC    A,#HIGH error
01F4 F583              MOV     DPH,A
01F6 E0                MOVX    A,@DPTR
01F7 04                INC     A
01F8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1041
01F9 7400        R     MOV     A,#LOW error
01FB 2500        R     ADD     A,index
01FD F582              MOV     DPL,A
01FF E4                CLR     A
0200 3400        R     ADDC    A,#HIGH error
0202 F583              MOV     DPH,A
0204 E0                MOVX    A,@DPTR
0205 C3                CLR     C
0206 940A              SUBB    A,#0AH
0208 5003              JNC     $ + 5H
020A 020000      R     LJMP    ?C0151
020D         ?C0171:
                                           ; SOURCE LINE # 1044
                                           ; SOURCE LINE # 1045
                                           ; SOURCE LINE # 1046
020D         ?C0167:
                                           ; SOURCE LINE # 1048
020D 7400        R     MOV     A,#LOW error
020F 2500        R     ADD     A,index
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 77  

0211 F582              MOV     DPL,A
0213 E4                CLR     A
0214 3400        R     ADDC    A,#HIGH error
0216 F583              MOV     DPH,A
0218 E4                CLR     A
0219 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1050
021A 900000      R     MOV     DPTR,#value_encoder
021D E0                MOVX    A,@DPTR
021E FC                MOV     R4,A
021F A3                INC     DPTR
0220 E0                MOVX    A,@DPTR
0221 FD                MOV     R5,A
0222 A3                INC     DPTR
0223 E0                MOVX    A,@DPTR
0224 FE                MOV     R6,A
0225 A3                INC     DPTR
0226 E0                MOVX    A,@DPTR
0227 FF                MOV     R7,A
0228 E500        R     MOV     A,index
022A 25E0              ADD     A,ACC
022C 25E0              ADD     A,ACC
022E 2400        R     ADD     A,#LOW last_value_encoder
0230 F582              MOV     DPL,A
0232 E4                CLR     A
0233 3400        R     ADDC    A,#HIGH last_value_encoder
0235 F583              MOV     DPH,A
0237 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1052
023A 900000      R     MOV     DPTR,#value_encoder
023D E0                MOVX    A,@DPTR
023E F8                MOV     R0,A
023F A3                INC     DPTR
0240 E0                MOVX    A,@DPTR
0241 F9                MOV     R1,A
0242 A3                INC     DPTR
0243 E0                MOVX    A,@DPTR
0244 FA                MOV     R2,A
0245 A3                INC     DPTR
0246 E0                MOVX    A,@DPTR
0247 FB                MOV     R3,A
0248 C000              PUSH    AR0
024A 7400        E     MOV     A,#LOW g_meas+010H
024C 2500        R     ADD     A,index
024E F582              MOV     DPL,A
0250 E4                CLR     A
0251 3400        E     ADDC    A,#HIGH g_meas+010H
0253 F583              MOV     DPH,A
0255 E0                MOVX    A,@DPTR
0256 FF                MOV     R7,A
0257 33                RLC     A
0258 95E0              SUBB    A,ACC
025A FE                MOV     R6,A
025B FD                MOV     R5,A
025C FC                MOV     R4,A
025D 7810              MOV     R0,#010H
025F 120000      E     LCALL   ?C?LSHL
0262 D000              POP     AR0
0264 EB                MOV     A,R3
0265 2F                ADD     A,R7
0266 FF                MOV     R7,A
0267 EA                MOV     A,R2
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 78  

0268 3E                ADDC    A,R6
0269 FE                MOV     R6,A
026A E9                MOV     A,R1
026B 3D                ADDC    A,R5
026C FD                MOV     R5,A
026D E8                MOV     A,R0
026E 3C                ADDC    A,R4
026F FC                MOV     R4,A
0270 900000      R     MOV     DPTR,#value_encoder
0273 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1054
0276 E500        R     MOV     A,index
0278 25E0              ADD     A,ACC
027A 25E0              ADD     A,ACC
027C 2400        E     ADD     A,#LOW c_mem+046H
027E F582              MOV     DPL,A
0280 E4                CLR     A
0281 3400        E     ADDC    A,#HIGH c_mem+046H
0283 F583              MOV     DPH,A
0285 E0                MOVX    A,@DPTR
0286 FC                MOV     R4,A
0287 A3                INC     DPTR
0288 E0                MOVX    A,@DPTR
0289 FD                MOV     R5,A
028A A3                INC     DPTR
028B E0                MOVX    A,@DPTR
028C FE                MOV     R6,A
028D A3                INC     DPTR
028E E0                MOVX    A,@DPTR
028F FF                MOV     R7,A
0290 E4                CLR     A
0291 FB                MOV     R3,A
0292 FA                MOV     R2,A
0293 7980              MOV     R1,#080H
0295 783F              MOV     R0,#03FH
0297 120000      E     LCALL   ?C?FPCMP3
029A 6038              JZ      ?C0172
                                           ; SOURCE LINE # 1055
029C 900000      R     MOV     DPTR,#value_encoder
029F E0                MOVX    A,@DPTR
02A0 FC                MOV     R4,A
02A1 A3                INC     DPTR
02A2 E0                MOVX    A,@DPTR
02A3 FD                MOV     R5,A
02A4 A3                INC     DPTR
02A5 E0                MOVX    A,@DPTR
02A6 FE                MOV     R6,A
02A7 A3                INC     DPTR
02A8 E0                MOVX    A,@DPTR
02A9 FF                MOV     R7,A
02AA EC                MOV     A,R4
02AB 120000      E     LCALL   ?C?FCASTL
02AE E500        R     MOV     A,index
02B0 25E0              ADD     A,ACC
02B2 25E0              ADD     A,ACC
02B4 2400        E     ADD     A,#LOW c_mem+046H
02B6 F582              MOV     DPL,A
02B8 E4                CLR     A
02B9 3400        E     ADDC    A,#HIGH c_mem+046H
02BB F583              MOV     DPH,A
02BD E0                MOVX    A,@DPTR
02BE F8                MOV     R0,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 79  

02BF A3                INC     DPTR
02C0 E0                MOVX    A,@DPTR
02C1 F9                MOV     R1,A
02C2 A3                INC     DPTR
02C3 E0                MOVX    A,@DPTR
02C4 FA                MOV     R2,A
02C5 A3                INC     DPTR
02C6 E0                MOVX    A,@DPTR
02C7 FB                MOV     R3,A
02C8 120000      E     LCALL   ?C?FPMUL
02CB 120000      E     LCALL   ?C?CASTF
02CE 900000      R     MOV     DPTR,#value_encoder
02D1 120000      E     LCALL   ?C?LSTXDATA
02D4         ?C0172:
                                           ; SOURCE LINE # 1057
02D4 900000      R     MOV     DPTR,#value_encoder
02D7 E0                MOVX    A,@DPTR
02D8 FC                MOV     R4,A
02D9 A3                INC     DPTR
02DA E0                MOVX    A,@DPTR
02DB FD                MOV     R5,A
02DC A3                INC     DPTR
02DD E0                MOVX    A,@DPTR
02DE FE                MOV     R6,A
02DF A3                INC     DPTR
02E0 E0                MOVX    A,@DPTR
02E1 FF                MOV     R7,A
02E2 E500        R     MOV     A,index
02E4 25E0              ADD     A,ACC
02E6 25E0              ADD     A,ACC
02E8 2400        E     ADD     A,#LOW g_meas
02EA F582              MOV     DPL,A
02EC E4                CLR     A
02ED 3400        E     ADDC    A,#HIGH g_meas
02EF F583              MOV     DPH,A
02F1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1058
                                           ; SOURCE LINE # 1080
02F4         ?C0151:
02F4 22                RET     
             ; FUNCTION _encoder_reading (END)

             ; FUNCTION pwm_limit_search (BEGIN)
                                           ; SOURCE LINE # 1085
                                           ; SOURCE LINE # 1088
0000 750063      R     MOV     max_tension,#063H
0003 75009C      R     MOV     max_tension+01H,#09CH
                                           ; SOURCE LINE # 1089
0006 750039      R     MOV     max_tension_6v_mod,#039H
0009 75009E      R     MOV     max_tension_6v_mod+01H,#09EH
                                           ; SOURCE LINE # 1091
000C C3                CLR     C
000D 900000      E     MOV     DPTR,#g_mem+088H
0010 E0                MOVX    A,@DPTR
0011 9440              SUBB    A,#040H
0013 900000      E     MOV     DPTR,#g_mem+087H
0016 E0                MOVX    A,@DPTR
0017 941F              SUBB    A,#01FH
0019 507E              JNC     ?C0173
                                           ; SOURCE LINE # 1093
001B AE00        R     MOV     R6,max_tension_6v_mod
001D AF00        R     MOV     R7,max_tension_6v_mod+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 80  

001F E4                CLR     A
0020 FC                MOV     R4,A
0021 FD                MOV     R5,A
0022 900000      E     MOV     DPTR,#dev_tension
0025 E0                MOVX    A,@DPTR
0026 F8                MOV     R0,A
0027 A3                INC     DPTR
0028 E0                MOVX    A,@DPTR
0029 F9                MOV     R1,A
002A A3                INC     DPTR
002B E0                MOVX    A,@DPTR
002C FA                MOV     R2,A
002D A3                INC     DPTR
002E E0                MOVX    A,@DPTR
002F FB                MOV     R3,A
0030 120000      E     LCALL   ?C?SLCMP
0033 4006              JC      ?C0174
                                           ; SOURCE LINE # 1094
0035 E4                CLR     A
0036 900000      E     MOV     DPTR,#dev_pwm_limit
0039 F0                MOVX    @DPTR,A
003A 22                RET     
003B         ?C0174:
                                           ; SOURCE LINE # 1096
                                           ; SOURCE LINE # 1097
003B 900000      E     MOV     DPTR,#g_mem+087H
003E E0                MOVX    A,@DPTR
003F FE                MOV     R6,A
0040 A3                INC     DPTR
0041 E0                MOVX    A,@DPTR
0042 FF                MOV     R7,A
0043 E4                CLR     A
0044 FC                MOV     R4,A
0045 FD                MOV     R5,A
0046 900000      E     MOV     DPTR,#dev_tension
0049 E0                MOVX    A,@DPTR
004A F8                MOV     R0,A
004B A3                INC     DPTR
004C E0                MOVX    A,@DPTR
004D F9                MOV     R1,A
004E A3                INC     DPTR
004F E0                MOVX    A,@DPTR
0050 FA                MOV     R2,A
0051 A3                INC     DPTR
0052 E0                MOVX    A,@DPTR
0053 FB                MOV     R3,A
0054 C3                CLR     C
0055 120000      E     LCALL   ?C?SLCMP
0058 5007              JNC     ?C0176
                                           ; SOURCE LINE # 1098
005A 900000      E     MOV     DPTR,#dev_pwm_limit
005D 7464              MOV     A,#064H
005F F0                MOVX    @DPTR,A
0060 22                RET     
0061         ?C0176:
                                           ; SOURCE LINE # 1099
                                           ; SOURCE LINE # 1100
0061 900000      E     MOV     DPTR,#g_mem+087H
0064 E0                MOVX    A,@DPTR
0065 FE                MOV     R6,A
0066 A3                INC     DPTR
0067 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 81  

0068 FF                MOV     R7,A
0069 FB                MOV     R3,A
006A AA06              MOV     R2,AR6
006C E4                CLR     A
006D 900000      E     MOV     DPTR,#dev_tension
0070 E0                MOVX    A,@DPTR
0071 FC                MOV     R4,A
0072 A3                INC     DPTR
0073 E0                MOVX    A,@DPTR
0074 FD                MOV     R5,A
0075 A3                INC     DPTR
0076 E0                MOVX    A,@DPTR
0077 FE                MOV     R6,A
0078 A3                INC     DPTR
0079 E0                MOVX    A,@DPTR
007A C3                CLR     C
007B 9B                SUBB    A,R3
007C FF                MOV     R7,A
007D EE                MOV     A,R6
007E 9A                SUBB    A,R2
007F FE                MOV     R6,A
0080 ED                MOV     A,R5
0081 9400              SUBB    A,#00H
0083 FD                MOV     R5,A
0084 EC                MOV     A,R4
0085 9400              SUBB    A,#00H
0087 FC                MOV     R4,A
0088 7809              MOV     R0,#09H
008A 120000      E     LCALL   ?C?SLSHR
008D 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 1101
008F EF                MOV     A,R7
0090 900000      R     MOV     DPTR,#hitech_pwm_preload_values_6v
0093 93                MOVC    A,@A+DPTR
0094 900000      E     MOV     DPTR,#dev_pwm_limit
0097 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1102
                                           ; SOURCE LINE # 1103
                                           ; SOURCE LINE # 1104
0098 22                RET     
0099         ?C0173:
                                           ; SOURCE LINE # 1105
                                           ; SOURCE LINE # 1107
0099 AE00        R     MOV     R6,max_tension
009B AF00        R     MOV     R7,max_tension+01H
009D E4                CLR     A
009E FC                MOV     R4,A
009F FD                MOV     R5,A
00A0 900000      E     MOV     DPTR,#dev_tension
00A3 E0                MOVX    A,@DPTR
00A4 F8                MOV     R0,A
00A5 A3                INC     DPTR
00A6 E0                MOVX    A,@DPTR
00A7 F9                MOV     R1,A
00A8 A3                INC     DPTR
00A9 E0                MOVX    A,@DPTR
00AA FA                MOV     R2,A
00AB A3                INC     DPTR
00AC E0                MOVX    A,@DPTR
00AD FB                MOV     R3,A
00AE D3                SETB    C
00AF 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 82  

00B2 4006              JC      ?C0179
                                           ; SOURCE LINE # 1108
00B4 E4                CLR     A
00B5 900000      E     MOV     DPTR,#dev_pwm_limit
00B8 F0                MOVX    @DPTR,A
00B9 22                RET     
00BA         ?C0179:
                                           ; SOURCE LINE # 1109
                                           ; SOURCE LINE # 1110
00BA 900000      E     MOV     DPTR,#g_mem+087H
00BD E0                MOVX    A,@DPTR
00BE FE                MOV     R6,A
00BF A3                INC     DPTR
00C0 E0                MOVX    A,@DPTR
00C1 FF                MOV     R7,A
00C2 E4                CLR     A
00C3 FC                MOV     R4,A
00C4 FD                MOV     R5,A
00C5 900000      E     MOV     DPTR,#dev_tension
00C8 E0                MOVX    A,@DPTR
00C9 F8                MOV     R0,A
00CA A3                INC     DPTR
00CB E0                MOVX    A,@DPTR
00CC F9                MOV     R1,A
00CD A3                INC     DPTR
00CE E0                MOVX    A,@DPTR
00CF FA                MOV     R2,A
00D0 A3                INC     DPTR
00D1 E0                MOVX    A,@DPTR
00D2 FB                MOV     R3,A
00D3 C3                CLR     C
00D4 120000      E     LCALL   ?C?SLCMP
00D7 5007              JNC     ?C0181
                                           ; SOURCE LINE # 1111
00D9 900000      E     MOV     DPTR,#dev_pwm_limit
00DC 7464              MOV     A,#064H
00DE F0                MOVX    @DPTR,A
00DF 22                RET     
00E0         ?C0181:
                                           ; SOURCE LINE # 1112
                                           ; SOURCE LINE # 1113
00E0 900000      E     MOV     DPTR,#dev_tension
00E3 E0                MOVX    A,@DPTR
00E4 FC                MOV     R4,A
00E5 A3                INC     DPTR
00E6 E0                MOVX    A,@DPTR
00E7 FD                MOV     R5,A
00E8 A3                INC     DPTR
00E9 E0                MOVX    A,@DPTR
00EA FE                MOV     R6,A
00EB A3                INC     DPTR
00EC E0                MOVX    A,@DPTR
00ED 24C0              ADD     A,#0C0H
00EF FF                MOV     R7,A
00F0 EE                MOV     A,R6
00F1 34E0              ADDC    A,#0E0H
00F3 FE                MOV     R6,A
00F4 ED                MOV     A,R5
00F5 34FF              ADDC    A,#0FFH
00F7 FD                MOV     R5,A
00F8 EC                MOV     A,R4
00F9 34FF              ADDC    A,#0FFH
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 83  

00FB FC                MOV     R4,A
00FC 7809              MOV     R0,#09H
00FE 120000      E     LCALL   ?C?SLSHR
0101 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 1114
0103 C3                CLR     C
0104 900000      E     MOV     DPTR,#g_mem+088H
0107 E0                MOVX    A,@DPTR
0108 94EC              SUBB    A,#0ECH
010A 900000      E     MOV     DPTR,#g_mem+087H
010D E0                MOVX    A,@DPTR
010E 942C              SUBB    A,#02CH
0110 500A              JNC     ?C0183
                                           ; SOURCE LINE # 1115
0112 EF                MOV     A,R7
0113 900000      R     MOV     DPTR,#hitech_pwm_preload_values
0116 93                MOVC    A,@A+DPTR
0117 900000      E     MOV     DPTR,#dev_pwm_limit
011A F0                MOVX    @DPTR,A
011B 22                RET     
011C         ?C0183:
                                           ; SOURCE LINE # 1117
011C E500        R     MOV     A,index
011E 900000      R     MOV     DPTR,#pwm_preload_values
0121 93                MOVC    A,@A+DPTR
0122 900000      E     MOV     DPTR,#dev_pwm_limit
0125 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1118
                                           ; SOURCE LINE # 1119
                                           ; SOURCE LINE # 1120
                                           ; SOURCE LINE # 1121
0126         ?C0185:
0126 22                RET     
             ; FUNCTION pwm_limit_search (END)

             ; FUNCTION pretensioning_process (BEGIN)
                                           ; SOURCE LINE # 1127
                                           ; SOURCE LINE # 1133
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#i
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1135
0005 900000      R     MOV     DPTR,#phase
0008 E0                MOVX    A,@DPTR
0009 14                DEC     A
000A 7003              JNZ     $ + 5H
000C 020000      R     LJMP    ?C0190
000F 04                INC     A
0010 6003              JZ      $ + 5H
0012 020000      R     LJMP    ?C0196
                                           ; SOURCE LINE # 1136
0015         ?C0187:
                                           ; SOURCE LINE # 1137
0015 900000      E     MOV     DPTR,#g_meas+0CH
0018 E0                MOVX    A,@DPTR
0019 FE                MOV     R6,A
001A A3                INC     DPTR
001B E0                MOVX    A,@DPTR
001C FF                MOV     R7,A
001D C3                CLR     C
001E 74DC              MOV     A,#0DCH
0020 9F                SUBB    A,R7
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 84  

0021 FF                MOV     R7,A
0022 E4                CLR     A
0023 9E                SUBB    A,R6
0024 FE                MOV     R6,A
0025 7C00              MOV     R4,#00H
0027 7D05              MOV     R5,#05H
0029 120000      E     LCALL   ?C?IMUL
002C 900000      E     MOV     DPTR,#g_mem+037H
002F E0                MOVX    A,@DPTR
0030 FD                MOV     R5,A
0031 EF                MOV     A,R7
0032 A805              MOV     R0,AR5
0034 08                INC     R0
0035 8005              SJMP    ?C0200
0037         ?C0199:
0037 C3                CLR     C
0038 33                RLC     A
0039 CE                XCH     A,R6
003A 33                RLC     A
003B CE                XCH     A,R6
003C         ?C0200:
003C D8F9              DJNZ    R0,?C0199
003E FF                MOV     R7,A
003F EE                MOV     A,R6
0040 33                RLC     A
0041 95E0              SUBB    A,ACC
0043 FD                MOV     R5,A
0044 FC                MOV     R4,A
0045 900000      R     MOV     DPTR,#aux
0048 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1138
004B 900000      R     MOV     DPTR,#aux
004E E0                MOVX    A,@DPTR
004F F8                MOV     R0,A
0050 A3                INC     DPTR
0051 E0                MOVX    A,@DPTR
0052 F9                MOV     R1,A
0053 A3                INC     DPTR
0054 E0                MOVX    A,@DPTR
0055 FA                MOV     R2,A
0056 A3                INC     DPTR
0057 E0                MOVX    A,@DPTR
0058 FB                MOV     R3,A
0059 900000      E     MOV     DPTR,#g_refOld
005C E0                MOVX    A,@DPTR
005D FC                MOV     R4,A
005E A3                INC     DPTR
005F E0                MOVX    A,@DPTR
0060 FD                MOV     R5,A
0061 A3                INC     DPTR
0062 E0                MOVX    A,@DPTR
0063 FE                MOV     R6,A
0064 A3                INC     DPTR
0065 E0                MOVX    A,@DPTR
0066 C3                CLR     C
0067 9B                SUBB    A,R3
0068 FF                MOV     R7,A
0069 EE                MOV     A,R6
006A 9A                SUBB    A,R2
006B FE                MOV     R6,A
006C ED                MOV     A,R5
006D 99                SUBB    A,R1
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 85  

006E FD                MOV     R5,A
006F EC                MOV     A,R4
0070 98                SUBB    A,R0
0071 FC                MOV     R4,A
0072 900000      E     MOV     DPTR,#g_refNew
0075 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1140
0078 900000      E     MOV     DPTR,#g_meas+0FH
007B E0                MOVX    A,@DPTR
007C 24DC              ADD     A,#0DCH
007E FF                MOV     R7,A
007F 900000      E     MOV     DPTR,#g_meas+0EH
0082 E0                MOVX    A,@DPTR
0083 3400              ADDC    A,#00H
0085 FE                MOV     R6,A
0086 7C00              MOV     R4,#00H
0088 7D05              MOV     R5,#05H
008A 120000      E     LCALL   ?C?IMUL
008D 900000      E     MOV     DPTR,#g_mem+038H
0090 E0                MOVX    A,@DPTR
0091 FD                MOV     R5,A
0092 EF                MOV     A,R7
0093 A805              MOV     R0,AR5
0095 08                INC     R0
0096 8005              SJMP    ?C0202
0098         ?C0201:
0098 C3                CLR     C
0099 33                RLC     A
009A CE                XCH     A,R6
009B 33                RLC     A
009C CE                XCH     A,R6
009D         ?C0202:
009D D8F9              DJNZ    R0,?C0201
009F FF                MOV     R7,A
00A0 EE                MOV     A,R6
00A1 33                RLC     A
00A2 95E0              SUBB    A,ACC
00A4 FD                MOV     R5,A
00A5 FC                MOV     R4,A
00A6 900000      R     MOV     DPTR,#aux
00A9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1141
00AC 900000      R     MOV     DPTR,#aux
00AF E0                MOVX    A,@DPTR
00B0 FC                MOV     R4,A
00B1 A3                INC     DPTR
00B2 E0                MOVX    A,@DPTR
00B3 FD                MOV     R5,A
00B4 A3                INC     DPTR
00B5 E0                MOVX    A,@DPTR
00B6 FE                MOV     R6,A
00B7 A3                INC     DPTR
00B8 E0                MOVX    A,@DPTR
00B9 FF                MOV     R7,A
00BA 900000      E     MOV     DPTR,#g_refOld+04H
00BD E0                MOVX    A,@DPTR
00BE F8                MOV     R0,A
00BF A3                INC     DPTR
00C0 E0                MOVX    A,@DPTR
00C1 F9                MOV     R1,A
00C2 A3                INC     DPTR
00C3 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 86  

00C4 FA                MOV     R2,A
00C5 A3                INC     DPTR
00C6 E0                MOVX    A,@DPTR
00C7 2F                ADD     A,R7
00C8 FF                MOV     R7,A
00C9 EA                MOV     A,R2
00CA 3E                ADDC    A,R6
00CB FE                MOV     R6,A
00CC E9                MOV     A,R1
00CD 3D                ADDC    A,R5
00CE FD                MOV     R5,A
00CF E8                MOV     A,R0
00D0 3C                ADDC    A,R4
00D1 FC                MOV     R4,A
00D2 900000      E     MOV     DPTR,#g_refNew+04H
00D5 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1143
00D8 E4                CLR     A
00D9 7F0A              MOV     R7,#0AH
00DB FE                MOV     R6,A
00DC FD                MOV     R5,A
00DD FC                MOV     R4,A
00DE 900000      R     MOV     DPTR,#phase_counter
00E1 E0                MOVX    A,@DPTR
00E2 F8                MOV     R0,A
00E3 A3                INC     DPTR
00E4 E0                MOVX    A,@DPTR
00E5 F9                MOV     R1,A
00E6 A3                INC     DPTR
00E7 E0                MOVX    A,@DPTR
00E8 FA                MOV     R2,A
00E9 A3                INC     DPTR
00EA E0                MOVX    A,@DPTR
00EB FB                MOV     R3,A
00EC C3                CLR     C
00ED 120000      E     LCALL   ?C?ULCMP
00F0 4031              JC      ?C0188
00F2 E4                CLR     A
00F3 FF                MOV     R7,A
00F4 FE                MOV     R6,A
00F5 FD                MOV     R5,A
00F6 FC                MOV     R4,A
00F7 900000      E     MOV     DPTR,#dev_tension
00FA E0                MOVX    A,@DPTR
00FB F8                MOV     R0,A
00FC A3                INC     DPTR
00FD E0                MOVX    A,@DPTR
00FE F9                MOV     R1,A
00FF A3                INC     DPTR
0100 E0                MOVX    A,@DPTR
0101 FA                MOV     R2,A
0102 A3                INC     DPTR
0103 E0                MOVX    A,@DPTR
0104 FB                MOV     R3,A
0105 D3                SETB    C
0106 120000      E     LCALL   ?C?SLCMP
0109 5018              JNC     ?C0188
                                           ; SOURCE LINE # 1144
010B C200        E     CLR     pretensioning_flag
                                           ; SOURCE LINE # 1145
010D E4                CLR     A
010E FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 87  

010F FE                MOV     R6,A
0110 FD                MOV     R5,A
0111 FC                MOV     R4,A
0112 900000      E     MOV     DPTR,#g_refNew
0115 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1146
0118 E4                CLR     A
0119 FF                MOV     R7,A
011A FE                MOV     R6,A
011B FD                MOV     R5,A
011C FC                MOV     R4,A
011D 900000      E     MOV     DPTR,#g_refNew+04H
0120 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1147
0123         ?C0188:
                                           ; SOURCE LINE # 1149
0123 900000      R     MOV     DPTR,#phase_counter
0126 E0                MOVX    A,@DPTR
0127 FC                MOV     R4,A
0128 A3                INC     DPTR
0129 E0                MOVX    A,@DPTR
012A FD                MOV     R5,A
012B A3                INC     DPTR
012C E0                MOVX    A,@DPTR
012D FE                MOV     R6,A
012E A3                INC     DPTR
012F E0                MOVX    A,@DPTR
0130 2401              ADD     A,#01H
0132 FF                MOV     R7,A
0133 E4                CLR     A
0134 3E                ADDC    A,R6
0135 FE                MOV     R6,A
0136 E4                CLR     A
0137 3D                ADDC    A,R5
0138 FD                MOV     R5,A
0139 E4                CLR     A
013A 3C                ADDC    A,R4
013B FC                MOV     R4,A
013C 900000      R     MOV     DPTR,#phase_counter
013F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1151
0142 900000      R     MOV     DPTR,#epsilon
0145 E0                MOVX    A,@DPTR
0146 FE                MOV     R6,A
0147 A3                INC     DPTR
0148 E0                MOVX    A,@DPTR
0149 FF                MOV     R7,A
014A C3                CLR     C
014B 74DC              MOV     A,#0DCH
014D 9F                SUBB    A,R7
014E FD                MOV     R5,A
014F E4                CLR     A
0150 9E                SUBB    A,R6
0151 FC                MOV     R4,A
0152 D3                SETB    C
0153 900000      E     MOV     DPTR,#g_meas+0DH
0156 E0                MOVX    A,@DPTR
0157 9D                SUBB    A,R5
0158 EC                MOV     A,R4
0159 6480              XRL     A,#080H
015B F8                MOV     R0,A
015C 900000      E     MOV     DPTR,#g_meas+0CH
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 88  

015F E0                MOVX    A,@DPTR
0160 6480              XRL     A,#080H
0162 98                SUBB    A,R0
0163 5003              JNC     $ + 5H
0165 020000      R     LJMP    ?C0196
0168 EF                MOV     A,R7
0169 2424              ADD     A,#024H
016B FF                MOV     R7,A
016C EE                MOV     A,R6
016D 34FF              ADDC    A,#0FFH
016F FE                MOV     R6,A
0170 C3                CLR     C
0171 900000      E     MOV     DPTR,#g_meas+0FH
0174 E0                MOVX    A,@DPTR
0175 9F                SUBB    A,R7
0176 EE                MOV     A,R6
0177 6480              XRL     A,#080H
0179 F8                MOV     R0,A
017A 900000      E     MOV     DPTR,#g_meas+0EH
017D E0                MOVX    A,@DPTR
017E 6480              XRL     A,#080H
0180 98                SUBB    A,R0
0181 4003              JC      $ + 5H
0183 020000      R     LJMP    ?C0196
                                           ; SOURCE LINE # 1152
0186 900000      R     MOV     DPTR,#phase
0189 7401              MOV     A,#01H
018B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1153
018C E4                CLR     A
018D FF                MOV     R7,A
018E FE                MOV     R6,A
018F FD                MOV     R5,A
0190 FC                MOV     R4,A
0191 A3                INC     DPTR
0192 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1156
                                           ; SOURCE LINE # 1157
0195 22                RET     
                                           ; SOURCE LINE # 1158
0196         ?C0190:
                                           ; SOURCE LINE # 1160
0196 900000      E     MOV     DPTR,#g_mem+037H
0199 E0                MOVX    A,@DPTR
019A FF                MOV     R7,A
019B 7410              MOV     A,#010H
019D 7E00              MOV     R6,#00H
019F A807              MOV     R0,AR7
01A1 08                INC     R0
01A2 8005              SJMP    ?C0204
01A4         ?C0203:
01A4 C3                CLR     C
01A5 33                RLC     A
01A6 CE                XCH     A,R6
01A7 33                RLC     A
01A8 CE                XCH     A,R6
01A9         ?C0204:
01A9 D8F9              DJNZ    R0,?C0203
01AB FF                MOV     R7,A
01AC EE                MOV     A,R6
01AD 33                RLC     A
01AE 95E0              SUBB    A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 89  

01B0 FD                MOV     R5,A
01B1 FC                MOV     R4,A
01B2 900000      R     MOV     DPTR,#aux
01B5 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1161
01B8 900000      R     MOV     DPTR,#aux
01BB E0                MOVX    A,@DPTR
01BC FC                MOV     R4,A
01BD A3                INC     DPTR
01BE E0                MOVX    A,@DPTR
01BF FD                MOV     R5,A
01C0 A3                INC     DPTR
01C1 E0                MOVX    A,@DPTR
01C2 FE                MOV     R6,A
01C3 A3                INC     DPTR
01C4 E0                MOVX    A,@DPTR
01C5 FF                MOV     R7,A
01C6 900000      E     MOV     DPTR,#g_refOld
01C9 E0                MOVX    A,@DPTR
01CA F8                MOV     R0,A
01CB A3                INC     DPTR
01CC E0                MOVX    A,@DPTR
01CD F9                MOV     R1,A
01CE A3                INC     DPTR
01CF E0                MOVX    A,@DPTR
01D0 FA                MOV     R2,A
01D1 A3                INC     DPTR
01D2 E0                MOVX    A,@DPTR
01D3 2F                ADD     A,R7
01D4 FF                MOV     R7,A
01D5 EA                MOV     A,R2
01D6 3E                ADDC    A,R6
01D7 FE                MOV     R6,A
01D8 E9                MOV     A,R1
01D9 3D                ADDC    A,R5
01DA FD                MOV     R5,A
01DB E8                MOV     A,R0
01DC 3C                ADDC    A,R4
01DD FC                MOV     R4,A
01DE 900000      E     MOV     DPTR,#g_refNew
01E1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1163
01E4 900000      E     MOV     DPTR,#g_mem+038H
01E7 E0                MOVX    A,@DPTR
01E8 FF                MOV     R7,A
01E9 7410              MOV     A,#010H
01EB 7E00              MOV     R6,#00H
01ED A807              MOV     R0,AR7
01EF 08                INC     R0
01F0 8005              SJMP    ?C0206
01F2         ?C0205:
01F2 C3                CLR     C
01F3 33                RLC     A
01F4 CE                XCH     A,R6
01F5 33                RLC     A
01F6 CE                XCH     A,R6
01F7         ?C0206:
01F7 D8F9              DJNZ    R0,?C0205
01F9 FF                MOV     R7,A
01FA EE                MOV     A,R6
01FB 33                RLC     A
01FC 95E0              SUBB    A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 90  

01FE FD                MOV     R5,A
01FF FC                MOV     R4,A
0200 900000      R     MOV     DPTR,#aux
0203 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1164
0206 900000      R     MOV     DPTR,#aux
0209 E0                MOVX    A,@DPTR
020A F8                MOV     R0,A
020B A3                INC     DPTR
020C E0                MOVX    A,@DPTR
020D F9                MOV     R1,A
020E A3                INC     DPTR
020F E0                MOVX    A,@DPTR
0210 FA                MOV     R2,A
0211 A3                INC     DPTR
0212 E0                MOVX    A,@DPTR
0213 FB                MOV     R3,A
0214 900000      E     MOV     DPTR,#g_refOld+04H
0217 E0                MOVX    A,@DPTR
0218 FC                MOV     R4,A
0219 A3                INC     DPTR
021A E0                MOVX    A,@DPTR
021B FD                MOV     R5,A
021C A3                INC     DPTR
021D E0                MOVX    A,@DPTR
021E FE                MOV     R6,A
021F A3                INC     DPTR
0220 E0                MOVX    A,@DPTR
0221 C3                CLR     C
0222 9B                SUBB    A,R3
0223 FF                MOV     R7,A
0224 EE                MOV     A,R6
0225 9A                SUBB    A,R2
0226 FE                MOV     R6,A
0227 ED                MOV     A,R5
0228 99                SUBB    A,R1
0229 FD                MOV     R5,A
022A EC                MOV     A,R4
022B 98                SUBB    A,R0
022C FC                MOV     R4,A
022D 900000      E     MOV     DPTR,#g_refNew+04H
0230 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1166
0233 E4                CLR     A
0234 7F50              MOV     R7,#050H
0236 FE                MOV     R6,A
0237 FD                MOV     R5,A
0238 FC                MOV     R4,A
0239 900000      R     MOV     DPTR,#phase_counter
023C E0                MOVX    A,@DPTR
023D F8                MOV     R0,A
023E A3                INC     DPTR
023F E0                MOVX    A,@DPTR
0240 F9                MOV     R1,A
0241 A3                INC     DPTR
0242 E0                MOVX    A,@DPTR
0243 FA                MOV     R2,A
0244 A3                INC     DPTR
0245 E0                MOVX    A,@DPTR
0246 FB                MOV     R3,A
0247 D3                SETB    C
0248 120000      E     LCALL   ?C?ULCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 91  

024B 404B              JC      ?C0191
                                           ; SOURCE LINE # 1167
024D C200        E     CLR     pretensioning_flag
                                           ; SOURCE LINE # 1168
024F D200        E     SETB    pret_done
                                           ; SOURCE LINE # 1169
0251 E4                CLR     A
0252 900000      R     MOV     DPTR,#phase
0255 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1170
0256 D200        E     SETB    reset_last_value_flag
                                           ; SOURCE LINE # 1171
0258 900000      R     MOV     DPTR,#i
025B F0                MOVX    @DPTR,A
025C         ?C0192:
025C 900000      R     MOV     DPTR,#i
025F E0                MOVX    A,@DPTR
0260 FB                MOV     R3,A
0261 C3                CLR     C
0262 9403              SUBB    A,#03H
0264 5032              JNC     ?C0191
                                           ; SOURCE LINE # 1172
0266 EB                MOV     A,R3
0267 25E0              ADD     A,ACC
0269 25E0              ADD     A,ACC
026B 2400        E     ADD     A,#LOW g_refNew
026D F582              MOV     DPL,A
026F E4                CLR     A
0270 3400        E     ADDC    A,#HIGH g_refNew
0272 F583              MOV     DPH,A
0274 E0                MOVX    A,@DPTR
0275 FC                MOV     R4,A
0276 A3                INC     DPTR
0277 E0                MOVX    A,@DPTR
0278 FD                MOV     R5,A
0279 A3                INC     DPTR
027A E0                MOVX    A,@DPTR
027B FE                MOV     R6,A
027C A3                INC     DPTR
027D E0                MOVX    A,@DPTR
027E FF                MOV     R7,A
027F EB                MOV     A,R3
0280 25E0              ADD     A,ACC
0282 25E0              ADD     A,ACC
0284 2400        E     ADD     A,#LOW pret_offset_pos
0286 F582              MOV     DPL,A
0288 E4                CLR     A
0289 3400        E     ADDC    A,#HIGH pret_offset_pos
028B F583              MOV     DPH,A
028D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1179
0290 900000      R     MOV     DPTR,#i
0293 E0                MOVX    A,@DPTR
0294 04                INC     A
0295 F0                MOVX    @DPTR,A
0296 80C4              SJMP    ?C0192
                                           ; SOURCE LINE # 1191
0298         ?C0191:
                                           ; SOURCE LINE # 1193
0298 900000      R     MOV     DPTR,#phase_counter
029B E0                MOVX    A,@DPTR
029C FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         03/27/2019 09:24:49 PAGE 92  

029D A3                INC     DPTR
029E E0                MOVX    A,@DPTR
029F FD                MOV     R5,A
02A0 A3                INC     DPTR
02A1 E0                MOVX    A,@DPTR
02A2 FE                MOV     R6,A
02A3 A3                INC     DPTR
02A4 E0                MOVX    A,@DPTR
02A5 2401              ADD     A,#01H
02A7 FF                MOV     R7,A
02A8 E4                CLR     A
02A9 3E                ADDC    A,R6
02AA FE                MOV     R6,A
02AB E4                CLR     A
02AC 3D                ADDC    A,R5
02AD FD                MOV     R5,A
02AE E4                CLR     A
02AF 3C                ADDC    A,R4
02B0 FC                MOV     R4,A
02B1 900000      R     MOV     DPTR,#phase_counter
02B4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1194
                                           ; SOURCE LINE # 1195
                                           ; SOURCE LINE # 1196
                                           ; SOURCE LINE # 1197
                                           ; SOURCE LINE # 1198
02B7         ?C0196:
02B7 22                RET     
             ; FUNCTION pretensioning_process (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   6004    ----
   CONSTANT SIZE    =     97    ----
   XDATA SIZE       =    176      18
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6      73
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
